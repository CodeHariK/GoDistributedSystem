=== RUN   TestElectionBasic
15:47:39.092562 [0] listening at [::]:56710
15:47:39.092982 [1] listening at [::]:56711
15:47:39.093209 [2] listening at [::]:56712
15:47:39.093440 [2] election timer started (243ms), term=0
15:47:39.093440 [0] election timer started (236ms), term=0
15:47:39.093446 [1] election timer started (247ms), term=0
15:47:39.334781 [0] becomes Candidate (currentTerm=1); log=[]
15:47:39.335102 [0] election timer started (277ms), term=1
15:47:39.335116 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:39.335132 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:39.339988 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:39.339981 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:39.340082 [1] ... term out of date in RequestVote
15:47:39.340105 [2] ... term out of date in RequestVote
15:47:39.340130 [2] becomes Follower with term=1; log=[]
15:47:39.340123 [1] becomes Follower with term=1; log=[]
15:47:39.340179 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:39.340187 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:39.340225 [1] election timer started (163ms), term=1
15:47:39.340300 [2] election timer started (223ms), term=1
15:47:39.343774 [1] in election timer term changed from 0 to 1, bailing out
15:47:39.343832 [2] in election timer term changed from 0 to 1, bailing out
15:47:39.343847 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:39 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:39.344011 [0] wins election with 2 votes
15:47:39.344050 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:39.344125 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:39 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:39.344217 [0] while waiting for reply, state = LEADER
15:47:39.344295 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.344304 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.345385 [0] in election timer state=LEADER, bailing out
15:47:39.345515 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.345622 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.345602 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.345844 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.348577 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.348691 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.394657 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.394667 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.394935 [0] becomes Dead
15:47:39.394982 [0] commitChanSender done
15:47:39.394991 Received quit signal. Shutting down...
15:47:39.395094 Listener close error: close tcp [::]:56710: use of closed network connection
15:47:39.395147 [0] CraftServer terminated!
15:47:39.395175 [1] becomes Dead
15:47:39.395213 [1] commitChanSender done
15:47:39.395224 Received quit signal. Shutting down...
15:47:39.395269 Listener close error: close tcp [::]:56711: use of closed network connection
15:47:39.395321 [1] CraftServer terminated!
15:47:39.395349 [2] becomes Dead
15:47:39.395401 [2] commitChanSender done
15:47:39.395404 Received quit signal. Shutting down...
15:47:39.395450 Listener close error: close tcp [::]:56712: use of closed network connection
15:47:39.395486 [2] CraftServer terminated!
--- PASS: TestElectionBasic (0.30s)
=== RUN   TestElectionLeaderDisconnect
15:47:39.396211 [0] listening at [::]:56715
15:47:39.396539 [1] listening at [::]:56716
15:47:39.396846 [2] listening at [::]:56717
15:47:39.397071 [2] election timer started (170ms), term=0
15:47:39.397089 [1] election timer started (247ms), term=0
15:47:39.397076 [0] election timer started (156ms), term=0
15:47:39.400561 [2] in election timer state=DEAD, bailing out
15:47:39.400567 [1] in election timer state=DEAD, bailing out
15:47:39.558264 [0] becomes Candidate (currentTerm=1); log=[]
15:47:39.558511 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:39.558620 [0] election timer started (249ms), term=1
15:47:39.558503 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:39.561160 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:39.561156 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:39.561318 [2] ... term out of date in RequestVote
15:47:39.561354 [1] ... term out of date in RequestVote
15:47:39.561357 [2] becomes Follower with term=1; log=[]
15:47:39.561407 [1] becomes Follower with term=1; log=[]
15:47:39.561479 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:39.561487 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:39.561551 [2] election timer started (233ms), term=1
15:47:39.561685 [1] election timer started (290ms), term=1
15:47:39.563907 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:39 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:39.564044 [0] wins election with 2 votes
15:47:39.564074 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:39.564164 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:39 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:39.564271 [0] while waiting for reply, state = LEADER
15:47:39.564311 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.564371 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.566136 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.566238 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.566221 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.566293 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.567300 [2] in election timer term changed from 0 to 1, bailing out
15:47:39.567345 [1] in election timer term changed from 0 to 1, bailing out
15:47:39.568200 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.568263 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.568973 [0] in election timer state=LEADER, bailing out
15:47:39.614497 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.614497 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.615356 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.615355 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.615434 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.615447 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.617540 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.617610 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.664477 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.664477 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.665774 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.665774 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.665909 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.665941 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:39.667151 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.668589 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:39.698952 [TEST] Disconnect 0
15:47:39.714222 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.714239 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.764438 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.764445 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.814439 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.814439 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.864436 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.864441 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.902860 [2] becomes Candidate (currentTerm=2); log=[]
15:47:39.903126 [2] election timer started (151ms), term=2
15:47:39.903060 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:39.903068 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:39.905327 [1] RequestVote: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=0, log index/term=(-1, -1)]
15:47:39.905414 [1] ... term out of date in RequestVote
15:47:39.905434 [1] becomes Follower with term=2; log=[]
15:47:39.905475 [1] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:39.905516 [1] election timer started (204ms), term=2
15:47:39.907464 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:39 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:39.907599 [2] wins election with 2 votes
15:47:39.907626 [2] becomes Leader; term=2, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
15:47:39.907722 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.907721 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.908428 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.908497 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:39.911434 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:39.911903 [1] in election timer term changed from 1 to 2, bailing out
15:47:39.913496 [2] in election timer state=LEADER, bailing out
15:47:39.914316 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.914318 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.957949 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.957948 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.959550 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.959733 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:39.961863 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:39.964571 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:39.964580 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.007937 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.007937 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.009061 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.009174 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:40.011694 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:40.014609 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.014595 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.050345 [0] becomes Dead
15:47:40.050498 Received quit signal. Shutting down...
15:47:40.050554 [0] commitChanSender done
15:47:40.050615 Listener close error: close tcp [::]:56715: use of closed network connection
15:47:40.050669 [0] CraftServer terminated!
15:47:40.050739 [1] becomes Dead
15:47:40.050830 [1] commitChanSender done
15:47:40.050846 Received quit signal. Shutting down...
15:47:40.050880 Listener close error: close tcp [::]:56716: use of closed network connection
15:47:40.050981 [1] CraftServer terminated!
15:47:40.051023 [2] becomes Dead
15:47:40.051152 [2] commitChanSender done
15:47:40.051153 Received quit signal. Shutting down...
15:47:40.051248 Listener close error: close tcp [::]:56717: use of closed network connection
15:47:40.051293 [2] CraftServer terminated!
--- PASS: TestElectionLeaderDisconnect (0.66s)
=== RUN   TestElectionLeaderAndAnotherDisconnect
15:47:40.052561 [0] listening at [::]:56721
15:47:40.053102 [1] listening at [::]:56722
15:47:40.053506 [2] listening at [::]:56723
15:47:40.053781 [0] election timer started (286ms), term=0
15:47:40.053793 [1] election timer started (278ms), term=0
15:47:40.053808 [2] election timer started (151ms), term=0
15:47:40.056374 [1] in election timer state=DEAD, bailing out
15:47:40.204872 [2] becomes Candidate (currentTerm=1); log=[]
15:47:40.205076 [2] election timer started (183ms), term=1
15:47:40.205040 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:40.205038 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:40.207284 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:40.207284 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:40.207393 [0] ... term out of date in RequestVote
15:47:40.207404 [1] ... term out of date in RequestVote
15:47:40.207422 [0] becomes Follower with term=1; log=[]
15:47:40.207429 [1] becomes Follower with term=1; log=[]
15:47:40.207469 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:40.207479 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:40.207533 [0] election timer started (153ms), term=1
15:47:40.207644 [1] election timer started (277ms), term=1
15:47:40.210310 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:40 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:40.210445 [2] wins election with 2 votes
15:47:40.210469 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
15:47:40.210532 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:40 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:40.210620 [2] while waiting for reply, state = LEADER
15:47:40.210690 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.210681 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.211613 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.211612 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.211697 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:40.211704 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:40.213446 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:40.213790 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:40.213860 [0] in election timer term changed from 0 to 1, bailing out
15:47:40.213882 [1] in election timer term changed from 0 to 1, bailing out
15:47:40.215383 [2] in election timer state=LEADER, bailing out
15:47:40.260900 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.260939 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.262342 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.262348 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.262496 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:40.262525 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:40.264425 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:40.264856 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:40.310918 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.310917 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.312443 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.312451 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.312612 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:40.312634 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:40.313625 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:40.314273 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:40.355659 [TEST] Disconnect 2
15:47:40.356206 [TEST] Disconnect 0
15:47:40.361036 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.361050 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.410919 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.410904 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.460938 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.460927 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.468676 [0] becomes Candidate (currentTerm=2); log=[]
15:47:40.468812 [0] election timer started (191ms), term=2
15:47:40.468810 [0] sending RequestVote to 1: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:40.468837 [0] sending RequestVote to 2: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:40.510864 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.510866 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.560882 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.560893 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.598802 [1] becomes Candidate (currentTerm=2); log=[]
15:47:40.599018 [1] election timer started (152ms), term=2
15:47:40.598965 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:40.598975 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:40.610833 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.610820 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.660838 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.660830 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.669617 [0] becomes Candidate (currentTerm=3); log=[]
15:47:40.669882 [0] election timer started (166ms), term=3
15:47:40.669860 [0] sending RequestVote to 1: Term:3 LastLogIndex:-1 LastLogTerm:-1
15:47:40.669979 [0] sending RequestVote to 2: Term:3 LastLogIndex:-1 LastLogTerm:-1
15:47:40.710695 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.710688 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.760248 [1] becomes Candidate (currentTerm=3); log=[]
15:47:40.760458 [1] election timer started (256ms), term=3
15:47:40.760474 [1] sending RequestVote to 2: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:40.760453 [1] sending RequestVote to 0: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:40.760743 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.760669 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.807089 [TEST] Reconnect 0
15:47:40.810672 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.810676 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.813352 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.813499 [0] AppendEntries reply: Term:3 Success:%!d(bool=false)
15:47:40.815181 [2] term out of date in heartbeat reply
15:47:40.815212 [2] becomes Follower with term=3; log=[]
15:47:40.815327 [2] election timer started (256ms), term=3
15:47:40.840515 [0] becomes Candidate (currentTerm=4); log=[]
15:47:40.840789 [0] sending RequestVote to 2: Term:4 LastLogIndex:-1 LastLogTerm:-1
15:47:40.840923 [0] election timer started (201ms), term=4
15:47:40.840986 [0] sending RequestVote to 1: Term:4 LastLogIndex:-1 LastLogTerm:-1
15:47:40.843282 [1] RequestVote: Term:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=3, votedFor=1, log index/term=(-1, -1)]
15:47:40.843303 [2] RequestVote: Term:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=3, votedFor=-1, log index/term=(-1, -1)]
15:47:40.843417 [1] ... term out of date in RequestVote
15:47:40.843433 [2] ... term out of date in RequestVote
15:47:40.843454 [1] becomes Follower with term=4; log=[]
15:47:40.843473 [2] becomes Follower with term=4; log=[]
15:47:40.843543 [2] ... RequestVote reply: Term:4 Votegranted:%!d(bool=true)
15:47:40.843632 [2] election timer started (290ms), term=4
15:47:40.843540 [1] ... RequestVote reply: Term:4 Votegranted:%!d(bool=true)
15:47:40.844069 [1] election timer started (259ms), term=4
15:47:40.845704 [2] in election timer term changed from 3 to 4, bailing out
15:47:40.849985 [0] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:40 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:40.850129 [0] wins election with 2 votes
15:47:40.850154 [0] becomes Leader; term=4, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:40.850259 [0] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:40 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:40.850360 [0] while waiting for reply, state = LEADER
15:47:40.850400 [0] sending AppendEntries to 1: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.850436 [0] sending AppendEntries to 2: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.850676 [1] in election timer term changed from 3 to 4, bailing out
15:47:40.851074 [0] in election timer state=LEADER, bailing out
15:47:40.851135 [1] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.851208 [1] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:40.851154 [2] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.851282 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:40.852765 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:40.852851 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:40.900654 [0] sending AppendEntries to 2: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.900665 [0] sending AppendEntries to 1: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.901601 [1] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.901624 [2] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.901692 [1] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:40.901701 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:40.903972 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:40.904043 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:40.951063 [0] sending AppendEntries to 1: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.951077 [0] sending AppendEntries to 2: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.952271 [2] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.952283 [1] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:40.952428 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:40.952468 [1] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:40.953437 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:40.953872 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:40.958128 [0] becomes Dead
15:47:40.958182 Received quit signal. Shutting down...
15:47:40.958198 [0] commitChanSender done
15:47:40.958237 Listener close error: close tcp [::]:56721: use of closed network connection
15:47:40.958272 [0] CraftServer terminated!
15:47:40.958301 [1] becomes Dead
15:47:40.958352 [1] commitChanSender done
15:47:40.958350 Received quit signal. Shutting down...
15:47:40.958408 Listener close error: close tcp [::]:56722: use of closed network connection
15:47:40.958442 [1] CraftServer terminated!
15:47:40.958472 [2] becomes Dead
15:47:40.958507 Received quit signal. Shutting down...
15:47:40.958518 [2] commitChanSender done
15:47:40.958585 Listener close error: close tcp [::]:56723: use of closed network connection
15:47:40.958618 [2] CraftServer terminated!
--- PASS: TestElectionLeaderAndAnotherDisconnect (0.91s)
=== RUN   TestDisconnectAllThenRestore
15:47:40.959525 [0] listening at [::]:56729
15:47:40.959968 [1] listening at [::]:56730
15:47:40.960393 [2] listening at [::]:56731
15:47:40.960659 [1] election timer started (252ms), term=0
15:47:40.960691 [2] election timer started (158ms), term=0
15:47:40.960694 [0] election timer started (150ms), term=0
15:47:40.963918 [2] in election timer state=DEAD, bailing out
15:47:40.964782 [1] in election timer state=DEAD, bailing out
15:47:41.061721 [TEST] Disconnect 0
15:47:41.062002 [TEST] Disconnect 1
15:47:41.062126 [TEST] Disconnect 2
15:47:41.111837 [0] becomes Candidate (currentTerm=1); log=[]
15:47:41.112082 [0] election timer started (175ms), term=1
15:47:41.112072 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.112038 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.121122 [2] becomes Candidate (currentTerm=1); log=[]
15:47:41.121203 [2] election timer started (180ms), term=1
15:47:41.121194 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:41.121242 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:41.221867 [1] becomes Candidate (currentTerm=1); log=[]
15:47:41.222097 [1] election timer started (215ms), term=1
15:47:41.222080 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.222091 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.292361 [0] becomes Candidate (currentTerm=2); log=[]
15:47:41.292603 [0] election timer started (221ms), term=2
15:47:41.292572 [0] sending RequestVote to 2: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:41.292575 [0] sending RequestVote to 1: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:41.301633 [2] becomes Candidate (currentTerm=2); log=[]
15:47:41.301750 [2] election timer started (279ms), term=2
15:47:41.301734 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:41.301760 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:41.442961 [1] becomes Candidate (currentTerm=2); log=[]
15:47:41.443205 [1] election timer started (180ms), term=2
15:47:41.443186 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.443199 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.512910 [TEST] Reconnect 0
15:47:41.513251 [TEST] Reconnect 1
15:47:41.513343 [TEST] Reconnect 2
15:47:41.522927 [0] becomes Candidate (currentTerm=3); log=[]
15:47:41.523204 [0] sending RequestVote to 1: Term:3 LastLogIndex:-1 LastLogTerm:-1
15:47:41.523130 [0] sending RequestVote to 2: Term:3 LastLogIndex:-1 LastLogTerm:-1
15:47:41.523899 [0] election timer started (198ms), term=3
15:47:41.524951 [1] RequestVote: Term:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=1, log index/term=(-1, -1)]
15:47:41.524951 [2] RequestVote: Term:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=2, log index/term=(-1, -1)]
15:47:41.525038 [1] ... term out of date in RequestVote
15:47:41.525060 [2] ... term out of date in RequestVote
15:47:41.525063 [1] becomes Follower with term=3; log=[]
15:47:41.525080 [2] becomes Follower with term=3; log=[]
15:47:41.525098 [1] ... RequestVote reply: Term:3 Votegranted:%!d(bool=true)
15:47:41.525121 [2] ... RequestVote reply: Term:3 Votegranted:%!d(bool=true)
15:47:41.525418 [1] election timer started (259ms), term=3
15:47:41.525565 [2] election timer started (183ms), term=3
15:47:41.527049 [0] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:41 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:41.527744 [0] wins election with 2 votes
15:47:41.527785 [0] becomes Leader; term=3, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:41.527892 [0] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:41 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:41.527996 [0] while waiting for reply, state = LEADER
15:47:41.528038 [0] sending AppendEntries to 2: ni=0, args=Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.528069 [0] sending AppendEntries to 1: ni=0, args=Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.528896 [1] AppendEntries: Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.528899 [2] AppendEntries: Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.528977 [2] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:41.528976 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:41.530378 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:41.530451 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:41.532056 [2] in election timer term changed from 2 to 3, bailing out
15:47:41.533534 [1] in election timer term changed from 2 to 3, bailing out
15:47:41.534054 [0] in election timer state=LEADER, bailing out
15:47:41.578175 [0] sending AppendEntries to 2: ni=0, args=Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.578175 [0] sending AppendEntries to 1: ni=0, args=Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.579333 [1] AppendEntries: Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.579333 [2] AppendEntries: Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.579479 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:41.579534 [2] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:41.582818 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:41.583026 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:41.628116 [0] sending AppendEntries to 2: ni=0, args=Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.628113 [0] sending AppendEntries to 1: ni=0, args=Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.628866 [2] AppendEntries: Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.628881 [1] AppendEntries: Term:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.628922 [2] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:41.628931 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:41.630158 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:41.630210 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:41.664746 [0] becomes Dead
15:47:41.664846 [0] commitChanSender done
15:47:41.664827 Received quit signal. Shutting down...
15:47:41.664960 Listener close error: close tcp [::]:56729: use of closed network connection
15:47:41.665023 [0] CraftServer terminated!
15:47:41.665078 [1] becomes Dead
15:47:41.665149 [1] commitChanSender done
15:47:41.665152 Received quit signal. Shutting down...
15:47:41.665203 Listener close error: close tcp [::]:56730: use of closed network connection
15:47:41.665261 [1] CraftServer terminated!
15:47:41.665317 [2] becomes Dead
15:47:41.665371 Received quit signal. Shutting down...
15:47:41.665385 [2] commitChanSender done
15:47:41.665469 Listener close error: close tcp [::]:56731: use of closed network connection
15:47:41.665482 [1] in election timer state=DEAD, bailing out
15:47:41.665557 [2] CraftServer terminated!
15:47:41.665653 [2] in election timer state=DEAD, bailing out
--- PASS: TestDisconnectAllThenRestore (0.71s)
=== RUN   TestElectionLeaderDisconnectThenReconnect
15:47:41.666537 [0] listening at [::]:56734
15:47:41.667106 [1] listening at [::]:56735
15:47:41.667397 [2] listening at [::]:56736
15:47:41.667626 [1] election timer started (158ms), term=0
15:47:41.667622 [2] election timer started (246ms), term=0
15:47:41.667631 [0] election timer started (152ms), term=0
15:47:41.828774 [0] becomes Candidate (currentTerm=1); log=[]
15:47:41.828774 [1] becomes Candidate (currentTerm=1); log=[]
15:47:41.828910 [0] election timer started (241ms), term=1
15:47:41.828905 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.828941 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.829348 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.829406 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:41.830023 [1] election timer started (254ms), term=1
15:47:41.831385 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=1, log index/term=(-1, -1)]
15:47:41.831455 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:41.831503 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=0, log index/term=(-1, -1)]
15:47:41.831931 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:41.831998 [2] ... term out of date in RequestVote
15:47:41.832019 [2] becomes Follower with term=1; log=[]
15:47:41.832055 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:41.832112 [2] election timer started (245ms), term=1
15:47:41.832176 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:41.832177 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=1, log index/term=(-1, -1)]
15:47:41.832237 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:41.833732 [0] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:41 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:41.834800 [1] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:41 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:41.834505 [0] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:41 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:41.835376 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:41 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:41.835470 [1] wins election with 2 votes
15:47:41.835495 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
15:47:41.835574 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.835585 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.836125 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.836134 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.836194 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:41.836201 [0] becomes Follower with term=1; log=[]
15:47:41.836247 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:41.836305 [0] election timer started (182ms), term=1
15:47:41.837905 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:41.837955 [2] in election timer term changed from 0 to 1, bailing out
15:47:41.837983 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:41.840293 [1] in election timer state=LEADER, bailing out
15:47:41.886028 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.886028 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.886940 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.886939 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.887045 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:41.887101 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:41.888698 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:41.889081 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:41.936059 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.936059 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.937332 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.937347 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.937472 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:41.937501 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:41.938672 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:41.939300 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:41.968945 [TEST] Disconnect 1
15:47:41.986039 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:41.986039 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.036163 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.036163 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.086101 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.086102 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.126916 [0] becomes Candidate (currentTerm=2); log=[]
15:47:42.127094 [0] election timer started (219ms), term=2
15:47:42.127097 [0] sending RequestVote to 1: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:42.127080 [0] sending RequestVote to 2: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:42.128331 [2] RequestVote: Term:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=1, log index/term=(-1, -1)]
15:47:42.128482 [2] ... term out of date in RequestVote
15:47:42.128518 [2] becomes Follower with term=2; log=[]
15:47:42.128587 [2] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:42.128648 [2] election timer started (248ms), term=2
15:47:42.129162 [0] in election timer term changed from 1 to 2, bailing out
15:47:42.131189 [0] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.131333 [0] wins election with 2 votes
15:47:42.131359 [0] becomes Leader; term=2, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:42.131456 [0] sending AppendEntries to 1: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.131477 [0] sending AppendEntries to 2: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.132098 [2] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.132168 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.132239 [2] in election timer term changed from 1 to 2, bailing out
15:47:42.133663 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.135881 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.135900 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.137374 [0] in election timer state=LEADER, bailing out
15:47:42.181808 [0] sending AppendEntries to 2: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.181808 [0] sending AppendEntries to 1: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.183707 [2] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.183859 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.185633 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.185628 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.186290 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.231868 [0] sending AppendEntries to 1: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.231868 [0] sending AppendEntries to 2: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.233337 [2] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.233459 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.235226 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.235715 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.235725 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.281857 [0] sending AppendEntries to 2: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.281857 [0] sending AppendEntries to 1: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.283808 [2] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.283935 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.284999 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.285756 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.285758 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.319914 [TEST] Reconnect 1
15:47:42.331799 [0] sending AppendEntries to 2: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.331796 [0] sending AppendEntries to 1: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.333404 [2] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.333564 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.333977 [1] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.334054 [1] ... term out of date in AppendEntries
15:47:42.334076 [1] becomes Follower with term=2; log=[]
15:47:42.334123 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.334169 [1] election timer started (234ms), term=2
15:47:42.334624 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.335914 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.381867 [0] sending AppendEntries to 2: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.381859 [0] sending AppendEntries to 1: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.384817 [1] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.384892 [2] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.384991 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.385029 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.386026 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.386115 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.431860 [0] sending AppendEntries to 1: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.431860 [0] sending AppendEntries to 2: ni=0, args=Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.433473 [2] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.433473 [1] AppendEntries: Term:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.433650 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.433704 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.435818 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.435898 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:42.471175 [0] becomes Dead
15:47:42.471271 [0] commitChanSender done
15:47:42.471270 Received quit signal. Shutting down...
15:47:42.471417 Listener close error: close tcp [::]:56734: use of closed network connection
15:47:42.471464 [0] CraftServer terminated!
15:47:42.471492 [1] becomes Dead
15:47:42.471541 [1] commitChanSender done
15:47:42.471544 Received quit signal. Shutting down...
15:47:42.471653 Listener close error: close tcp [::]:56735: use of closed network connection
15:47:42.471691 [1] CraftServer terminated!
15:47:42.471720 [2] becomes Dead
15:47:42.471771 Received quit signal. Shutting down...
15:47:42.471798 [2] commitChanSender done
15:47:42.471819 Listener close error: close tcp [::]:56736: use of closed network connection
15:47:42.471859 [2] CraftServer terminated!
--- PASS: TestElectionLeaderDisconnectThenReconnect (0.81s)
=== RUN   TestElectionLeaderDisconnectThenReconnect5
15:47:42.473925 [0] listening at [::]:56742
15:47:42.474269 [1] listening at [::]:56743
15:47:42.474323 [1] in election timer state=DEAD, bailing out
15:47:42.474582 [2] listening at [::]:56744
15:47:42.474875 [3] listening at [::]:56745
15:47:42.475151 [4] listening at [::]:56746
15:47:42.475719 [3] election timer started (188ms), term=0
15:47:42.475747 [2] election timer started (162ms), term=0
15:47:42.475742 [1] election timer started (217ms), term=0
15:47:42.475730 [0] election timer started (218ms), term=0
15:47:42.475774 [4] election timer started (270ms), term=0
15:47:42.479093 [2] in election timer state=DEAD, bailing out
15:47:42.646858 [2] becomes Candidate (currentTerm=1); log=[]
15:47:42.647072 [2] election timer started (267ms), term=1
15:47:42.647020 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:42.647041 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:42.647196 [2] sending RequestVote to 4: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:42.647282 [2] sending RequestVote to 3: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:42.649084 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:42.649227 [1] ... term out of date in RequestVote
15:47:42.649268 [1] becomes Follower with term=1; log=[]
15:47:42.649329 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:42.649262 [3] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:42.649396 [3] ... term out of date in RequestVote
15:47:42.649432 [3] becomes Follower with term=1; log=[]
15:47:42.649362 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:42.649484 [3] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:42.649582 [1] election timer started (235ms), term=1
15:47:42.649563 [4] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:42.649653 [4] ... term out of date in RequestVote
15:47:42.649671 [4] becomes Follower with term=1; log=[]
15:47:42.649699 [4] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:42.649818 [3] election timer started (281ms), term=1
15:47:42.649959 [4] election timer started (262ms), term=1
15:47:42.649496 [0] ... term out of date in RequestVote
15:47:42.650021 [0] becomes Follower with term=1; log=[]
15:47:42.650050 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:42.651179 [0] election timer started (280ms), term=1
15:47:42.652776 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.652886 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.652972 [2] wins election with 3 votes
15:47:42.652995 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0 3:0 4:0], matchIndex=map[0:-1 1:-1 3:-1 4:-1]; log=[]
15:47:42.653077 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.653159 [2] while waiting for reply, state = LEADER
15:47:42.653190 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.653268 [2] while waiting for reply, state = LEADER
15:47:42.653322 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.653392 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.653662 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.653877 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.654510 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.654582 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.654561 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.654636 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.654817 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.654889 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.654560 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.656109 [0] in election timer term changed from 0 to 1, bailing out
15:47:42.656182 [4] in election timer term changed from 0 to 1, bailing out
15:47:42.656614 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.656805 [1] in election timer term changed from 0 to 1, bailing out
15:47:42.656615 [3] in election timer term changed from 0 to 1, bailing out
15:47:42.657272 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.657345 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.657409 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.657472 [2] in election timer state=LEADER, bailing out
15:47:42.657760 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.703350 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.703350 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.703366 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.703391 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.704151 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.704151 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.704201 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.704259 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.704236 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.704276 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.704310 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.704227 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.706129 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.706300 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.706909 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.706995 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.753377 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.753380 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.753465 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.753410 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.754688 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.754824 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.754690 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.754692 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.754833 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.754949 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.754967 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.754900 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:42.756029 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.756351 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.756426 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.756501 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:42.777548 [TEST] Disconnect 2
15:47:42.803453 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.803557 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.803572 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.803410 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.853392 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.853434 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.853388 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.853478 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.903406 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.903403 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.903373 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.903602 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.953373 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.953376 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.953450 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.953414 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.990649 [1] becomes Candidate (currentTerm=2); log=[]
15:47:42.990689 [1] sending RequestVote to 4: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:42.990729 [1] sending RequestVote to 3: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:42.990741 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:42.990802 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:42.990850 [1] election timer started (202ms), term=2
15:47:42.991375 [4] RequestVote: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:42.991406 [4] ... term out of date in RequestVote
15:47:42.991415 [4] becomes Follower with term=2; log=[]
15:47:42.991432 [4] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:42.991422 [0] RequestVote: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:42.991454 [0] ... term out of date in RequestVote
15:47:42.991464 [0] becomes Follower with term=2; log=[]
15:47:42.991454 [4] election timer started (239ms), term=2
15:47:42.991480 [0] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:42.991544 [3] RequestVote: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:42.991603 [3] ... term out of date in RequestVote
15:47:42.991612 [3] becomes Follower with term=2; log=[]
15:47:42.991626 [3] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:42.991570 [0] election timer started (167ms), term=2
15:47:42.991688 [3] election timer started (166ms), term=2
15:47:42.992227 [0] in election timer term changed from 1 to 2, bailing out
15:47:42.993280 [1] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.993514 [1] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.993559 [1] wins election with 3 votes
15:47:42.993571 [1] becomes Leader; term=2, nextIndex=map[0:0 2:0 3:0 4:0], matchIndex=map[0:-1 2:-1 3:-1 4:-1]; log=[]
15:47:42.993615 [1] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.993713 [1] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.993713 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.993760 [1] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:42 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:42.993848 [1] while waiting for reply, state = LEADER
15:47:42.993903 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.994058 [4] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.994112 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.994341 [3] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.994392 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.994644 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:42.994698 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:42.994907 [1] AppendEntries reply from 4 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:42.995958 [1] AppendEntries reply from 3 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:42.996172 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.000366 [3] in election timer term changed from 1 to 2, bailing out
15:47:43.000428 [4] in election timer term changed from 1 to 2, bailing out
15:47:43.000934 [1] in election timer state=LEADER, bailing out
15:47:43.003290 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.003267 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.003390 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.003272 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.043821 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.043821 [1] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.043870 [1] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.043845 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.044216 [3] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.044256 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.044214 [4] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.044217 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.044294 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.044304 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.045780 [1] AppendEntries reply from 3 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.045827 [1] AppendEntries reply from 4 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.046093 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.053296 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.053315 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.053324 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.053299 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.079694 [TEST] Reconnect 2
15:47:43.093820 [1] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.093831 [1] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.093868 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.094014 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.094216 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.094224 [4] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.094249 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.094241 [3] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.094276 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.094258 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.094736 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.094790 [2] ... term out of date in AppendEntries
15:47:43.094804 [2] becomes Follower with term=2; log=[]
15:47:43.094772 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.094835 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.094863 [2] election timer started (180ms), term=2
15:47:43.095115 [1] AppendEntries reply from 4 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.095174 [1] AppendEntries reply from 3 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.095953 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.143865 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.143870 [1] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.143925 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.143890 [1] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.144528 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.144543 [4] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.144601 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.144653 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.144670 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.144684 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.144735 [3] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.144807 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.145422 [1] AppendEntries reply from 4 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.146024 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.146117 [1] AppendEntries reply from 3 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.146193 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.193896 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.193877 [1] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.193878 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.193932 [1] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.194630 [4] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.194646 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.194694 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.194707 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.194629 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.194634 [3] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.194781 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.194756 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:43.197313 [1] AppendEntries reply from 4 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.197390 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.197485 [1] AppendEntries reply from 3 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.197842 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0 3:0 4:0], matchIndex := map[0:-1 2:-1 3:-1 4:-1]
15:47:43.230928 [0] becomes Dead
15:47:43.230987 [0] commitChanSender done
15:47:43.231006 Received quit signal. Shutting down...
15:47:43.231103 Listener close error: close tcp [::]:56742: use of closed network connection
15:47:43.231141 [0] CraftServer terminated!
15:47:43.231171 [1] becomes Dead
15:47:43.231219 [1] commitChanSender done
15:47:43.231231 Received quit signal. Shutting down...
15:47:43.231294 Listener close error: close tcp [::]:56743: use of closed network connection
15:47:43.231324 [1] CraftServer terminated!
15:47:43.231356 [2] becomes Dead
15:47:43.231405 [2] commitChanSender done
15:47:43.231416 Received quit signal. Shutting down...
15:47:43.231428 Listener close error: close tcp [::]:56744: use of closed network connection
15:47:43.231454 [2] CraftServer terminated!
15:47:43.231485 [3] becomes Dead
15:47:43.231525 [3] commitChanSender done
15:47:43.231537 Received quit signal. Shutting down...
15:47:43.231583 Listener close error: close tcp [::]:56745: use of closed network connection
15:47:43.231616 [3] CraftServer terminated!
15:47:43.231653 [4] becomes Dead
15:47:43.231691 [4] commitChanSender done
15:47:43.231731 Received quit signal. Shutting down...
15:47:43.231728 [0] in election timer state=DEAD, bailing out
15:47:43.231745 Listener close error: close tcp [::]:56746: use of closed network connection
15:47:43.231777 [4] CraftServer terminated!
15:47:43.232264 [3] in election timer state=DEAD, bailing out
15:47:43.235268 [2] in election timer state=DEAD, bailing out
15:47:43.242310 [4] in election timer state=DEAD, bailing out
--- PASS: TestElectionLeaderDisconnectThenReconnect5 (0.82s)
=== RUN   TestElectionFollowerComesBack
15:47:43.290041 [0] listening at [::]:56755
15:47:43.290395 [1] listening at [::]:56756
15:47:43.290763 [2] listening at [::]:56757
15:47:43.291035 [1] election timer started (217ms), term=0
15:47:43.291080 [2] election timer started (208ms), term=0
15:47:43.291090 [0] election timer started (262ms), term=0
15:47:43.502206 [2] becomes Candidate (currentTerm=1); log=[]
15:47:43.502381 [2] election timer started (150ms), term=1
15:47:43.502352 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:43.502342 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:43.504305 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:43.504451 [0] ... term out of date in RequestVote
15:47:43.504303 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:43.504539 [1] ... term out of date in RequestVote
15:47:43.504488 [0] becomes Follower with term=1; log=[]
15:47:43.504586 [1] becomes Follower with term=1; log=[]
15:47:43.504630 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:43.504654 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:43.504785 [1] election timer started (177ms), term=1
15:47:43.504748 [0] election timer started (220ms), term=1
15:47:43.508301 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:43 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:43.508409 [2] wins election with 2 votes
15:47:43.508434 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
15:47:43.508516 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.508523 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.508702 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:43 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:43.508855 [2] while waiting for reply, state = LEADER
15:47:43.509112 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.509134 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.509190 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.509207 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.511449 [0] in election timer term changed from 0 to 1, bailing out
15:47:43.511754 [1] in election timer term changed from 0 to 1, bailing out
15:47:43.512758 [2] in election timer state=LEADER, bailing out
15:47:43.512798 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.512872 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.558799 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.558801 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.559984 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.559974 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.560135 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.560180 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.562765 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.562898 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.592541 [TEST] Disconnect 0
15:47:43.608799 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.608799 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.609693 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.609814 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.610695 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.658772 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.658772 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.659398 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.659462 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.660457 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.708862 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.708854 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.710171 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.710302 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.711233 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.758843 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.758844 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.760235 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.760403 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.761888 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.786938 [0] becomes Candidate (currentTerm=2); log=[]
15:47:43.787059 [0] election timer started (251ms), term=2
15:47:43.787058 [0] sending RequestVote to 2: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:43.787045 [0] sending RequestVote to 1: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:43.808781 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.808781 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.809861 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.809941 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.811454 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.858844 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.858843 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.860638 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.860811 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.862680 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.908817 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.908813 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.910652 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.910816 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.911728 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:43.958828 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.958828 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.960551 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:43.960740 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:43.962929 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.008825 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.008825 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.010073 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.010170 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.012061 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.047210 [0] becomes Candidate (currentTerm=3); log=[]
15:47:44.047413 [0] election timer started (255ms), term=3
15:47:44.047381 [0] sending RequestVote to 2: Term:3 LastLogIndex:-1 LastLogTerm:-1
15:47:44.047373 [0] sending RequestVote to 1: Term:3 LastLogIndex:-1 LastLogTerm:-1
15:47:44.058707 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.058707 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.060392 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.060584 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.064204 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.108793 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.108793 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.110059 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.110164 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.111788 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.158764 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.158764 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.160558 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.160715 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.162002 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.208789 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.208789 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.210670 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.210843 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.213277 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.243615 [TEST] Reconnect 0
15:47:44.258749 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.258760 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.259921 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.260026 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.260459 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.260554 [0] AppendEntries reply: Term:3 Success:%!d(bool=false)
15:47:44.260995 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.262587 [2] term out of date in heartbeat reply
15:47:44.262637 [2] becomes Follower with term=3; log=[]
15:47:44.262752 [2] election timer started (281ms), term=3
15:47:44.307764 [0] becomes Candidate (currentTerm=4); log=[]
15:47:44.307943 [0] election timer started (277ms), term=4
15:47:44.307937 [0] sending RequestVote to 1: Term:4 LastLogIndex:-1 LastLogTerm:-1
15:47:44.307947 [0] sending RequestVote to 2: Term:4 LastLogIndex:-1 LastLogTerm:-1
15:47:44.309905 [2] RequestVote: Term:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=3, votedFor=-1, log index/term=(-1, -1)]
15:47:44.309998 [2] ... term out of date in RequestVote
15:47:44.309916 [1] RequestVote: Term:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:44.310023 [2] becomes Follower with term=4; log=[]
15:47:44.310033 [1] ... term out of date in RequestVote
15:47:44.310055 [1] becomes Follower with term=4; log=[]
15:47:44.310091 [1] ... RequestVote reply: Term:4 Votegranted:%!d(bool=true)
15:47:44.310138 [1] election timer started (252ms), term=4
15:47:44.310094 [2] ... RequestVote reply: Term:4 Votegranted:%!d(bool=true)
15:47:44.310322 [2] election timer started (196ms), term=4
15:47:44.313130 [0] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:44 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:44.313269 [0] wins election with 2 votes
15:47:44.313306 [2] in election timer term changed from 3 to 4, bailing out
15:47:44.313295 [0] becomes Leader; term=4, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:44.313388 [0] sending AppendEntries to 2: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.313403 [0] sending AppendEntries to 1: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.313416 [0] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:44 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:44.313512 [0] while waiting for reply, state = LEADER
15:47:44.314274 [1] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.314274 [2] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.314350 [1] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:44.314357 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:44.315956 [1] in election timer term changed from 1 to 4, bailing out
15:47:44.316477 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:44.316555 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:44.318300 [0] in election timer state=LEADER, bailing out
15:47:44.363710 [0] sending AppendEntries to 2: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.363710 [0] sending AppendEntries to 1: ni=0, args=Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.365390 [2] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.365391 [1] AppendEntries: Term:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.365535 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:44.365556 [1] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:44.367524 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:44.367606 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:44.394687 [0] becomes Dead
15:47:44.394757 [0] commitChanSender done
15:47:44.394761 Received quit signal. Shutting down...
15:47:44.394836 Listener close error: close tcp [::]:56755: use of closed network connection
15:47:44.394887 [0] CraftServer terminated!
15:47:44.394915 [1] becomes Dead
15:47:44.394967 [1] commitChanSender done
15:47:44.394954 Received quit signal. Shutting down...
15:47:44.395010 Listener close error: close tcp [::]:56756: use of closed network connection
15:47:44.395050 [1] CraftServer terminated!
15:47:44.395084 [2] becomes Dead
15:47:44.395129 Received quit signal. Shutting down...
15:47:44.395125 [2] commitChanSender done
15:47:44.395189 Listener close error: close tcp [::]:56757: use of closed network connection
15:47:44.395228 [2] CraftServer terminated!
15:47:44.400480 [1] in election timer state=DEAD, bailing out
15:47:44.402135 [2] in election timer state=DEAD, bailing out
--- PASS: TestElectionFollowerComesBack (1.16s)
=== RUN   TestElectionDisconnectLoop
15:47:44.450701 [0] listening at [::]:56763
15:47:44.451200 [1] listening at [::]:56764
15:47:44.451610 [2] listening at [::]:56765
15:47:44.451925 [1] election timer started (180ms), term=0
15:47:44.451934 [0] election timer started (179ms), term=0
15:47:44.451920 [2] election timer started (161ms), term=0
15:47:44.613167 [2] becomes Candidate (currentTerm=1); log=[]
15:47:44.613415 [2] election timer started (160ms), term=1
15:47:44.613404 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:44.613441 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:44.616231 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:44.616232 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:44.616776 [1] ... term out of date in RequestVote
15:47:44.616794 [0] ... term out of date in RequestVote
15:47:44.616802 [1] becomes Follower with term=1; log=[]
15:47:44.616815 [0] becomes Follower with term=1; log=[]
15:47:44.616841 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:44.616888 [1] election timer started (159ms), term=1
15:47:44.616848 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:44.617235 [0] election timer started (199ms), term=1
15:47:44.618657 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:44 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:44.618794 [2] wins election with 2 votes
15:47:44.618817 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
15:47:44.618890 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:44 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:44.618989 [2] while waiting for reply, state = LEADER
15:47:44.619102 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.619300 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.619988 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.620070 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.620061 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.620142 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.622536 [1] in election timer term changed from 0 to 1, bailing out
15:47:44.622642 [0] in election timer term changed from 0 to 1, bailing out
15:47:44.622999 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.623569 [2] in election timer state=LEADER, bailing out
15:47:44.623824 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.669149 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.669149 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.670869 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.671027 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.670871 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.671108 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.674167 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.674548 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.719187 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.719187 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.721019 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.721035 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.721204 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.721317 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:44.722469 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.722616 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:44.753772 [TEST] Disconnect 2
15:47:44.754174 [TEST] Disconnect 0
15:47:44.769168 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.769174 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.819123 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.819122 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.869156 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.869156 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.888066 [1] becomes Candidate (currentTerm=2); log=[]
15:47:44.888244 [1] election timer started (282ms), term=2
15:47:44.888238 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:44.888224 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:44.919062 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.919062 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.928384 [0] becomes Candidate (currentTerm=2); log=[]
15:47:44.928500 [0] election timer started (299ms), term=2
15:47:44.928476 [0] sending RequestVote to 1: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:44.928477 [0] sending RequestVote to 2: Term:2 LastLogIndex:-1 LastLogTerm:-1
15:47:44.969479 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:44.969479 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.019532 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.019532 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.064956 [TEST] Reconnect 0
15:47:45.065388 [TEST] Reconnect 2
15:47:45.069028 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.069012 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.071837 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.071944 [0] AppendEntries reply: Term:2 Success:%!d(bool=false)
15:47:45.071963 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.072037 [1] AppendEntries reply: Term:2 Success:%!d(bool=false)
15:47:45.072836 [2] term out of date in heartbeat reply
15:47:45.072862 [2] becomes Follower with term=2; log=[]
15:47:45.072928 [2] term out of date in heartbeat reply
15:47:45.072916 [2] election timer started (283ms), term=2
15:47:45.072959 [2] becomes Follower with term=2; log=[]
15:47:45.072999 [2] election timer started (166ms), term=2
15:47:45.179056 [1] becomes Candidate (currentTerm=3); log=[]
15:47:45.179250 [1] election timer started (193ms), term=3
15:47:45.179246 [1] sending RequestVote to 0: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:45.179263 [1] sending RequestVote to 2: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:45.181895 [2] RequestVote: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=-1, log index/term=(-1, -1)]
15:47:45.181899 [0] RequestVote: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=0, log index/term=(-1, -1)]
15:47:45.182049 [2] ... term out of date in RequestVote
15:47:45.182109 [0] ... term out of date in RequestVote
15:47:45.182137 [2] becomes Follower with term=3; log=[]
15:47:45.182147 [0] becomes Follower with term=3; log=[]
15:47:45.182220 [2] ... RequestVote reply: Term:3 Votegranted:%!d(bool=true)
15:47:45.182251 [0] ... RequestVote reply: Term:3 Votegranted:%!d(bool=true)
15:47:45.182283 [2] election timer started (227ms), term=3
15:47:45.182368 [0] election timer started (239ms), term=3
15:47:45.183225 [2] in election timer term changed from 2 to 3, bailing out
15:47:45.183291 [2] in election timer term changed from 2 to 3, bailing out
15:47:45.184827 [1] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:45 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:45.184942 [1] wins election with 2 votes
15:47:45.184967 [1] becomes Leader; term=3, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
15:47:45.185068 [1] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:45 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:45.185222 [1] while waiting for reply, state = LEADER
15:47:45.185259 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.185048 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.186323 [0] AppendEntries: Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.186463 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:45.187536 [2] AppendEntries: Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.187638 [2] AppendEntries reply: Term:3 Success:%!d(bool=true)
15:47:45.188978 [0] in election timer term changed from 2 to 3, bailing out
15:47:45.190036 [1] in election timer state=LEADER, bailing out
15:47:45.190080 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:45.190144 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:45.215901 [TEST] Disconnect 1
15:47:45.216361 [TEST] Disconnect 2
15:47:45.235344 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.235343 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.285373 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.285373 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.335370 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.335370 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.385391 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.385506 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.423409 [2] becomes Candidate (currentTerm=4); log=[]
15:47:45.423482 [2] election timer started (242ms), term=4
15:47:45.423489 [2] sending RequestVote to 1: Term:4 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:45.423480 [2] sending RequestVote to 0: Term:4 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:45.433437 [0] becomes Candidate (currentTerm=4); log=[]
15:47:45.433498 [0] election timer started (230ms), term=4
15:47:45.433496 [0] sending RequestVote to 1: Term:4 LastLogIndex:-1 LastLogTerm:-1
15:47:45.433508 [0] sending RequestVote to 2: Term:4 LastLogIndex:-1 LastLogTerm:-1
15:47:45.435263 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.435277 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.485244 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.485236 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.526825 [TEST] Reconnect 2
15:47:45.527050 [TEST] Reconnect 1
15:47:45.535179 [1] sending AppendEntries to 2: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.535211 [1] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.536818 [0] AppendEntries: Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.537383 [0] AppendEntries reply: Term:4 Success:%!d(bool=false)
15:47:45.537499 [2] AppendEntries: Term:3 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.537579 [2] AppendEntries reply: Term:4 Success:%!d(bool=false)
15:47:45.538743 [1] term out of date in heartbeat reply
15:47:45.538774 [1] becomes Follower with term=4; log=[]
15:47:45.538822 [1] election timer started (216ms), term=4
15:47:45.538945 [1] term out of date in heartbeat reply
15:47:45.538974 [1] becomes Follower with term=4; log=[]
15:47:45.539016 [1] election timer started (241ms), term=4
15:47:45.664119 [0] becomes Candidate (currentTerm=5); log=[]
15:47:45.664310 [0] election timer started (251ms), term=5
15:47:45.664276 [0] sending RequestVote to 1: Term:5 LastLogIndex:-1 LastLogTerm:-1
15:47:45.664266 [0] sending RequestVote to 2: Term:5 LastLogIndex:-1 LastLogTerm:-1
15:47:45.667696 [1] RequestVote: Term:5 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=4, votedFor=-1, log index/term=(-1, -1)]
15:47:45.667783 [1] ... term out of date in RequestVote
15:47:45.667698 [2] RequestVote: Term:5 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=4, votedFor=2, log index/term=(-1, -1)]
15:47:45.667802 [1] becomes Follower with term=5; log=[]
15:47:45.667812 [2] ... term out of date in RequestVote
15:47:45.667838 [1] ... RequestVote reply: Term:5 Votegranted:%!d(bool=true)
15:47:45.667850 [2] becomes Follower with term=5; log=[]
15:47:45.667886 [2] ... RequestVote reply: Term:5 Votegranted:%!d(bool=true)
15:47:45.667918 [1] election timer started (257ms), term=5
15:47:45.667966 [2] election timer started (177ms), term=5
15:47:45.669736 [1] in election timer term changed from 4 to 5, bailing out
15:47:45.669788 [1] in election timer term changed from 4 to 5, bailing out
15:47:45.670805 [0] received RequestVoteReply &{Msg:Term:5 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:45 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:45.670938 [0] wins election with 2 votes
15:47:45.670969 [0] becomes Leader; term=5, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:45.671035 [0] received RequestVoteReply &{Msg:Term:5 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:45 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:45.671122 [0] while waiting for reply, state = LEADER
15:47:45.671178 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.671187 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.672216 [2] AppendEntries: Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.672304 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:45.672702 [1] AppendEntries: Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.672834 [1] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:45.674025 [2] in election timer term changed from 4 to 5, bailing out
15:47:45.674814 [0] in election timer state=LEADER, bailing out
15:47:45.675041 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:45.675580 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:45.677271 [TEST] Disconnect 0
15:47:45.677539 [TEST] Disconnect 1
15:47:45.721473 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.721441 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.771427 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.771427 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.821439 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.821449 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.859065 [2] becomes Candidate (currentTerm=6); log=[]
15:47:45.859255 [2] election timer started (161ms), term=6
15:47:45.859221 [2] sending RequestVote to 0: Term:6 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:45.859224 [2] sending RequestVote to 1: Term:6 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:45.871342 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.871342 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.921404 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.921403 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.939069 [1] becomes Candidate (currentTerm=6); log=[]
15:47:45.939180 [1] election timer started (170ms), term=6
15:47:45.939173 [1] sending RequestVote to 0: Term:6 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:45.939192 [1] sending RequestVote to 2: Term:6 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:45.971239 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.971239 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:45.988682 [TEST] Reconnect 1
15:47:45.988917 [TEST] Reconnect 0
15:47:46.021416 [0] sending AppendEntries to 2: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.021415 [0] sending AppendEntries to 1: ni=0, args=Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.023376 [2] AppendEntries: Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.023376 [1] AppendEntries: Term:5 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.023461 [2] AppendEntries reply: Term:6 Success:%!d(bool=false)
15:47:46.023489 [1] AppendEntries reply: Term:6 Success:%!d(bool=false)
15:47:46.024299 [0] term out of date in heartbeat reply
15:47:46.024334 [0] becomes Follower with term=6; log=[]
15:47:46.024391 [0] election timer started (175ms), term=6
15:47:46.024960 [0] term out of date in heartbeat reply
15:47:46.024992 [0] becomes Follower with term=6; log=[]
15:47:46.025046 [0] election timer started (252ms), term=6
15:47:46.029439 [2] becomes Candidate (currentTerm=7); log=[]
15:47:46.029538 [2] election timer started (156ms), term=7
15:47:46.029533 [2] sending RequestVote to 0: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:46.029529 [2] sending RequestVote to 1: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:46.030829 [0] RequestVote: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=6, votedFor=-1, log index/term=(-1, -1)]
15:47:46.030910 [0] ... term out of date in RequestVote
15:47:46.030936 [0] becomes Follower with term=7; log=[]
15:47:46.030971 [0] ... RequestVote reply: Term:7 Votegranted:%!d(bool=true)
15:47:46.030934 [1] RequestVote: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=6, votedFor=1, log index/term=(-1, -1)]
15:47:46.031007 [1] ... term out of date in RequestVote
15:47:46.031033 [1] becomes Follower with term=7; log=[]
15:47:46.031066 [1] ... RequestVote reply: Term:7 Votegranted:%!d(bool=true)
15:47:46.031273 [0] election timer started (270ms), term=7
15:47:46.031122 [1] election timer started (239ms), term=7
15:47:46.033885 [2] received RequestVoteReply &{Msg:Term:7 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:46 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:46.034007 [2] wins election with 2 votes
15:47:46.034030 [2] becomes Leader; term=7, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
15:47:46.034088 [2] received RequestVoteReply &{Msg:Term:7 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:46 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:46.034169 [2] while waiting for reply, state = LEADER
15:47:46.034214 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.034233 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.034629 [0] in election timer term changed from 6 to 7, bailing out
15:47:46.034914 [1] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.034940 [0] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.034984 [1] AppendEntries reply: Term:7 Success:%!d(bool=true)
15:47:46.035012 [0] AppendEntries reply: Term:7 Success:%!d(bool=true)
15:47:46.035097 [0] in election timer term changed from 6 to 7, bailing out
15:47:46.036555 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:46.036668 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:46.039530 [1] in election timer term changed from 6 to 7, bailing out
15:47:46.039679 [2] in election timer state=LEADER, bailing out
15:47:46.084346 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.084349 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.085402 [1] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.085404 [0] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.085498 [1] AppendEntries reply: Term:7 Success:%!d(bool=true)
15:47:46.085521 [0] AppendEntries reply: Term:7 Success:%!d(bool=true)
15:47:46.087217 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:46.087288 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:46.134366 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.134378 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.135778 [1] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.135779 [0] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.135998 [0] AppendEntries reply: Term:7 Success:%!d(bool=true)
15:47:46.135941 [1] AppendEntries reply: Term:7 Success:%!d(bool=true)
15:47:46.139212 [TEST] Disconnect 2
15:47:46.139406 [TEST] Disconnect 0
15:47:46.140241 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:46.140336 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:46.184406 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.184406 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.234349 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.234349 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.284336 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.284336 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.334322 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.334322 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.383154 [1] becomes Candidate (currentTerm=8); log=[]
15:47:46.383337 [1] election timer started (261ms), term=8
15:47:46.383339 [1] sending RequestVote to 0: Term:8 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:46.383360 [1] sending RequestVote to 2: Term:8 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:46.384291 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.384299 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.413161 [0] becomes Candidate (currentTerm=8); log=[]
15:47:46.413337 [0] election timer started (174ms), term=8
15:47:46.413305 [0] sending RequestVote to 1: Term:8 LastLogIndex:-1 LastLogTerm:-1
15:47:46.413307 [0] sending RequestVote to 2: Term:8 LastLogIndex:-1 LastLogTerm:-1
15:47:46.434572 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.434550 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.450259 [TEST] Reconnect 0
15:47:46.450519 [TEST] Reconnect 2
15:47:46.484585 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.484592 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.486380 [0] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.486380 [1] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.486472 [0] AppendEntries reply: Term:8 Success:%!d(bool=false)
15:47:46.486501 [1] AppendEntries reply: Term:8 Success:%!d(bool=false)
15:47:46.489319 [2] term out of date in heartbeat reply
15:47:46.489352 [2] becomes Follower with term=8; log=[]
15:47:46.489411 [2] term out of date in heartbeat reply
15:47:46.489404 [2] election timer started (297ms), term=8
15:47:46.489440 [2] becomes Follower with term=8; log=[]
15:47:46.489484 [2] election timer started (286ms), term=8
15:47:46.593937 [0] becomes Candidate (currentTerm=9); log=[]
15:47:46.594188 [0] election timer started (251ms), term=9
15:47:46.594150 [0] sending RequestVote to 1: Term:9 LastLogIndex:-1 LastLogTerm:-1
15:47:46.594137 [0] sending RequestVote to 2: Term:9 LastLogIndex:-1 LastLogTerm:-1
15:47:46.596315 [1] RequestVote: Term:9 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=8, votedFor=1, log index/term=(-1, -1)]
15:47:46.596315 [2] RequestVote: Term:9 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=8, votedFor=-1, log index/term=(-1, -1)]
15:47:46.596398 [1] ... term out of date in RequestVote
15:47:46.596418 [2] ... term out of date in RequestVote
15:47:46.596421 [1] becomes Follower with term=9; log=[]
15:47:46.596441 [2] becomes Follower with term=9; log=[]
15:47:46.596456 [1] ... RequestVote reply: Term:9 Votegranted:%!d(bool=true)
15:47:46.596473 [2] ... RequestVote reply: Term:9 Votegranted:%!d(bool=true)
15:47:46.596498 [1] election timer started (298ms), term=9
15:47:46.596526 [2] election timer started (282ms), term=9
15:47:46.598311 [0] received RequestVoteReply &{Msg:Term:9 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:46 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:46.598444 [0] wins election with 2 votes
15:47:46.598467 [0] becomes Leader; term=9, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:46.598531 [0] received RequestVoteReply &{Msg:Term:9 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:46 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:46.598622 [0] while waiting for reply, state = LEADER
15:47:46.598678 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.598688 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.599223 [1] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.599225 [2] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.599292 [1] AppendEntries reply: Term:9 Success:%!d(bool=true)
15:47:46.599296 [2] AppendEntries reply: Term:9 Success:%!d(bool=true)
15:47:46.600179 [2] in election timer term changed from 8 to 9, bailing out
15:47:46.600453 [2] in election timer term changed from 8 to 9, bailing out
15:47:46.600509 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:46.600987 [TEST] Disconnect 0
15:47:46.601228 [TEST] Disconnect 1
15:47:46.602802 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:46.603563 [1] in election timer term changed from 8 to 9, bailing out
15:47:46.604437 [0] in election timer state=LEADER, bailing out
15:47:46.648842 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.648842 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.698792 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.698803 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.748778 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.748778 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.798799 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.798798 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.848812 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.848812 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.887650 [2] becomes Candidate (currentTerm=10); log=[]
15:47:46.887827 [2] election timer started (238ms), term=10
15:47:46.887832 [2] sending RequestVote to 0: Term:10 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:46.887811 [2] sending RequestVote to 1: Term:10 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:46.897459 [1] becomes Candidate (currentTerm=10); log=[]
15:47:46.897560 [1] election timer started (223ms), term=10
15:47:46.897595 [1] sending RequestVote to 0: Term:10 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:46.897623 [1] sending RequestVote to 2: Term:10 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:46.898674 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.898679 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.911927 [TEST] Reconnect 1
15:47:46.912217 [TEST] Reconnect 0
15:47:46.948819 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.948818 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.950917 [2] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.950919 [1] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:46.951010 [2] AppendEntries reply: Term:10 Success:%!d(bool=false)
15:47:46.951037 [1] AppendEntries reply: Term:10 Success:%!d(bool=false)
15:47:46.952034 [0] term out of date in heartbeat reply
15:47:46.952070 [0] becomes Follower with term=10; log=[]
15:47:46.952224 [0] election timer started (224ms), term=10
15:47:46.952721 [0] term out of date in heartbeat reply
15:47:46.952748 [0] becomes Follower with term=10; log=[]
15:47:46.952791 [0] election timer started (290ms), term=10
15:47:47.063518 [0] becomes Dead
15:47:47.063656 [0] commitChanSender done
15:47:47.063661 Received quit signal. Shutting down...
15:47:47.063804 Listener close error: close tcp [::]:56763: use of closed network connection
15:47:47.063885 [0] CraftServer terminated!
15:47:47.063956 [1] becomes Dead
15:47:47.064032 [1] commitChanSender done
15:47:47.064039 Received quit signal. Shutting down...
15:47:47.064130 Listener close error: close tcp [::]:56764: use of closed network connection
15:47:47.064192 [1] CraftServer terminated!
15:47:47.064244 [2] becomes Dead
15:47:47.064323 [2] commitChanSender done
15:47:47.064325 Received quit signal. Shutting down...
15:47:47.064410 Listener close error: close tcp [::]:56765: use of closed network connection
15:47:47.064471 [2] CraftServer terminated!
15:47:47.068252 [1] in election timer state=DEAD, bailing out
15:47:47.068266 [2] in election timer state=DEAD, bailing out
15:47:47.072814 [0] in election timer state=DEAD, bailing out
15:47:47.072873 [0] in election timer state=DEAD, bailing out
--- PASS: TestElectionDisconnectLoop (2.67s)
=== RUN   TestCommitOneCommand
15:47:47.120757 [0] listening at [::]:56786
15:47:47.121261 [1] listening at [::]:56787
15:47:47.121659 [2] listening at [::]:56788
15:47:47.121930 [1] election timer started (296ms), term=0
15:47:47.121950 [2] election timer started (204ms), term=0
15:47:47.121937 [0] election timer started (204ms), term=0
15:47:47.333135 [2] becomes Candidate (currentTerm=1); log=[]
15:47:47.333123 [0] becomes Candidate (currentTerm=1); log=[]
15:47:47.333294 [2] election timer started (255ms), term=1
15:47:47.333397 [0] election timer started (201ms), term=1
15:47:47.333285 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:47.333373 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:47.333412 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:47.333310 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:47.335467 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:47.335485 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=0, log index/term=(-1, -1)]
15:47:47.335552 [1] ... term out of date in RequestVote
15:47:47.335559 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:47.335571 [1] becomes Follower with term=1; log=[]
15:47:47.335604 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:47.336351 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:47.336454 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:47.337449 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:47.337546 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:47.338459 [1] election timer started (225ms), term=1
15:47:47.341058 [2] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:47 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:47.341186 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:47 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:47.341424 [2] wins election with 2 votes
15:47:47.341449 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
15:47:47.341376 [0] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:47 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:47.341538 [0] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:47 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:47.341715 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.341563 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.342338 [1] in election timer term changed from 0 to 1, bailing out
15:47:47.342595 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.342671 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.342660 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.342736 [0] becomes Follower with term=1; log=[]
15:47:47.342772 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.343762 [0] election timer started (229ms), term=1
15:47:47.343800 [2] in election timer state=LEADER, bailing out
15:47:47.344850 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:47.344911 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:47.391699 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.391696 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.392908 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.392899 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.393045 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.393070 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.395008 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:47.395101 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]
15:47:47.423555 [TEST] submitting 42 to 2
15:47:47.423664 [2] Submit received by LEADER: 42
15:47:47.423717 [2] ... log=[{42 1}]
15:47:47.441973 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:47.441963 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:47.443572 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:47.443555 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:47.443711 [1] ... inserting entries [Command:42 Term:1] from index 0
15:47:47.443772 [1] ... log is now: [{42 1}]
15:47:47.443804 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.443720 [0] ... inserting entries [Command:42 Term:1] from index 0
15:47:47.443897 [0] ... log is now: [{42 1}]
15:47:47.443927 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.444869 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:1], matchIndex := map[0:-1 1:0]
15:47:47.445036 [2] leader sets commitIndex := 0
15:47:47.445131 [2] commitChanSender entries=[{42 1}], savedLastApplied=-1
15:47:47.445199 [TEST] collectCommits(2) got {Command:42 Index:0 Term:1}
15:47:47.445576 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]
15:47:47.491930 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.491943 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.493260 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.493253 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.493377 [1] ... setting commitIndex=0
15:47:47.493419 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.493408 [0] ... setting commitIndex=0
15:47:47.493493 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.493583 [0] commitChanSender entries=[{42 1}], savedLastApplied=-1
15:47:47.493654 [TEST] collectCommits(0) got {Command:42 Index:0 Term:1}
15:47:47.493566 [1] commitChanSender entries=[{42 1}], savedLastApplied=-1
15:47:47.493746 [TEST] collectCommits(1) got {Command:42 Index:0 Term:1}
15:47:47.494481 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]
15:47:47.494933 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]
15:47:47.541995 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.541961 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.543362 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.543505 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.543361 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
15:47:47.543580 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.544502 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]
15:47:47.544586 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]
15:47:47.574623 [0] becomes Dead
15:47:47.574689 [0] commitChanSender done
15:47:47.574705 Received quit signal. Shutting down...
15:47:47.574828 Listener close error: close tcp [::]:56786: use of closed network connection
15:47:47.574893 [0] CraftServer terminated!
15:47:47.574940 [1] becomes Dead
15:47:47.574993 Received quit signal. Shutting down...
15:47:47.574990 [1] commitChanSender done
15:47:47.575065 Listener close error: close tcp [::]:56787: use of closed network connection
15:47:47.575107 [1] CraftServer terminated!
15:47:47.575151 [2] becomes Dead
15:47:47.575200 Received quit signal. Shutting down...
15:47:47.575218 [2] commitChanSender done
15:47:47.575253 Listener close error: close tcp [::]:56788: use of closed network connection
15:47:47.575291 [2] CraftServer terminated!
15:47:47.579086 [1] in election timer state=DEAD, bailing out
15:47:47.584147 [0] in election timer state=DEAD, bailing out
15:47:47.584221 [0] in election timer state=DEAD, bailing out
--- PASS: TestCommitOneCommand (0.51s)
=== RUN   TestSubmitNonLeaderFails
15:47:47.628732 [0] listening at [::]:56793
15:47:47.629349 [1] listening at [::]:56794
15:47:47.629757 [2] listening at [::]:56795
15:47:47.630112 [2] election timer started (283ms), term=0
15:47:47.630117 [0] election timer started (251ms), term=0
15:47:47.630125 [1] election timer started (234ms), term=0
15:47:47.871320 [1] becomes Candidate (currentTerm=1); log=[]
15:47:47.871515 [1] election timer started (267ms), term=1
15:47:47.871526 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:47.871507 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:47.874021 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:47.874005 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:47.874213 [2] ... term out of date in RequestVote
15:47:47.874230 [0] ... term out of date in RequestVote
15:47:47.874256 [2] becomes Follower with term=1; log=[]
15:47:47.874270 [0] becomes Follower with term=1; log=[]
15:47:47.874331 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:47.874325 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:47.874452 [2] election timer started (237ms), term=1
15:47:47.874570 [0] election timer started (236ms), term=1
15:47:47.876656 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:47 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:47.876775 [1] wins election with 2 votes
15:47:47.876805 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
15:47:47.876868 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:47 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:47.876947 [1] while waiting for reply, state = LEADER
15:47:47.876994 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.877007 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.877680 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.877703 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.877759 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.877778 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.880003 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:47.880093 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:47.880277 [0] in election timer term changed from 0 to 1, bailing out
15:47:47.880290 [2] in election timer term changed from 0 to 1, bailing out
15:47:47.881720 [1] in election timer state=LEADER, bailing out
15:47:47.927231 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.927222 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.927941 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.927937 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:47.928016 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.928045 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:47.929412 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:47.929494 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:47.931496 [TEST] submitting 42 to 2
15:47:47.931531 [2] Submit received by FOLLOWER: 42
15:47:47.942625 [0] becomes Dead
15:47:47.942681 [0] commitChanSender done
15:47:47.942674 Received quit signal. Shutting down...
15:47:47.942787 Listener close error: close tcp [::]:56793: use of closed network connection
15:47:47.942828 [0] CraftServer terminated!
15:47:47.942860 [1] becomes Dead
15:47:47.942901 [1] commitChanSender done
15:47:47.942925 Received quit signal. Shutting down...
15:47:47.942957 Listener close error: close tcp [::]:56794: use of closed network connection
15:47:47.942988 [1] CraftServer terminated!
15:47:47.943019 [2] becomes Dead
15:47:47.943049 Received quit signal. Shutting down...
15:47:47.943068 [2] commitChanSender done
15:47:47.943123 Listener close error: close tcp [::]:56795: use of closed network connection
15:47:47.943160 [2] CraftServer terminated!
--- PASS: TestSubmitNonLeaderFails (0.32s)
=== RUN   TestCommitMultipleCommands
15:47:47.944553 [2] in election timer state=DEAD, bailing out
15:47:47.944653 [0] in election timer state=DEAD, bailing out
15:47:47.945051 [0] listening at [::]:56798
15:47:47.945332 [1] listening at [::]:56799
15:47:47.945586 [2] listening at [::]:56800
15:47:47.945768 [1] election timer started (202ms), term=0
15:47:47.945777 [2] election timer started (294ms), term=0
15:47:47.945783 [0] election timer started (293ms), term=0
15:47:48.156980 [1] becomes Candidate (currentTerm=1); log=[]
15:47:48.157131 [1] election timer started (223ms), term=1
15:47:48.157114 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:48.157110 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:48.158655 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:48.158731 [2] ... term out of date in RequestVote
15:47:48.158656 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:48.158748 [2] becomes Follower with term=1; log=[]
15:47:48.158760 [0] ... term out of date in RequestVote
15:47:48.158783 [0] becomes Follower with term=1; log=[]
15:47:48.158788 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:48.158809 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:48.158870 [2] election timer started (265ms), term=1
15:47:48.158933 [0] election timer started (225ms), term=1
15:47:48.160132 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:48 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:48.160237 [1] wins election with 2 votes
15:47:48.160257 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
15:47:48.160315 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:48 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:48.160393 [1] while waiting for reply, state = LEADER
15:47:48.160443 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.160428 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.160954 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.160972 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.161012 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.161025 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.163717 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:48.163809 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:48.166179 [2] in election timer term changed from 0 to 1, bailing out
15:47:48.166211 [0] in election timer term changed from 0 to 1, bailing out
15:47:48.167414 [1] in election timer state=LEADER, bailing out
15:47:48.210569 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.210569 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.211642 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.211659 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.211741 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.211751 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.213334 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:48.213409 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:48.247790 [TEST] submitting 42 to 1
15:47:48.247868 [1] Submit received by LEADER: 42
15:47:48.247917 [1] ... log=[{42 1}]
15:47:48.260488 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:48.260486 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:48.262058 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:48.262081 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
15:47:48.262269 [2] ... inserting entries [Command:42 Term:1] from index 0
15:47:48.262359 [2] ... log is now: [{42 1}]
15:47:48.262287 [0] ... inserting entries [Command:42 Term:1] from index 0
15:47:48.262435 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.262494 [0] ... log is now: [{42 1}]
15:47:48.262554 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.266542 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:0], matchIndex := map[0:0 2:-1]
15:47:48.266611 [1] leader sets commitIndex := 0
15:47:48.266649 [1] commitChanSender entries=[{42 1}], savedLastApplied=-1
15:47:48.266664 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]
15:47:48.266705 [TEST] collectCommits(1) got {Command:42 Index:0 Term:1}
15:47:48.310459 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
15:47:48.310459 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
15:47:48.311730 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
15:47:48.311854 [2] ... setting commitIndex=0
15:47:48.311730 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
15:47:48.311904 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.311972 [0] ... setting commitIndex=0
15:47:48.312018 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.312010 [2] commitChanSender entries=[{42 1}], savedLastApplied=-1
15:47:48.312267 [TEST] collectCommits(2) got {Command:42 Index:0 Term:1}
15:47:48.312354 [0] commitChanSender entries=[{42 1}], savedLastApplied=-1
15:47:48.312465 [TEST] collectCommits(0) got {Command:42 Index:0 Term:1}
15:47:48.313223 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]
15:47:48.313889 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]
15:47:48.349051 [TEST] submitting 55 to 1
15:47:48.349177 [1] Submit received by LEADER: 55
15:47:48.349241 [1] ... log=[{42 1} {55 1}]
15:47:48.360518 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1 Entries:{Command:55 Term:1}
15:47:48.360547 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1 Entries:{Command:55 Term:1}
15:47:48.362158 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1 Entries:{Command:55 Term:1}
15:47:48.362457 [2] ... inserting entries [Command:55 Term:1] from index 1
15:47:48.362157 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1 Entries:{Command:55 Term:1}
15:47:48.362627 [2] ... log is now: [{42 1} {55 1}]
15:47:48.362759 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.362737 [0] ... inserting entries [Command:55 Term:1] from index 1
15:47:48.362869 [0] ... log is now: [{42 1} {55 1}]
15:47:48.363674 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.365276 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:2], matchIndex := map[0:0 2:1]
15:47:48.365345 [1] leader sets commitIndex := 1
15:47:48.365380 [1] commitChanSender entries=[{55 1}], savedLastApplied=0
15:47:48.365389 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:48.365421 [TEST] collectCommits(1) got {Command:55 Index:1 Term:1}
15:47:48.410451 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:48.410451 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:48.411702 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:48.411823 [2] ... setting commitIndex=1
15:47:48.411726 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:48.411863 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.411877 [0] ... setting commitIndex=1
15:47:48.411915 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.412139 [2] commitChanSender entries=[{55 1}], savedLastApplied=0
15:47:48.412690 [0] commitChanSender entries=[{55 1}], savedLastApplied=0
15:47:48.412656 [TEST] collectCommits(2) got {Command:55 Index:1 Term:1}
15:47:48.412872 [TEST] collectCommits(0) got {Command:55 Index:1 Term:1}
15:47:48.414311 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:48.414805 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:48.450006 [TEST] submitting 81 to 1
15:47:48.450118 [1] Submit received by LEADER: 81
15:47:48.450183 [1] ... log=[{42 1} {55 1} {81 1}]
15:47:48.460543 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
15:47:48.460493 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
15:47:48.462221 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
15:47:48.462328 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
15:47:48.462438 [2] ... inserting entries [Command:81 Term:1] from index 2
15:47:48.462543 [0] ... inserting entries [Command:81 Term:1] from index 2
15:47:48.462620 [2] ... log is now: [{42 1} {55 1} {81 1}]
15:47:48.462642 [0] ... log is now: [{42 1} {55 1} {81 1}]
15:47:48.462719 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.462764 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.464372 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:3], matchIndex := map[0:1 2:2]
15:47:48.464442 [1] leader sets commitIndex := 2
15:47:48.464477 [1] commitChanSender entries=[{81 1}], savedLastApplied=1
15:47:48.464530 [TEST] collectCommits(1) got {Command:81 Index:2 Term:1}
15:47:48.465000 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.510455 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.510462 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.511706 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.511827 [2] ... setting commitIndex=2
15:47:48.511866 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.511796 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.511996 [0] ... setting commitIndex=2
15:47:48.512039 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.511959 [2] commitChanSender entries=[{81 1}], savedLastApplied=1
15:47:48.512157 [TEST] collectCommits(2) got {Command:81 Index:2 Term:1}
15:47:48.512317 [0] commitChanSender entries=[{81 1}], savedLastApplied=1
15:47:48.512391 [TEST] collectCommits(0) got {Command:81 Index:2 Term:1}
15:47:48.514008 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.514085 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.560492 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.560493 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.562044 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.562044 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.562148 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.562170 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.563129 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.563783 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.610482 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.610474 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.612019 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.612027 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.612206 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.612246 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.615309 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.615400 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.660624 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.660625 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.662265 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.662268 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:48.662494 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.662530 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.664100 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.664601 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:48.701030 [0] becomes Dead
15:47:48.701102 Received quit signal. Shutting down...
15:47:48.701219 [0] commitChanSender done
15:47:48.701298 Listener close error: close tcp [::]:56798: use of closed network connection
15:47:48.701408 [0] CraftServer terminated!
15:47:48.701734 [1] becomes Dead
15:47:48.702128 [1] commitChanSender done
15:47:48.702131 Received quit signal. Shutting down...
15:47:48.702235 Listener close error: close tcp [::]:56799: use of closed network connection
15:47:48.702329 [1] CraftServer terminated!
15:47:48.702398 [2] becomes Dead
15:47:48.702518 Received quit signal. Shutting down...
15:47:48.702507 [2] commitChanSender done
15:47:48.702564 Listener close error: close tcp [::]:56800: use of closed network connection
15:47:48.702629 [2] CraftServer terminated!
15:47:48.710083 [2] in election timer state=DEAD, bailing out
15:47:48.710101 [0] in election timer state=DEAD, bailing out
--- PASS: TestCommitMultipleCommands (0.81s)
=== RUN   TestCommitWithDisconnectionAndRecover
15:47:48.757625 [0] listening at [::]:56803
15:47:48.758014 [1] listening at [::]:56804
15:47:48.758349 [2] listening at [::]:56805
15:47:48.758620 [2] election timer started (233ms), term=0
15:47:48.758631 [1] election timer started (230ms), term=0
15:47:48.758643 [0] election timer started (297ms), term=0
15:47:48.989880 [1] becomes Candidate (currentTerm=1); log=[]
15:47:48.990098 [1] election timer started (199ms), term=1
15:47:48.990067 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:48.990061 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:48.992580 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:48.992580 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:48.992680 [2] ... term out of date in RequestVote
15:47:48.992696 [0] ... term out of date in RequestVote
15:47:48.992702 [2] becomes Follower with term=1; log=[]
15:47:48.992732 [0] becomes Follower with term=1; log=[]
15:47:48.992755 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:48.992774 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:48.992828 [2] election timer started (203ms), term=1
15:47:48.992835 [0] election timer started (264ms), term=1
15:47:48.994507 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:48 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:48.994646 [1] wins election with 2 votes
15:47:48.994679 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
15:47:48.994746 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:48 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:48.994827 [1] while waiting for reply, state = LEADER
15:47:48.994877 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.994891 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.996155 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.996687 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.996701 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:48.996794 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:48.998780 [0] in election timer term changed from 0 to 1, bailing out
15:47:48.999373 [2] in election timer term changed from 0 to 1, bailing out
15:47:48.999645 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:48.999999 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:49.000322 [1] in election timer state=LEADER, bailing out
15:47:49.044965 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:49.044965 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:49.046092 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:49.046092 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:49.046197 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.046229 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.048689 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:49.048771 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]
15:47:49.060420 [1] Submit received by LEADER: 5
15:47:49.060478 [1] ... log=[{5 1}]
15:47:49.060535 [1] Submit received by LEADER: 6
15:47:49.060568 [1] ... log=[{5 1} {6 1}]
15:47:49.095100 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:49.095102 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:49.096533 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:49.096532 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:49.096728 [0] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:49.096757 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:49.096830 [0] ... log is now: [{5 1} {6 1}]
15:47:49.096850 [2] ... log is now: [{5 1} {6 1}]
15:47:49.096883 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.096901 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.097850 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:0], matchIndex := map[0:1 2:-1]
15:47:49.097924 [1] leader sets commitIndex := 1
15:47:49.097966 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:49.098039 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
15:47:49.098093 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
15:47:49.098609 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.144987 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.144987 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.146108 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.146111 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.146203 [2] ... setting commitIndex=1
15:47:49.146221 [0] ... setting commitIndex=1
15:47:49.146239 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.146249 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.146323 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:49.146836 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
15:47:49.146914 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
15:47:49.146313 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:49.147024 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
15:47:49.147096 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
15:47:49.148707 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.148780 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.194991 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.195024 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.196608 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.196608 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.196762 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.196798 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.197839 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.198320 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.245007 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.245029 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.246546 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.246546 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.246708 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.246743 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.247880 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.248644 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.294980 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.294981 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.296537 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.296537 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.296716 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.296763 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.300020 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.300496 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.311597 [TEST] Disconnect 2
15:47:49.345052 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.345053 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.346288 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.346378 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.348229 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.394984 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.394984 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.396405 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.396515 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.398500 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.445025 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.445009 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.446760 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.446951 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.450005 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.495081 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.495081 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.496769 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.496929 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.498139 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.503548 [2] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
15:47:49.503679 [2] election timer started (282ms), term=2
15:47:49.503666 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:49.503685 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:49.544957 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.544957 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.546178 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:49.546260 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.548182 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:49.563005 [1] Submit received by LEADER: 7
15:47:49.563081 [1] ... log=[{5 1} {6 1} {7 1}]
15:47:49.594996 [1] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:49.595000 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:49.596457 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:49.596628 [0] ... inserting entries [Command:7 Term:1] from index 2
15:47:49.596704 [0] ... log is now: [{5 1} {6 1} {7 1}]
15:47:49.596764 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.599806 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:2], matchIndex := map[0:2 2:1]
15:47:49.599888 [1] leader sets commitIndex := 2
15:47:49.599923 [1] commitChanSender entries=[{7 1}], savedLastApplied=1
15:47:49.599966 [TEST] collectCommits(1) got {Command:7 Index:2 Term:1}
15:47:49.644996 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.644996 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:49.646202 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.646306 [0] ... setting commitIndex=2
15:47:49.646335 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.646417 [0] commitChanSender entries=[{7 1}], savedLastApplied=1
15:47:49.646486 [TEST] collectCommits(0) got {Command:7 Index:2 Term:1}
15:47:49.647338 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:2], matchIndex := map[0:2 2:1]
15:47:49.695028 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.695028 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:49.696647 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.696825 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.699291 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:2], matchIndex := map[0:2 2:1]
15:47:49.745015 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.745015 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:49.746218 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.746319 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.747236 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:2], matchIndex := map[0:2 2:1]
15:47:49.794064 [2] becomes Candidate (currentTerm=3); log=[{5 1} {6 1}]
15:47:49.794318 [2] election timer started (257ms), term=3
15:47:49.794312 [2] sending RequestVote to 0: Term:3 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:49.794312 [2] sending RequestVote to 1: Term:3 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:49.794961 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.794975 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:49.796331 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.796417 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.797341 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:2], matchIndex := map[0:2 2:1]
15:47:49.813990 [TEST] Reconnect 2
15:47:49.844961 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.844934 [1] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:49.846527 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:49.846730 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:49.847373 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:49.847507 [2] AppendEntries reply: Term:3 Success:%!d(bool=false)
15:47:49.849206 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:2], matchIndex := map[0:2 2:1]
15:47:49.850153 [1] term out of date in heartbeat reply
15:47:49.850185 [1] becomes Follower with term=3; log=[{5 1} {6 1} {7 1}]
15:47:49.850268 [1] election timer started (184ms), term=3
15:47:50.041107 [1] becomes Candidate (currentTerm=4); log=[{5 1} {6 1} {7 1}]
15:47:50.041342 [1] election timer started (176ms), term=4
15:47:50.041336 [1] sending RequestVote to 2: Term:4 CandidateId:1 LastLogIndex:2 LastLogTerm:1
15:47:50.041351 [1] sending RequestVote to 0: Term:4 CandidateId:1 LastLogIndex:2 LastLogTerm:1
15:47:50.042884 [2] RequestVote: Term:4 CandidateId:1 LastLogIndex:2 LastLogTerm:1 [currentTerm=3, votedFor=2, log index/term=(1, 1)]
15:47:50.042886 [0] RequestVote: Term:4 CandidateId:1 LastLogIndex:2 LastLogTerm:1 [currentTerm=1, votedFor=1, log index/term=(2, 1)]
15:47:50.043033 [2] ... term out of date in RequestVote
15:47:50.043081 [0] ... term out of date in RequestVote
15:47:50.043085 [2] becomes Follower with term=4; log=[{5 1} {6 1}]
15:47:50.043126 [0] becomes Follower with term=4; log=[{5 1} {6 1} {7 1}]
15:47:50.043187 [2] ... RequestVote reply: Term:4 Votegranted:%!d(bool=true)
15:47:50.043231 [0] ... RequestVote reply: Term:4 Votegranted:%!d(bool=true)
15:47:50.043305 [0] election timer started (191ms), term=4
15:47:50.043384 [2] election timer started (228ms), term=4
15:47:50.043535 [0] in election timer term changed from 1 to 4, bailing out
15:47:50.044678 [2] in election timer term changed from 3 to 4, bailing out
15:47:50.045537 [1] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:50 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:50.045670 [1] wins election with 2 votes
15:47:50.045700 [1] becomes Leader; term=4, nextIndex=map[0:3 2:3], matchIndex=map[0:-1 2:-1]; log=[{5 1} {6 1} {7 1}]
15:47:50.045798 [1] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:50 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:50.045899 [1] while waiting for reply, state = LEADER
15:47:50.045960 [1] sending AppendEntries to 2: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.045984 [1] sending AppendEntries to 0: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.046961 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.047081 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.047144 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.047865 [2] AppendEntries reply: Term:4 Success:%!d(bool=false)
15:47:50.050076 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:-1]
15:47:50.051106 [1] AppendEntries reply from 2 !success: nextIndex := 2
15:47:50.051590 [1] in election timer state=LEADER, bailing out
15:47:50.096138 [1] sending AppendEntries to 0: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.096138 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:50.097388 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.097408 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
15:47:50.097522 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.097551 [2] ... inserting entries [Command:7 Term:1] from index 2
15:47:50.097626 [2] ... log is now: [{5 1} {6 1} {7 1}]
15:47:50.097688 [2] ... setting commitIndex=2
15:47:50.097725 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.097776 [2] commitChanSender entries=[{7 1}], savedLastApplied=1
15:47:50.099335 [TEST] collectCommits(2) got {Command:7 Index:2 Term:4}
15:47:50.101137 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:2], matchIndex := map[0:2 2:-1]
15:47:50.101217 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.146115 [1] sending AppendEntries to 2: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.146115 [1] sending AppendEntries to 0: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.147672 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.147683 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.147820 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.147839 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.149658 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.149841 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.196113 [1] sending AppendEntries to 2: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.196113 [1] sending AppendEntries to 0: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.197713 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.197691 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.197869 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.197925 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.199033 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.199125 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.246087 [1] sending AppendEntries to 2: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.246087 [1] sending AppendEntries to 0: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.247151 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.247151 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.247253 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.247280 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.250073 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.250155 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.296215 [1] sending AppendEntries to 0: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.296215 [1] sending AppendEntries to 2: ni=3, args=Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.297009 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.297011 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
15:47:50.297082 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.297094 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
15:47:50.298335 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.298682 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]
15:47:50.314847 [0] becomes Dead
15:47:50.314895 Received quit signal. Shutting down...
15:47:50.314918 [0] commitChanSender done
15:47:50.314959 Listener close error: close tcp [::]:56803: use of closed network connection
15:47:50.314989 [0] CraftServer terminated!
15:47:50.315005 [1] becomes Dead
15:47:50.315023 [1] commitChanSender done
15:47:50.315043 Listener close error: close tcp [::]:56804: use of closed network connection
15:47:50.315032 Received quit signal. Shutting down...
15:47:50.315067 [1] CraftServer terminated!
15:47:50.315082 [2] becomes Dead
15:47:50.315102 [2] commitChanSender done
15:47:50.315105 Received quit signal. Shutting down...
15:47:50.315128 Listener close error: close tcp [::]:56805: use of closed network connection
15:47:50.315144 [2] CraftServer terminated!
15:47:50.324502 [2] in election timer state=DEAD, bailing out
15:47:50.324483 [0] in election timer state=DEAD, bailing out
--- PASS: TestCommitWithDisconnectionAndRecover (1.61s)
=== RUN   TestNoCommitWithNoQuorum
15:47:50.368031 [0] listening at [::]:56811
15:47:50.368401 [1] listening at [::]:56812
15:47:50.368725 [2] listening at [::]:56813
15:47:50.368987 [2] election timer started (269ms), term=0
15:47:50.369010 [1] election timer started (261ms), term=0
15:47:50.369000 [0] election timer started (242ms), term=0
15:47:50.620140 [0] becomes Candidate (currentTerm=1); log=[]
15:47:50.620316 [0] election timer started (268ms), term=1
15:47:50.620310 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:50.620319 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
15:47:50.622964 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:50.622960 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:50.623113 [2] ... term out of date in RequestVote
15:47:50.623136 [1] ... term out of date in RequestVote
15:47:50.623155 [2] becomes Follower with term=1; log=[]
15:47:50.623179 [1] becomes Follower with term=1; log=[]
15:47:50.623220 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:50.623241 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:50.623352 [1] election timer started (197ms), term=1
15:47:50.623350 [2] election timer started (263ms), term=1
15:47:50.626485 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:50 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:50.626603 [0] wins election with 2 votes
15:47:50.626634 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
15:47:50.626700 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:50 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:50.626789 [0] while waiting for reply, state = LEADER
15:47:50.626841 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:50.626865 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:50.627639 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:50.627764 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.627635 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:50.627815 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.629401 [1] in election timer term changed from 0 to 1, bailing out
15:47:50.629373 [2] in election timer term changed from 0 to 1, bailing out
15:47:50.630378 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:50.630438 [0] in election timer state=LEADER, bailing out
15:47:50.630471 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]
15:47:50.670899 [0] Submit received by LEADER: 5
15:47:50.670942 [0] ... log=[{5 1}]
15:47:50.670982 [0] Submit received by LEADER: 6
15:47:50.671011 [0] ... log=[{5 1} {6 1}]
15:47:50.677126 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:50.677121 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:50.678184 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:50.678193 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:50.678367 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:50.678394 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:50.678464 [2] ... log is now: [{5 1} {6 1}]
15:47:50.678491 [1] ... log is now: [{5 1} {6 1}]
15:47:50.678518 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.678552 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.680215 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:0], matchIndex := map[1:1 2:-1]
15:47:50.680278 [0] leader sets commitIndex := 1
15:47:50.680332 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.680319 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:50.680697 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
15:47:50.680832 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
15:47:50.727126 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.727126 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.728055 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.728053 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.728134 [2] ... setting commitIndex=1
15:47:50.728149 [1] ... setting commitIndex=1
15:47:50.728159 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.728177 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.728206 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:50.728246 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:50.728270 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
15:47:50.728325 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
15:47:50.728350 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
15:47:50.728389 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
15:47:50.730129 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.730488 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.777190 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.777190 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.778708 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.778712 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.778873 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.778912 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.779955 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.780033 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.827067 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.827067 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.828460 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.828463 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.828610 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.828633 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.831343 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.831455 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.877103 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.877103 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.878642 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.878642 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.878790 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.878830 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:50.881174 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.881254 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]
15:47:50.921857 [TEST] Disconnect 1
15:47:50.922337 [TEST] Disconnect 2
15:47:50.927189 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.927181 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.977086 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:50.977087 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.027072 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.027071 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.077130 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.077101 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.084887 [1] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
15:47:51.085073 [1] election timer started (163ms), term=2
15:47:51.085136 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.085065 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.127014 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.127014 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.145070 [2] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
15:47:51.145217 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:51.145308 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:51.145428 [2] election timer started (170ms), term=2
15:47:51.173528 [0] Submit received by LEADER: 8
15:47:51.173597 [0] ... log=[{5 1} {6 1} {8 1}]
15:47:51.176990 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.177017 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.226963 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.226964 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.256223 [1] becomes Candidate (currentTerm=3); log=[{5 1} {6 1}]
15:47:51.256327 [1] election timer started (211ms), term=3
15:47:51.256305 [1] sending RequestVote to 2: Term:3 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.256309 [1] sending RequestVote to 0: Term:3 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.276792 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.276811 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.316569 [2] becomes Candidate (currentTerm=3); log=[{5 1} {6 1}]
15:47:51.316650 [2] election timer started (152ms), term=3
15:47:51.316654 [2] sending RequestVote to 1: Term:3 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:51.316666 [2] sending RequestVote to 0: Term:3 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:51.326765 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.326783 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.377548 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.377538 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.424493 [TEST] Reconnect 1
15:47:51.424903 [TEST] Reconnect 2
15:47:51.426831 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.426816 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.429297 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.429298 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
15:47:51.429419 [1] AppendEntries reply: Term:3 Success:%!d(bool=false)
15:47:51.429443 [2] AppendEntries reply: Term:3 Success:%!d(bool=false)
15:47:51.432401 [0] term out of date in heartbeat reply
15:47:51.432437 [0] becomes Follower with term=3; log=[{5 1} {6 1} {8 1}]
15:47:51.432539 [0] election timer started (243ms), term=3
15:47:51.432627 [0] term out of date in heartbeat reply
15:47:51.432651 [0] becomes Follower with term=3; log=[{5 1} {6 1} {8 1}]
15:47:51.432757 [0] election timer started (250ms), term=3
15:47:51.476853 [1] becomes Candidate (currentTerm=4); log=[{5 1} {6 1}]
15:47:51.476864 [2] becomes Candidate (currentTerm=4); log=[{5 1} {6 1}]
15:47:51.477066 [1] election timer started (156ms), term=4
15:47:51.477086 [2] election timer started (257ms), term=4
15:47:51.477068 [1] sending RequestVote to 0: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.477172 [2] sending RequestVote to 0: Term:4 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:51.477191 [1] sending RequestVote to 2: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.477191 [2] sending RequestVote to 1: Term:4 CandidateId:2 LastLogIndex:1 LastLogTerm:1
15:47:51.479616 [1] RequestVote: Term:4 CandidateId:2 LastLogIndex:1 LastLogTerm:1 [currentTerm=4, votedFor=1, log index/term=(1, 1)]
15:47:51.479617 [0] RequestVote: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=3, votedFor=-1, log index/term=(2, 1)]
15:47:51.479619 [2] RequestVote: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=4, votedFor=2, log index/term=(1, 1)]
15:47:51.479709 [0] ... term out of date in RequestVote
15:47:51.479701 [1] ... RequestVote reply: Term:4 Votegranted:%!d(bool=false)
15:47:51.479729 [0] becomes Follower with term=4; log=[{5 1} {6 1} {8 1}]
15:47:51.479733 [2] ... RequestVote reply: Term:4 Votegranted:%!d(bool=false)
15:47:51.479810 [0] ... RequestVote reply: Term:4 Votegranted:%!d(bool=false)
15:47:51.479904 [0] RequestVote: Term:4 CandidateId:2 LastLogIndex:1 LastLogTerm:1 [currentTerm=4, votedFor=-1, log index/term=(2, 1)]
15:47:51.480086 [0] ... RequestVote reply: Term:4 Votegranted:%!d(bool=false)
15:47:51.480139 [0] election timer started (239ms), term=4
15:47:51.482619 [0] in election timer term changed from 3 to 4, bailing out
15:47:51.482873 [0] in election timer term changed from 3 to 4, bailing out
15:47:51.483636 [2] received RequestVoteReply &{Msg:Term:4 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:51 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:51.483815 [2] received RequestVoteReply &{Msg:Term:4 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:51 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:51.483826 [1] received RequestVoteReply &{Msg:Term:4 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:51 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:51.484016 [1] received RequestVoteReply &{Msg:Term:4 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:51 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:51.638091 [1] becomes Candidate (currentTerm=5); log=[{5 1} {6 1}]
15:47:51.638349 [1] election timer started (228ms), term=5
15:47:51.638350 [1] sending RequestVote to 2: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.638334 [1] sending RequestVote to 0: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1
15:47:51.639852 [0] RequestVote: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=4, votedFor=-1, log index/term=(2, 1)]
15:47:51.639853 [2] RequestVote: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=4, votedFor=2, log index/term=(1, 1)]
15:47:51.639987 [0] ... term out of date in RequestVote
15:47:51.640024 [2] ... term out of date in RequestVote
15:47:51.640032 [0] becomes Follower with term=5; log=[{5 1} {6 1} {8 1}]
15:47:51.640050 [2] becomes Follower with term=5; log=[{5 1} {6 1}]
15:47:51.640101 [2] ... RequestVote reply: Term:5 Votegranted:%!d(bool=true)
15:47:51.640097 [0] ... RequestVote reply: Term:5 Votegranted:%!d(bool=false)
15:47:51.640136 [2] election timer started (167ms), term=5
15:47:51.640253 [0] in election timer term changed from 4 to 5, bailing out
15:47:51.640293 [0] election timer started (236ms), term=5
15:47:51.641971 [1] received RequestVoteReply &{Msg:Term:5 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:51 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:51.642105 [1] received RequestVoteReply &{Msg:Term:5 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:51 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:51.642199 [1] wins election with 2 votes
15:47:51.642227 [1] becomes Leader; term=5, nextIndex=map[0:2 2:2], matchIndex=map[0:-1 2:-1]; log=[{5 1} {6 1}]
15:47:51.642326 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.642334 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.642889 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.642919 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.642962 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.642991 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.645675 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:-1 2:1]
15:47:51.645752 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.647228 [2] in election timer term changed from 4 to 5, bailing out
15:47:51.648670 [1] in election timer state=LEADER, bailing out
15:47:51.692560 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.692567 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.693880 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.693889 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.693990 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.694026 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.695920 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.696005 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.742672 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.742671 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.744214 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.744214 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.744382 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.744430 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.745424 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.746244 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.792580 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.792580 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.794147 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.794147 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.794314 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.794356 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.796948 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.797015 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.842560 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.842560 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.843734 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.843738 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.843868 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.843870 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.844961 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.845069 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.892589 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.892612 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.894155 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.894154 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.894316 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.894350 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.895565 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.895659 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.942593 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.942593 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.944119 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.944119 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.944281 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.944319 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.945756 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.945897 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.992555 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.992585 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.994117 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.994109 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:51.994279 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.994324 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:51.997730 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:51.997881 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]
15:47:52.025489 [1] Submit received by LEADER: 9
15:47:52.025595 [1] ... log=[{5 1} {6 1} {9 5}]
15:47:52.025643 [1] Submit received by LEADER: 10
15:47:52.025672 [1] ... log=[{5 1} {6 1} {9 5} {10 5}]
15:47:52.025716 [1] Submit received by LEADER: 11
15:47:52.025742 [1] ... log=[{5 1} {6 1} {9 5} {10 5} {11 5}]
15:47:52.042639 [1] sending AppendEntries to 2: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:5} Entries:{Command:10 Term:5} Entries:{Command:11 Term:5} LeaderCommit:1
15:47:52.042656 [1] sending AppendEntries to 0: ni=2, args=Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:5} Entries:{Command:10 Term:5} Entries:{Command:11 Term:5} LeaderCommit:1
15:47:52.043870 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:5} Entries:{Command:10 Term:5} Entries:{Command:11 Term:5} LeaderCommit:1
15:47:52.043870 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:5} Entries:{Command:10 Term:5} Entries:{Command:11 Term:5} LeaderCommit:1
15:47:52.044041 [2] ... inserting entries [Command:9 Term:5 Command:10 Term:5 Command:11 Term:5] from index 2
15:47:52.044057 [0] ... inserting entries [Command:9 Term:5 Command:10 Term:5 Command:11 Term:5] from index 2
15:47:52.044133 [2] ... log is now: [{5 1} {6 1} {9 5} {10 5} {11 5}]
15:47:52.044143 [0] ... log is now: [{5 1} {6 1} {9 5} {10 5} {11 5}]
15:47:52.044193 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.044214 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.045101 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:2], matchIndex := map[0:4 2:1]
15:47:52.045172 [1] leader sets commitIndex := 4
15:47:52.045219 [1] commitChanSender entries=[{9 5} {10 5} {11 5}], savedLastApplied=1
15:47:52.045286 [TEST] collectCommits(1) got {Command:9 Index:2 Term:5}
15:47:52.045326 [TEST] collectCommits(1) got {Command:10 Index:3 Term:5}
15:47:52.045360 [TEST] collectCommits(1) got {Command:11 Index:4 Term:5}
15:47:52.045585 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.092658 [1] sending AppendEntries to 0: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.092662 [1] sending AppendEntries to 2: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.094222 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.094224 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.094385 [2] ... setting commitIndex=4
15:47:52.094421 [0] ... setting commitIndex=4
15:47:52.094442 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.094477 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.094538 [2] commitChanSender entries=[{9 5} {10 5} {11 5}], savedLastApplied=1
15:47:52.094668 [TEST] collectCommits(2) got {Command:9 Index:2 Term:5}
15:47:52.094735 [TEST] collectCommits(2) got {Command:10 Index:3 Term:5}
15:47:52.094793 [TEST] collectCommits(2) got {Command:11 Index:4 Term:5}
15:47:52.094952 [0] commitChanSender entries=[{9 5} {10 5} {11 5}], savedLastApplied=1
15:47:52.095043 [TEST] collectCommits(0) got {Command:9 Index:2 Term:5}
15:47:52.095107 [TEST] collectCommits(0) got {Command:10 Index:3 Term:5}
15:47:52.095164 [TEST] collectCommits(0) got {Command:11 Index:4 Term:5}
15:47:52.095958 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.096525 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.142602 [1] sending AppendEntries to 0: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.142602 [1] sending AppendEntries to 2: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.144001 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.144002 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.144102 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.144130 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.145123 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.145216 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.192670 [1] sending AppendEntries to 2: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.192670 [1] sending AppendEntries to 0: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.194246 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.194272 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.194439 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.194489 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.195939 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.196542 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.242680 [1] sending AppendEntries to 0: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.242680 [1] sending AppendEntries to 2: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.244254 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.244272 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.244440 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.244478 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.245541 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.246426 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.292583 [1] sending AppendEntries to 2: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.292606 [1] sending AppendEntries to 0: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.294146 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.294145 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.294321 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.294364 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.295654 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.296336 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.342489 [1] sending AppendEntries to 0: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.342484 [1] sending AppendEntries to 2: ni=5, args=Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.342963 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.342970 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:4 PrevLogTerm:5 LeaderCommit:4
15:47:52.343005 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.343011 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
15:47:52.344002 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.344230 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]
15:47:52.376785 [0] becomes Dead
15:47:52.376842 [0] commitChanSender done
15:47:52.376854 Received quit signal. Shutting down...
15:47:52.376918 Listener close error: close tcp [::]:56811: use of closed network connection
15:47:52.376973 [0] CraftServer terminated!
15:47:52.377015 [1] becomes Dead
15:47:52.377063 Received quit signal. Shutting down...
15:47:52.377097 [1] commitChanSender done
15:47:52.377138 Listener close error: close tcp [::]:56812: use of closed network connection
15:47:52.377187 [1] CraftServer terminated!
15:47:52.377231 [2] becomes Dead
15:47:52.377279 Received quit signal. Shutting down...
15:47:52.377303 [2] commitChanSender done
15:47:52.377333 Listener close error: close tcp [::]:56813: use of closed network connection
15:47:52.377372 [2] CraftServer terminated!
15:47:52.380617 [0] in election timer state=DEAD, bailing out
15:47:52.380615 [2] in election timer state=DEAD, bailing out
--- PASS: TestNoCommitWithNoQuorum (2.06s)
=== RUN   TestCommitsWithLeaderDisconnects
15:47:52.431049 [0] listening at [::]:56822
15:47:52.431400 [1] listening at [::]:56823
15:47:52.431716 [2] listening at [::]:56824
15:47:52.432085 [3] listening at [::]:56825
15:47:52.432411 [4] listening at [::]:56826
15:47:52.432998 [4] election timer started (206ms), term=0
15:47:52.433000 [1] election timer started (176ms), term=0
15:47:52.432994 [0] election timer started (193ms), term=0
15:47:52.433048 [2] election timer started (176ms), term=0
15:47:52.433003 [3] election timer started (177ms), term=0
15:47:52.614120 [3] becomes Candidate (currentTerm=1); log=[]
15:47:52.614155 [2] becomes Candidate (currentTerm=1); log=[]
15:47:52.614257 [2] sending RequestVote to 3: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:52.614574 [1] becomes Candidate (currentTerm=1); log=[]
15:47:52.614802 [2] sending RequestVote to 4: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:52.614810 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:52.614736 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:52.615325 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
15:47:52.615868 [3] sending RequestVote to 4: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
15:47:52.616405 [2] election timer started (160ms), term=1
15:47:52.616604 [3] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=3, log index/term=(-1, -1)]
15:47:52.616744 [3] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.616875 [3] sending RequestVote to 2: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
15:47:52.614374 [3] sending RequestVote to 0: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
15:47:52.614617 [3] sending RequestVote to 1: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
15:47:52.618155 [3] election timer started (158ms), term=1
15:47:52.618196 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:52.618484 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:52.618534 [0] ... term out of date in RequestVote
15:47:52.618547 [0] becomes Follower with term=1; log=[]
15:47:52.618570 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:52.618406 [1] sending RequestVote to 3: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:52.619192 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:52.619261 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.619236 [0] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:52.619306 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.619980 [1] election timer started (200ms), term=1
15:47:52.620330 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=1, log index/term=(-1, -1)]
15:47:52.620392 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.620445 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:52.620680 [0] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.621548 [1] sending RequestVote to 4: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
15:47:52.623345 [0] in election timer term changed from 0 to 1, bailing out
15:47:52.623742 [2] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.623921 [0] election timer started (172ms), term=1
15:47:52.624081 [1] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.624619 [4] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
15:47:52.624694 [4] ... term out of date in RequestVote
15:47:52.624719 [4] becomes Follower with term=1; log=[]
15:47:52.624425 [2] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.625070 [2] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:52.625138 [2] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.625318 [4] ... RequestVote reply: Term:1 Votegranted:%!d(bool=true)
15:47:52.625429 [4] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:52.625513 [4] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.625564 [4] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
15:47:52.625628 [4] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.625542 [3] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.626564 [4] election timer started (186ms), term=1
15:47:52.626579 [3] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=3, log index/term=(-1, -1)]
15:47:52.626638 [3] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.626719 [1] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.627005 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.628020 [1] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=1, log index/term=(-1, -1)]
15:47:52.628163 [1] ... RequestVote reply: Term:1 Votegranted:%!d(bool=false)
15:47:52.628219 [1] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.628036 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.628526 [2] wins election with 3 votes
15:47:52.628551 [3] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.628538 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0 3:0 4:0], matchIndex=map[0:-1 1:-1 3:-1 4:-1]; log=[]
15:47:52.628617 [1] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.628673 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.628665 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.628706 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.628711 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.629139 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.629577 [3] becomes Follower with term=1; log=[]
15:47:52.629632 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.629770 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.629827 [1] becomes Follower with term=1; log=[]
15:47:52.629870 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.629789 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.629928 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.629866 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.630045 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.630069 [1] election timer started (286ms), term=1
15:47:52.630031 [3] election timer started (170ms), term=1
15:47:52.630040 [3] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.630136 [3] while waiting for reply, state = FOLLOWER
15:47:52.630182 [3] received RequestVoteReply &{Msg:Term:1 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:52 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:52.630246 [3] while waiting for reply, state = FOLLOWER
15:47:52.630671 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.631250 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.631284 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.631313 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.633320 [4] in election timer term changed from 0 to 1, bailing out
15:47:52.636793 [2] in election timer state=LEADER, bailing out
15:47:52.678836 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.678857 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.678829 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.678836 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.679707 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.679741 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.679794 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.679808 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.679751 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.679850 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.681565 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.681664 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.682428 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.683376 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.683448 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.683588 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.728904 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.728908 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.728889 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.728891 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.730470 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.730604 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.730806 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.730963 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.731295 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.731365 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.731592 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.731789 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
15:47:52.731896 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.732634 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.732763 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.733139 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]
15:47:52.734206 [2] Submit received by LEADER: 5
15:47:52.734240 [2] ... log=[{5 1}]
15:47:52.734284 [2] Submit received by LEADER: 6
15:47:52.734311 [2] ... log=[{5 1} {6 1}]
15:47:52.778877 [2] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.778875 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.778982 [2] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.778949 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.781340 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.781363 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.781498 [0] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:52.781340 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.781566 [0] ... log is now: [{5 1} {6 1}]
15:47:52.781611 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.781572 [3] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:52.781651 [3] ... log is now: [{5 1} {6 1}]
15:47:52.781707 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.781741 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
15:47:52.781869 [4] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:52.782114 [4] ... log is now: [{5 1} {6 1}]
15:47:52.782215 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.781494 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
15:47:52.782528 [1] ... log is now: [{5 1} {6 1}]
15:47:52.782565 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.783274 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:2 4:0], matchIndex := map[0:-1 1:-1 3:1 4:-1]
15:47:52.784117 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:0 3:2 4:0], matchIndex := map[0:1 1:-1 3:1 4:-1]
15:47:52.784208 [2] leader sets commitIndex := 1
15:47:52.784238 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:52.784302 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
15:47:52.784345 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
15:47:52.784413 [2] AppendEntries reply from 4 success: nextIndex := map[0:2 1:0 3:2 4:2], matchIndex := map[0:1 1:-1 3:1 4:1]
15:47:52.785543 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.828857 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.828857 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.828857 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.828870 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.830020 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.830006 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.830081 [4] ... setting commitIndex=1
15:47:52.830091 [3] ... setting commitIndex=1
15:47:52.830105 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.830115 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.830008 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.830005 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.830158 [1] ... setting commitIndex=1
15:47:52.830174 [0] ... setting commitIndex=1
15:47:52.830177 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.830193 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.830319 [3] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:52.830933 [TEST] collectCommits(3) got {Command:5 Index:0 Term:1}
15:47:52.831002 [TEST] collectCommits(3) got {Command:6 Index:1 Term:1}
15:47:52.831047 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:52.831108 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
15:47:52.831152 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
15:47:52.831189 [4] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:52.831245 [TEST] collectCommits(4) got {Command:5 Index:0 Term:1}
15:47:52.831287 [TEST] collectCommits(4) got {Command:6 Index:1 Term:1}
15:47:52.831638 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
15:47:52.831694 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
15:47:52.831744 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
15:47:52.831975 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.832239 [2] AppendEntries reply from 3 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.832523 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.832891 [2] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.878900 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.878927 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.878900 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.878900 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.880695 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.880864 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.880804 [4] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.881158 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.880698 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.881328 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.881295 [3] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:52.881483 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
15:47:52.884014 [2] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.884151 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.884367 [TEST] Disconnect 2
15:47:52.884380 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.885174 [2] AppendEntries reply from 3 success: nextIndex := map[0:2 1:2 3:2 4:2], matchIndex := map[0:1 1:1 3:1 4:1]
15:47:52.895641 [2] Submit received by LEADER: 7
15:47:52.895714 [2] ... log=[{5 1} {6 1} {7 1}]
15:47:52.928843 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:52.928843 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:52.928864 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:52.928872 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:52.978924 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:52.978849 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:52.978839 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:52.978832 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.028779 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.028759 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.028759 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.028863 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.048439 [3] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
15:47:53.048527 [3] election timer started (203ms), term=2
15:47:53.048513 [3] sending RequestVote to 4: Term:2 CandidateId:3 LastLogIndex:1 LastLogTerm:1
15:47:53.048535 [3] sending RequestVote to 2: Term:2 CandidateId:3 LastLogIndex:1 LastLogTerm:1
15:47:53.048513 [3] sending RequestVote to 0: Term:2 CandidateId:3 LastLogIndex:1 LastLogTerm:1
15:47:53.048615 [3] sending RequestVote to 1: Term:2 CandidateId:3 LastLogIndex:1 LastLogTerm:1
15:47:53.049018 [1] RequestVote: Term:2 CandidateId:3 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=-1, log index/term=(1, 1)]
15:47:53.049025 [4] RequestVote: Term:2 CandidateId:3 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=2, log index/term=(1, 1)]
15:47:53.049055 [1] ... term out of date in RequestVote
15:47:53.049064 [4] ... term out of date in RequestVote
15:47:53.049052 [0] RequestVote: Term:2 CandidateId:3 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=2, log index/term=(1, 1)]
15:47:53.049076 [4] becomes Follower with term=2; log=[{5 1} {6 1}]
15:47:53.049067 [1] becomes Follower with term=2; log=[{5 1} {6 1}]
15:47:53.049103 [4] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:53.049088 [0] ... term out of date in RequestVote
15:47:53.049116 [1] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:53.049162 [0] becomes Follower with term=2; log=[{5 1} {6 1}]
15:47:53.049188 [0] ... RequestVote reply: Term:2 Votegranted:%!d(bool=true)
15:47:53.049215 [0] election timer started (247ms), term=2
15:47:53.049196 [1] election timer started (208ms), term=2
15:47:53.049137 [4] election timer started (200ms), term=2
15:47:53.049806 [3] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:53 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:53.049867 [3] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:53 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:53.049906 [3] wins election with 3 votes
15:47:53.049920 [3] becomes Leader; term=2, nextIndex=map[0:2 1:2 2:2 4:2], matchIndex=map[0:-1 1:-1 2:-1 4:-1]; log=[{5 1} {6 1}]
15:47:53.049965 [3] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 10:17:53 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
15:47:53.050007 [3] while waiting for reply, state = LEADER
15:47:53.050059 [1] in election timer term changed from 1 to 2, bailing out
15:47:53.050035 [3] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.050035 [3] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.050037 [3] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.050062 [3] sending AppendEntries to 4: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.050110 [1] in election timer term changed from 1 to 2, bailing out
15:47:53.050137 [3] in election timer state=LEADER, bailing out
15:47:53.050326 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.050363 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.050347 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.050356 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.050380 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.050389 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.051839 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:-1 1:1 2:-1 4:-1]
15:47:53.051895 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:-1 1:1 2:-1 4:1]
15:47:53.051998 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:-1 4:1]
15:47:53.054292 [0] in election timer term changed from 1 to 2, bailing out
15:47:53.056992 [4] in election timer term changed from 1 to 2, bailing out
15:47:53.058845 [3] in election timer state=LEADER, bailing out
15:47:53.079707 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.079714 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.079701 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.079827 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.100331 [3] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.100357 [3] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.100338 [3] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.100551 [3] sending AppendEntries to 4: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.100835 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.100835 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.100901 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.100916 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.100958 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.100884 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.101689 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:-1 4:1]
15:47:53.101933 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:-1 4:1]
15:47:53.102082 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:-1 4:1]
15:47:53.129782 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.129787 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.129803 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.129832 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.150315 [3] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.150325 [3] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.150346 [3] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.150370 [3] sending AppendEntries to 4: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.150857 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.150867 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.150875 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
15:47:53.150926 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.150931 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.150939 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.151845 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:-1 4:1]
15:47:53.153191 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:-1 4:1]
15:47:53.153274 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:-1 4:1]
15:47:53.179811 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.179791 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.179830 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.179920 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.196902 [3] Submit received by LEADER: 8
15:47:53.196972 [3] ... log=[{5 1} {6 1} {8 2}]
15:47:53.200106 [3] sending AppendEntries to 4: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
15:47:53.200155 [3] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
15:47:53.200100 [3] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
15:47:53.200126 [3] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
15:47:53.200957 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
15:47:53.200999 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
15:47:53.201061 [4] ... inserting entries [Command:8 Term:2] from index 2
15:47:53.201086 [0] ... inserting entries [Command:8 Term:2] from index 2
15:47:53.201110 [4] ... log is now: [{5 1} {6 1} {8 2}]
15:47:53.201146 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.201129 [0] ... log is now: [{5 1} {6 1} {8 2}]
15:47:53.200958 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
15:47:53.201194 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.201202 [1] ... inserting entries [Command:8 Term:2] from index 2
15:47:53.201251 [1] ... log is now: [{5 1} {6 1} {8 2}]
15:47:53.201295 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.203470 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:2 2:2 4:2], matchIndex := map[0:2 1:1 2:-1 4:1]
15:47:53.204213 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:2 4:2], matchIndex := map[0:2 1:2 2:-1 4:1]
15:47:53.204634 [3] leader sets commitIndex := 2
15:47:53.204690 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.204763 [3] commitChanSender entries=[{8 2}], savedLastApplied=1
15:47:53.204801 [TEST] collectCommits(3) got {Command:8 Index:2 Term:2}
15:47:53.230000 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.229962 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.230032 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.229956 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.250194 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.250199 [3] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
15:47:53.250322 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.250194 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.251174 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.251256 [4] ... setting commitIndex=2
15:47:53.251238 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.251287 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.251309 [0] ... setting commitIndex=2
15:47:53.251343 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.251411 [4] commitChanSender entries=[{8 2}], savedLastApplied=1
15:47:53.251464 [TEST] collectCommits(4) got {Command:8 Index:2 Term:2}
15:47:53.251600 [0] commitChanSender entries=[{8 2}], savedLastApplied=1
15:47:53.251658 [TEST] collectCommits(0) got {Command:8 Index:2 Term:2}
15:47:53.251173 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.251745 [1] ... setting commitIndex=2
15:47:53.251784 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.252086 [1] commitChanSender entries=[{8 2}], savedLastApplied=1
15:47:53.252127 [TEST] collectCommits(1) got {Command:8 Index:2 Term:2}
15:47:53.253617 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.253711 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.253784 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.279832 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.279951 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.279835 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.280144 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.300466 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.300581 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.300463 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.301998 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.302148 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.302101 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.302229 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.300463 [3] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
15:47:53.305798 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.305896 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.306375 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.306701 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.307283 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.329939 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.329842 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.329967 [2] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.329841 [2] sending AppendEntries to 3: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
15:47:53.347980 [TEST] Reconnect 2
15:47:53.350131 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.350131 [3] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
15:47:53.350315 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.350164 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.351162 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.351244 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.351240 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.351319 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.351512 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.351586 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.353498 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
15:47:53.353935 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.354015 [2] ... term out of date in AppendEntries
15:47:53.354156 [2] becomes Follower with term=2; log=[{5 1} {6 1} {7 1}]
15:47:53.354190 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.354240 [2] ... inserting entries [Command:8 Term:2] from index 2
15:47:53.354277 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:2 4:3], matchIndex := map[0:2 1:2 2:-1 4:2]
15:47:53.354317 [2] ... log is now: [{5 1} {6 1} {8 2}]
15:47:53.354892 [2] ... setting commitIndex=2
15:47:53.354920 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.354977 [2] commitChanSender entries=[{8 2}], savedLastApplied=1
15:47:53.355028 [TEST] collectCommits(2) got {Command:8 Index:2 Term:2}
15:47:53.355084 [2] election timer started (176ms), term=2
15:47:53.356633 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.400130 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.400130 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.400299 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.400143 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.401547 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.401673 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.401784 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.401867 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.401963 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.402014 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.401709 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.402098 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.403769 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.403857 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.403927 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.404211 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.450147 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.450128 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.450278 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.450128 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.451329 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.451410 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.451439 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.451510 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.452352 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.452450 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.451292 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.452622 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.454690 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.455242 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.455336 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.455654 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.500156 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.500178 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.500416 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.500156 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.502076 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.502087 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.502219 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.502282 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.502827 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.502957 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.503153 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.503283 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.505603 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.506236 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.506322 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.506444 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.550185 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.550452 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.550188 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.550179 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.552032 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.552082 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.552096 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.552210 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.552234 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.552178 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.552730 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.552822 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.555004 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.555125 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.555808 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.556138 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.600240 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.600338 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.600225 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.600225 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.601906 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.602063 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.601963 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.602185 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.602578 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.602656 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.603214 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.603303 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.604207 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.604289 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.604405 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.604489 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.650141 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.650157 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.650296 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.650158 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.651271 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.651275 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.651424 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.651519 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.651654 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.651375 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.654213 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.654318 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.654265 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.654366 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.655402 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.656504 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.700204 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.700167 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.700141 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.700140 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.701653 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.701697 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.701800 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.701820 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.701653 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.702033 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.702192 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.702389 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.702978 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.703165 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.703266 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.703477 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.750126 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.750156 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.750127 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.750208 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.751677 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.751822 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.751670 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.751680 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.751987 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.751698 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.752096 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.751930 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.753062 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.753158 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.753545 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.753650 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.800158 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.800235 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.800172 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.800145 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.801614 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.801781 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.801718 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.801859 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.801643 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.801914 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.801614 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.802027 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.802792 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.803237 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.805025 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.805116 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.850268 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.850269 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.850419 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.850279 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.851948 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.852112 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.851948 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.852221 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.852183 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.852691 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.853156 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.853308 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.854815 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.854916 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.854995 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.855074 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.900221 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.900167 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.900325 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.900189 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.901664 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.901809 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.901670 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.901662 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.901952 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.901980 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.902264 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
15:47:53.902410 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.905144 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.905472 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.905567 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.906381 [3] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 4:3], matchIndex := map[0:2 1:2 2:2 4:2]
15:47:53.948869 [3] Submit received by LEADER: 9
15:47:53.948960 [3] ... log=[{5 1} {6 1} {8 2} {9 2}]
15:47:53.950143 [3] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.950155 [3] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.950317 [3] sending AppendEntries to 4: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.951219 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.951335 [2] ... inserting entries [Command:9 Term:2] from index 3
15:47:53.951285 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.951395 [2] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
15:47:53.951405 [1] ... inserting entries [Command:9 Term:2] from index 3
15:47:53.951447 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.951453 [1] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
15:47:53.951499 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.951398 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.951925 [4] ... inserting entries [Command:9 Term:2] from index 3
15:47:53.951990 [4] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
15:47:53.952033 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.950132 [3] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.953537 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
15:47:53.953605 [3] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:4 4:3], matchIndex := map[0:2 1:2 2:3 4:2]
15:47:53.953651 [0] ... inserting entries [Command:9 Term:2] from index 3
15:47:53.953712 [0] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
15:47:53.953707 [3] AppendEntries reply from 1 success: nextIndex := map[0:3 1:4 2:4 4:3], matchIndex := map[0:2 1:3 2:3 4:2]
15:47:53.953759 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:53.953776 [3] leader sets commitIndex := 3
15:47:53.953807 [3] commitChanSender entries=[{9 2}], savedLastApplied=2
15:47:53.953844 [TEST] collectCommits(3) got {Command:9 Index:3 Term:2}
15:47:53.954075 [3] AppendEntries reply from 4 success: nextIndex := map[0:3 1:4 2:4 4:4], matchIndex := map[0:2 1:3 2:3 4:3]
15:47:53.954591 [3] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.000155 [3] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.000155 [3] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.000328 [3] sending AppendEntries to 4: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.000178 [3] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.001387 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.001489 [4] ... setting commitIndex=3
15:47:54.001517 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.001538 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.001697 [0] ... setting commitIndex=3
15:47:54.001725 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.001669 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.001760 [1] ... setting commitIndex=3
15:47:54.001787 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.002222 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.002304 [2] ... setting commitIndex=3
15:47:54.002325 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.002404 [1] commitChanSender entries=[{9 2}], savedLastApplied=2
15:47:54.003723 [TEST] collectCommits(1) got {Command:9 Index:3 Term:2}
15:47:54.003949 [3] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.003651 [0] commitChanSender entries=[{9 2}], savedLastApplied=2
15:47:54.004087 [TEST] collectCommits(0) got {Command:9 Index:3 Term:2}
15:47:54.004102 [2] commitChanSender entries=[{9 2}], savedLastApplied=2
15:47:54.004144 [4] commitChanSender entries=[{9 2}], savedLastApplied=2
15:47:54.004368 [TEST] collectCommits(4) got {Command:9 Index:3 Term:2}
15:47:54.004407 [TEST] collectCommits(2) got {Command:9 Index:3 Term:2}
15:47:54.005937 [3] AppendEntries reply from 2 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.006185 [3] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.006270 [3] AppendEntries reply from 4 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.050115 [3] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.050218 [3] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.050116 [3] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.050135 [3] sending AppendEntries to 4: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.051339 [2] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.051463 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.051423 [1] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.051522 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.051505 [0] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.051710 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.052533 [4] AppendEntries: Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.052645 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
15:47:54.052776 [3] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.052863 [3] AppendEntries reply from 2 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.053417 [3] AppendEntries reply from 4 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.053749 [3] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 4:4], matchIndex := map[0:3 1:3 2:3 4:3]
15:47:54.100188 [3] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.100224 [3] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.100122 [3] sending AppendEntries to 4: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.100378 [3] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:3 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
15:47:54.100999 [0] becomes Dead
15:47:54.101053 [0] commitChanSender done
15:47:54.101084 Received quit signal. Shutting down...
15:47:54.101245 Listener close error: close tcp [::]:56822: use of closed network connection
15:47:54.101345 [0] CraftServer terminated!
15:47:54.101406 [1] becomes Dead
15:47:54.101478 [1] commitChanSender done
15:47:54.101486 Received quit signal. Shutting down...
15:47:54.101593 Listener close error: close tcp [::]:56823: use of closed network connection
15:47:54.101687 [1] CraftServer terminated!
15:47:54.101778 [2] becomes Dead
15:47:54.101862 Received quit signal. Shutting down...
15:47:54.101859 [2] commitChanSender done
15:47:54.102003 Listener close error: close tcp [::]:56824: use of closed network connection
15:47:54.102114 [2] CraftServer terminated!
15:47:54.102168 [3] becomes Dead
15:47:54.102251 Received quit signal. Shutting down...
15:47:54.102280 [3] commitChanSender done
15:47:54.102318 Listener close error: close tcp [::]:56825: use of closed network connection
15:47:54.102384 [3] CraftServer terminated!
15:47:54.102448 [4] becomes Dead
15:47:54.102509 Received quit signal. Shutting down...
15:47:54.102521 [4] commitChanSender done
15:47:54.102572 Listener close error: close tcp [::]:56826: use of closed network connection
15:47:54.102607 [4] CraftServer terminated!
15:47:54.105702 [2] in election timer state=DEAD, bailing out
15:47:54.109297 [0] in election timer state=DEAD, bailing out
15:47:54.109318 [4] in election timer state=DEAD, bailing out
15:47:54.109342 [1] in election timer state=DEAD, bailing out
--- PASS: TestCommitsWithLeaderDisconnects (1.73s)
PASS
ok  	github.com/codeharik/craft	16.690s
