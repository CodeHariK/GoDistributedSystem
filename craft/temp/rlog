=== RUN   TestElectionBasic
23:12:53.689603 [0] listening at [::]:54248
23:12:53.689967 [1] listening at [::]:54249
23:12:53.690353 [2] listening at [::]:54250
23:12:53.690629 [1] election timer started (199ms), term=0
23:12:53.690644 [0] election timer started (251ms), term=0
23:12:53.690634 [2] election timer started (204ms), term=0
23:12:53.891722 [1] becomes Candidate (currentTerm=1); log=[]
23:12:53.891966 [1] election timer started (199ms), term=1
23:12:53.891875 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:53.891859 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:53.895743 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:53.895829 [0] ... term out of date in RequestVote
23:12:53.895760 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:53.895874 [2] ... term out of date in RequestVote
23:12:53.895851 [0] becomes Follower with term=1; log=[]
23:12:53.895893 [2] becomes Follower with term=1; log=[]
23:12:53.896430 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:12:53.896446 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:12:53.896633 [0] election timer started (169ms), term=1
23:12:53.896621 [2] election timer started (212ms), term=1
23:12:53.899608 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:53 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:53.899719 [1] wins election with 2 votes
23:12:53.899747 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:12:53.899809 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:53 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:53.899880 [1] while waiting for reply, state = LEADER
23:12:53.899948 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.899957 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.900798 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.900815 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.900961 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:53.900981 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:53.901010 [0] in election timer term changed from 0 to 1, bailing out
23:12:53.901009 [2] in election timer term changed from 0 to 1, bailing out
23:12:53.902259 [1] in election timer state=LEADER, bailing out
23:12:53.902814 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:53.902876 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:53.950315 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.950313 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.951020 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.951020 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:53.951257 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:53.951262 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:53.952768 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:53.953171 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:53.992677 [0] CM.Stop called
23:12:53.992718 [0] becomes Dead
23:12:53.992759 [0] commitChanSender done
23:12:53.992821 Received quit signal. Shutting down...
23:12:53.992992 Listener close error: close tcp [::]:54248: use of closed network connection
23:12:53.993054 [0] CraftServer terminated!
23:12:53.993097 [1] CM.Stop called
23:12:53.993122 [1] becomes Dead
23:12:53.993149 [1] commitChanSender done
23:12:53.993244 Received quit signal. Shutting down...
23:12:53.993289 Listener close error: close tcp [::]:54249: use of closed network connection
23:12:53.993342 [1] CraftServer terminated!
23:12:53.993385 [2] CM.Stop called
23:12:53.993448 [2] becomes Dead
23:12:53.993528 [2] commitChanSender done
23:12:53.993622 Received quit signal. Shutting down...
23:12:53.993644 Listener close error: close tcp [::]:54250: use of closed network connection
23:12:53.993714 [2] CraftServer terminated!
--- PASS: TestElectionBasic (0.31s)
=== RUN   TestElectionLeaderDisconnect
23:12:53.994482 [0] listening at [::]:54253
23:12:53.994872 [1] listening at [::]:54254
23:12:53.995169 [2] listening at [::]:54255
23:12:53.995396 [1] election timer started (155ms), term=0
23:12:53.995399 [0] election timer started (277ms), term=0
23:12:53.995425 [2] election timer started (233ms), term=0
23:12:53.997280 [0] in election timer state=DEAD, bailing out
23:12:53.997326 [2] in election timer state=DEAD, bailing out
23:12:54.156603 [1] becomes Candidate (currentTerm=1); log=[]
23:12:54.156810 [1] election timer started (256ms), term=1
23:12:54.156782 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:54.156778 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:54.159239 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:54.159329 [0] ... term out of date in RequestVote
23:12:54.159242 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:54.159355 [0] becomes Follower with term=1; log=[]
23:12:54.159364 [2] ... term out of date in RequestVote
23:12:54.159404 [2] becomes Follower with term=1; log=[]
23:12:54.159592 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:12:54.159592 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:12:54.159704 [0] election timer started (264ms), term=1
23:12:54.159708 [2] election timer started (186ms), term=1
23:12:54.161392 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:54 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:54.161528 [1] wins election with 2 votes
23:12:54.161558 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:12:54.161624 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:54 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:54.161708 [1] while waiting for reply, state = LEADER
23:12:54.161786 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.161799 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.162695 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.162908 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.162961 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.163912 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.166248 [2] in election timer term changed from 0 to 1, bailing out
23:12:54.166311 [0] in election timer term changed from 0 to 1, bailing out
23:12:54.166601 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:54.167374 [1] in election timer state=LEADER, bailing out
23:12:54.167970 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:54.212020 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.212011 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.213275 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.213275 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.213614 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.213654 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.216968 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:54.217149 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:54.262273 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.262279 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.263597 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.263615 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.263852 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.263852 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.266129 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:54.266572 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:54.297284 [TEST] Disconnect 1
23:12:54.312481 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.312497 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.362718 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.362721 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.413034 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.413034 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.450894 [2] becomes Candidate (currentTerm=2); log=[]
23:12:54.451096 [2] election timer started (217ms), term=2
23:12:54.451086 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:54.451073 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:54.452953 [0] RequestVote: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=1, log index/term=(-1, -1)]
23:12:54.453048 [0] ... term out of date in RequestVote
23:12:54.453064 [0] becomes Follower with term=2; log=[]
23:12:54.453288 [0] ... RequestVote reply: Term:2 VoteGranted:true
23:12:54.453376 [0] election timer started (228ms), term=2
23:12:54.454967 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:54 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:54.455076 [2] wins election with 2 votes
23:12:54.455094 [2] becomes Leader; term=2, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:12:54.455191 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.455184 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.455756 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.455950 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:54.458251 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:54.460030 [0] in election timer term changed from 1 to 2, bailing out
23:12:54.461331 [2] in election timer state=LEADER, bailing out
23:12:54.463227 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.463244 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.505388 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.505408 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.506450 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.506750 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:54.507712 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:54.513549 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.513540 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.555554 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.555554 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.556791 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.557133 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:54.558115 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:54.564248 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.564238 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.605725 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.605724 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.606851 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.607165 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:54.609134 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:54.614347 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.614345 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.648586 [0] CM.Stop called
23:12:54.648652 [0] becomes Dead
23:12:54.648698 [0] commitChanSender done
23:12:54.648776 Received quit signal. Shutting down...
23:12:54.648907 Listener close error: close tcp [::]:54253: use of closed network connection
23:12:54.648980 [0] CraftServer terminated!
23:12:54.649031 [1] CM.Stop called
23:12:54.649063 [1] becomes Dead
23:12:54.649107 [1] commitChanSender done
23:12:54.649163 Received quit signal. Shutting down...
23:12:54.649276 Listener close error: close tcp [::]:54254: use of closed network connection
23:12:54.649335 [1] CraftServer terminated!
23:12:54.649390 [2] CM.Stop called
23:12:54.649423 [2] becomes Dead
23:12:54.649471 [2] commitChanSender done
23:12:54.649542 Received quit signal. Shutting down...
23:12:54.649620 Listener close error: close tcp [::]:54255: use of closed network connection
23:12:54.649672 [2] CraftServer terminated!
--- PASS: TestElectionLeaderDisconnect (0.66s)
=== RUN   TestElectionLeaderAndAnotherDisconnect
23:12:54.650795 [0] listening at [::]:54259
23:12:54.651370 [1] listening at [::]:54260
23:12:54.651833 [2] listening at [::]:54261
23:12:54.652177 [2] election timer started (271ms), term=0
23:12:54.652186 [1] election timer started (242ms), term=0
23:12:54.652210 [0] election timer started (167ms), term=0
23:12:54.654086 [0] in election timer state=DEAD, bailing out
23:12:54.823343 [0] becomes Candidate (currentTerm=1); log=[]
23:12:54.823546 [0] election timer started (261ms), term=1
23:12:54.823560 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:54.823540 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:54.825769 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:54.825769 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:54.825852 [1] ... term out of date in RequestVote
23:12:54.825865 [2] ... term out of date in RequestVote
23:12:54.825872 [1] becomes Follower with term=1; log=[]
23:12:54.825888 [2] becomes Follower with term=1; log=[]
23:12:54.826103 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:12:54.826102 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:12:54.826192 [2] election timer started (153ms), term=1
23:12:54.826280 [1] election timer started (192ms), term=1
23:12:54.828709 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:54 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:54.828843 [0] wins election with 2 votes
23:12:54.828869 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:12:54.828952 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:54 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:54.829059 [0] while waiting for reply, state = LEADER
23:12:54.829104 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.829134 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.830044 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.830047 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.830314 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.830314 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.831968 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:54.832043 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:54.832320 [2] in election timer term changed from 0 to 1, bailing out
23:12:54.832494 [1] in election timer term changed from 0 to 1, bailing out
23:12:54.834693 [0] in election timer state=LEADER, bailing out
23:12:54.879159 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.879159 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.880399 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.880399 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.880753 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.880751 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.884847 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:54.884938 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:54.929444 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.929450 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.930549 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.930552 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.930869 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.930864 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:54.932849 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:54.932928 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:54.954097 [TEST] Disconnect 0
23:12:54.954516 [TEST] Disconnect 1
23:12:54.979759 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:54.979759 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.030122 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.030129 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.080483 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.080496 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.086892 [2] becomes Candidate (currentTerm=2); log=[]
23:12:55.087057 [2] election timer started (250ms), term=2
23:12:55.087005 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:55.087027 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:55.127489 [1] becomes Candidate (currentTerm=2); log=[]
23:12:55.127650 [1] election timer started (248ms), term=2
23:12:55.127639 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.127668 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.130642 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.130633 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.180989 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.181017 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.231409 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.231417 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.281829 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.281856 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.332321 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.332355 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.337628 [2] becomes Candidate (currentTerm=3); log=[]
23:12:55.337823 [2] election timer started (264ms), term=3
23:12:55.337755 [2] sending RequestVote to 0: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:55.337764 [2] sending RequestVote to 1: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:55.378820 [1] becomes Candidate (currentTerm=3); log=[]
23:12:55.378907 [1] election timer started (193ms), term=3
23:12:55.378959 [1] sending RequestVote to 0: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.379042 [1] sending RequestVote to 2: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.382812 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.382812 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.405409 [TEST] Reconnect 1
23:12:55.433064 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.433081 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.434364 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.434614 [1] AppendEntries reply: Term:3 Success:%!d(bool=false)
23:12:55.436649 [0] term out of date in heartbeat reply
23:12:55.436682 [0] becomes Follower with term=3; log=[]
23:12:55.436737 [0] election timer started (202ms), term=3
23:12:55.579201 [1] becomes Candidate (currentTerm=4); log=[]
23:12:55.579492 [1] election timer started (228ms), term=4
23:12:55.579445 [1] sending RequestVote to 0: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.579476 [1] sending RequestVote to 2: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.582043 [0] RequestVote: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=3, votedFor=-1, log index/term=(-1, -1)]
23:12:55.582042 [2] RequestVote: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=3, votedFor=2, log index/term=(-1, -1)]
23:12:55.582203 [0] ... term out of date in RequestVote
23:12:55.582231 [2] ... term out of date in RequestVote
23:12:55.582244 [0] becomes Follower with term=4; log=[]
23:12:55.582267 [2] becomes Follower with term=4; log=[]
23:12:55.582603 [0] ... RequestVote reply: Term:4 VoteGranted:true
23:12:55.582612 [2] ... RequestVote reply: Term:4 VoteGranted:true
23:12:55.582749 [0] election timer started (252ms), term=4
23:12:55.582782 [2] election timer started (157ms), term=4
23:12:55.585155 [1] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:55 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:55.585273 [1] wins election with 2 votes
23:12:55.585297 [1] becomes Leader; term=4, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:12:55.585360 [1] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:55 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:55.585436 [1] while waiting for reply, state = LEADER
23:12:55.585487 [1] sending AppendEntries to 2: ni=0, args=Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.585492 [1] sending AppendEntries to 0: ni=0, args=Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.586300 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.586314 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.586508 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:12:55.586524 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:12:55.587045 [0] in election timer term changed from 3 to 4, bailing out
23:12:55.588193 [2] in election timer term changed from 3 to 4, bailing out
23:12:55.589026 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:55.589091 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:55.589734 [1] in election timer state=LEADER, bailing out
23:12:55.635807 [1] sending AppendEntries to 2: ni=0, args=Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.635816 [1] sending AppendEntries to 0: ni=0, args=Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.636933 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.636932 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.637232 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:12:55.637227 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:12:55.639107 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:55.639191 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:55.686109 [1] sending AppendEntries to 2: ni=0, args=Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.686109 [1] sending AppendEntries to 0: ni=0, args=Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.687710 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.687710 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:55.688126 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:12:55.688133 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:12:55.690678 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:55.690771 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:55.707491 [0] CM.Stop called
23:12:55.707547 [0] becomes Dead
23:12:55.707596 [0] commitChanSender done
23:12:55.707676 Received quit signal. Shutting down...
23:12:55.707800 Listener close error: close tcp [::]:54259: use of closed network connection
23:12:55.707873 [0] CraftServer terminated!
23:12:55.707942 [1] CM.Stop called
23:12:55.707983 [1] becomes Dead
23:12:55.708080 [1] commitChanSender done
23:12:55.708176 Received quit signal. Shutting down...
23:12:55.708306 Listener close error: close tcp [::]:54260: use of closed network connection
23:12:55.708385 [1] CraftServer terminated!
23:12:55.708450 [2] CM.Stop called
23:12:55.708487 [2] becomes Dead
23:12:55.708539 [2] commitChanSender done
23:12:55.708615 Received quit signal. Shutting down...
23:12:55.708704 Listener close error: close tcp [::]:54261: use of closed network connection
23:12:55.708772 [2] CraftServer terminated!
--- PASS: TestElectionLeaderAndAnotherDisconnect (1.06s)
=== RUN   TestDisconnectAllThenRestore
23:12:55.710058 [0] listening at [::]:54267
23:12:55.710637 [1] listening at [::]:54268
23:12:55.710986 [2] listening at [::]:54269
23:12:55.711288 [1] election timer started (249ms), term=0
23:12:55.711297 [0] election timer started (249ms), term=0
23:12:55.711287 [2] election timer started (187ms), term=0
23:12:55.713568 [0] in election timer state=DEAD, bailing out
23:12:55.713594 [2] in election timer state=DEAD, bailing out
23:12:55.812290 [TEST] Disconnect 0
23:12:55.812699 [TEST] Disconnect 1
23:12:55.812840 [TEST] Disconnect 2
23:12:55.902435 [2] becomes Candidate (currentTerm=1); log=[]
23:12:55.902626 [2] election timer started (167ms), term=1
23:12:55.902616 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:55.902631 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:55.962454 [1] becomes Candidate (currentTerm=1); log=[]
23:12:55.962438 [0] becomes Candidate (currentTerm=1); log=[]
23:12:55.962689 [1] election timer started (219ms), term=1
23:12:55.962627 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.962769 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.962867 [0] election timer started (165ms), term=1
23:12:55.962820 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:55.962613 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:56.073847 [2] becomes Candidate (currentTerm=2); log=[]
23:12:56.074017 [2] election timer started (233ms), term=2
23:12:56.073993 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.073992 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.133055 [0] becomes Candidate (currentTerm=2); log=[]
23:12:56.133184 [0] election timer started (224ms), term=2
23:12:56.133205 [0] sending RequestVote to 2: Term:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.133182 [0] sending RequestVote to 1: Term:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.183913 [1] becomes Candidate (currentTerm=2); log=[]
23:12:56.184102 [1] election timer started (179ms), term=2
23:12:56.184096 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:56.184117 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:56.263989 [TEST] Reconnect 0
23:12:56.264399 [TEST] Reconnect 1
23:12:56.264558 [TEST] Reconnect 2
23:12:56.314482 [2] becomes Candidate (currentTerm=3); log=[]
23:12:56.314701 [2] election timer started (239ms), term=3
23:12:56.314698 [2] sending RequestVote to 0: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.314710 [2] sending RequestVote to 1: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.316951 [0] RequestVote: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=0, log index/term=(-1, -1)]
23:12:56.317051 [0] ... term out of date in RequestVote
23:12:56.316953 [1] RequestVote: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=1, log index/term=(-1, -1)]
23:12:56.317075 [0] becomes Follower with term=3; log=[]
23:12:56.317094 [1] ... term out of date in RequestVote
23:12:56.317118 [1] becomes Follower with term=3; log=[]
23:12:56.317294 [1] ... RequestVote reply: Term:3 VoteGranted:true
23:12:56.317294 [0] ... RequestVote reply: Term:3 VoteGranted:true
23:12:56.317404 [0] election timer started (227ms), term=3
23:12:56.317380 [1] election timer started (196ms), term=3
23:12:56.319029 [2] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:56 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:56.319147 [2] wins election with 2 votes
23:12:56.319177 [2] becomes Leader; term=3, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:12:56.319259 [2] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:56 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:56.319362 [2] while waiting for reply, state = LEADER
23:12:56.319410 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.319432 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.320195 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.320326 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.320401 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:12:56.320521 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:12:56.323025 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.323108 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.323456 [0] in election timer term changed from 2 to 3, bailing out
23:12:56.324703 [1] in election timer term changed from 2 to 3, bailing out
23:12:56.325273 [2] in election timer state=LEADER, bailing out
23:12:56.369490 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.369490 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.370595 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.370597 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.370876 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:12:56.370874 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:12:56.373058 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.373389 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.416024 [0] CM.Stop called
23:12:56.416102 [0] becomes Dead
23:12:56.416130 [0] commitChanSender done
23:12:56.416183 Received quit signal. Shutting down...
23:12:56.416294 Listener close error: close tcp [::]:54267: use of closed network connection
23:12:56.416360 [0] CraftServer terminated!
23:12:56.416393 [1] CM.Stop called
23:12:56.416419 [1] becomes Dead
23:12:56.416445 [1] commitChanSender done
23:12:56.416493 Received quit signal. Shutting down...
23:12:56.416561 Listener close error: close tcp [::]:54268: use of closed network connection
23:12:56.416596 [1] CraftServer terminated!
23:12:56.416632 [2] CM.Stop called
23:12:56.416653 [2] becomes Dead
23:12:56.416678 [2] commitChanSender done
23:12:56.416718 Received quit signal. Shutting down...
23:12:56.416787 Listener close error: close tcp [::]:54269: use of closed network connection
23:12:56.416824 [2] CraftServer terminated!
--- PASS: TestDisconnectAllThenRestore (0.71s)
=== RUN   TestElectionLeaderDisconnectThenReconnect
23:12:56.417695 [1] in election timer state=DEAD, bailing out
23:12:56.417713 [0] in election timer state=DEAD, bailing out
23:12:56.417843 [0] listening at [::]:54272
23:12:56.418269 [1] listening at [::]:54273
23:12:56.418631 [2] listening at [::]:54274
23:12:56.418929 [1] election timer started (181ms), term=0
23:12:56.418936 [0] election timer started (227ms), term=0
23:12:56.418938 [2] election timer started (162ms), term=0
23:12:56.590119 [2] becomes Candidate (currentTerm=1); log=[]
23:12:56.590378 [2] election timer started (232ms), term=1
23:12:56.590325 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.590343 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:56.592626 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:56.592724 [1] ... term out of date in RequestVote
23:12:56.592632 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:56.592749 [1] becomes Follower with term=1; log=[]
23:12:56.592774 [0] ... term out of date in RequestVote
23:12:56.592798 [0] becomes Follower with term=1; log=[]
23:12:56.593002 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:12:56.593003 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:12:56.593110 [0] election timer started (272ms), term=1
23:12:56.593194 [1] election timer started (249ms), term=1
23:12:56.594803 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:56 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:56.594953 [2] wins election with 2 votes
23:12:56.594983 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:12:56.595061 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:56 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:56.595160 [2] while waiting for reply, state = LEADER
23:12:56.595223 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.595227 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.595829 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.595854 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.596107 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:56.596134 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:56.598669 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.598735 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.599106 [1] in election timer term changed from 0 to 1, bailing out
23:12:56.599129 [0] in election timer term changed from 0 to 1, bailing out
23:12:56.600706 [2] in election timer state=LEADER, bailing out
23:12:56.645479 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.645484 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.646583 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.646586 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.646895 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:56.646894 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:56.647872 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.648431 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.695686 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.695683 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.696828 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.696823 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.697151 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:56.697151 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:56.699996 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.700082 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:12:56.720868 [TEST] Disconnect 2
23:12:56.745889 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.745885 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.796170 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.796183 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.846495 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.846495 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.896602 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.896602 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.946966 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.946966 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.954022 [1] becomes Candidate (currentTerm=2); log=[]
23:12:56.954208 [1] election timer started (286ms), term=2
23:12:56.954158 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:56.954153 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:56.957213 [0] RequestVote: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=2, log index/term=(-1, -1)]
23:12:56.957304 [0] ... term out of date in RequestVote
23:12:56.957332 [0] becomes Follower with term=2; log=[]
23:12:56.957574 [0] ... RequestVote reply: Term:2 VoteGranted:true
23:12:56.957688 [0] election timer started (290ms), term=2
23:12:56.959531 [1] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:56 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:56.959658 [1] wins election with 2 votes
23:12:56.959685 [1] becomes Leader; term=2, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:12:56.959777 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.959775 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.960555 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.960818 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:56.962386 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:56.963330 [0] in election timer term changed from 1 to 2, bailing out
23:12:56.964487 [1] in election timer state=LEADER, bailing out
23:12:56.997935 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:56.997950 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.009944 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.009960 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.010438 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.010571 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.011018 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.048854 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.048857 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.060183 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.060173 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.060710 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.060857 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.061307 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.071753 [TEST] Reconnect 2
23:12:57.098860 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.098867 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.099829 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.099829 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.099980 [0] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:12:57.099990 [1] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:12:57.100504 [2] term out of date in heartbeat reply
23:12:57.100522 [2] becomes Follower with term=2; log=[]
23:12:57.100561 [2] election timer started (232ms), term=2
23:12:57.110398 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.110412 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.110896 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.111043 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.111154 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.111299 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.112046 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.112267 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.160704 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.160699 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.161267 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.161429 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.161416 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.161574 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.162987 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.163414 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.210964 [1] sending AppendEntries to 2: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.210975 [1] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.211692 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.211693 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.211888 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.211888 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.212557 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.212624 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:57.222308 [0] CM.Stop called
23:12:57.222339 [0] becomes Dead
23:12:57.222390 [0] commitChanSender done
23:12:57.222428 Received quit signal. Shutting down...
23:12:57.222485 Listener close error: close tcp [::]:54272: use of closed network connection
23:12:57.222520 [0] CraftServer terminated!
23:12:57.222545 [1] CM.Stop called
23:12:57.222569 [1] becomes Dead
23:12:57.222601 [1] commitChanSender done
23:12:57.222637 Received quit signal. Shutting down...
23:12:57.222679 Listener close error: close tcp [::]:54273: use of closed network connection
23:12:57.222717 [1] CraftServer terminated!
23:12:57.222744 [2] CM.Stop called
23:12:57.222764 [2] becomes Dead
23:12:57.222789 [2] commitChanSender done
23:12:57.222818 Received quit signal. Shutting down...
23:12:57.222872 Listener close error: close tcp [::]:54274: use of closed network connection
23:12:57.222901 [2] CraftServer terminated!
--- PASS: TestElectionLeaderDisconnectThenReconnect (0.81s)
=== RUN   TestElectionLeaderDisconnectThenReconnect5
23:12:57.223807 [0] listening at [::]:54281
23:12:57.224121 [1] listening at [::]:54282
23:12:57.224390 [2] listening at [::]:54283
23:12:57.224654 [3] listening at [::]:54284
23:12:57.224930 [4] listening at [::]:54285
23:12:57.225397 [3] election timer started (228ms), term=0
23:12:57.225412 [1] election timer started (222ms), term=0
23:12:57.225407 [0] election timer started (282ms), term=0
23:12:57.225428 [4] election timer started (170ms), term=0
23:12:57.225455 [2] election timer started (261ms), term=0
23:12:57.228132 [0] in election timer state=DEAD, bailing out
23:12:57.230972 [2] in election timer state=DEAD, bailing out
23:12:57.396629 [4] becomes Candidate (currentTerm=1); log=[]
23:12:57.396883 [4] election timer started (220ms), term=1
23:12:57.396885 [4] sending RequestVote to 3: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1
23:12:57.396857 [4] sending RequestVote to 1: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1
23:12:57.397009 [4] sending RequestVote to 0: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1
23:12:57.396855 [4] sending RequestVote to 2: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1
23:12:57.399449 [2] RequestVote: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:57.399451 [3] RequestVote: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:57.399593 [2] ... term out of date in RequestVote
23:12:57.399611 [3] ... term out of date in RequestVote
23:12:57.399630 [2] becomes Follower with term=1; log=[]
23:12:57.399646 [3] becomes Follower with term=1; log=[]
23:12:57.399590 [1] RequestVote: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:57.399730 [1] ... term out of date in RequestVote
23:12:57.399769 [1] becomes Follower with term=1; log=[]
23:12:57.399717 [0] RequestVote: Term:1 CandidateId:4 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:57.399851 [0] ... term out of date in RequestVote
23:12:57.399893 [0] becomes Follower with term=1; log=[]
23:12:57.400010 [3] ... RequestVote reply: Term:1 VoteGranted:true
23:12:57.400046 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:12:57.400207 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:12:57.400285 [0] election timer started (267ms), term=1
23:12:57.400370 [3] election timer started (181ms), term=1
23:12:57.400471 [1] election timer started (206ms), term=1
23:12:57.400009 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:12:57.400794 [2] election timer started (173ms), term=1
23:12:57.404037 [4] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:57 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:57.404328 [4] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:57 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:57.404413 [4] wins election with 3 votes
23:12:57.404439 [4] becomes Leader; term=1, nextIndex=map[0:0 1:0 2:0 3:0], matchIndex=map[0:-1 1:-1 2:-1 3:-1]; log=[]
23:12:57.404540 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.404569 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.404691 [4] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:57 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:57.404765 [4] while waiting for reply, state = LEADER
23:12:57.404796 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.405087 [4] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:57 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:57.405103 [3] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.405183 [0] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.405320 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.405348 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.405347 [1] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.405596 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.405164 [4] while waiting for reply, state = LEADER
23:12:57.405797 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.406517 [2] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.406718 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.407292 [3] in election timer term changed from 0 to 1, bailing out
23:12:57.407272 [0] in election timer term changed from 0 to 1, bailing out
23:12:57.407359 [2] in election timer term changed from 0 to 1, bailing out
23:12:57.407685 [1] in election timer term changed from 0 to 1, bailing out
23:12:57.407895 [4] in election timer state=LEADER, bailing out
23:12:57.408016 [4] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.408173 [4] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.408262 [4] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.408368 [4] AppendEntries reply from 2 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.455052 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.455052 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.455052 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.455065 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.456089 [3] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.456089 [2] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.456090 [1] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.456089 [0] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.456347 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.456359 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.456401 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.456455 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.459505 [4] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.459586 [4] AppendEntries reply from 2 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.459651 [4] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.460142 [4] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.505629 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.505639 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.505630 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.505632 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.506669 [2] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.506665 [0] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.506664 [3] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.506677 [1] AppendEntries: Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.506958 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.506958 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.506969 [3] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.507029 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:57.508702 [4] AppendEntries reply from 2 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.508799 [4] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.508874 [4] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.508953 [4] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 2:0 3:0], matchIndex := map[0:-1 1:-1 2:-1 3:-1]; commitIndex := -1
23:12:57.527225 [TEST] Disconnect 4
23:12:57.556344 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.556542 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.557167 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.557187 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.606574 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.606586 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.606561 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.606769 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.657005 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.657088 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.657005 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.657005 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.680994 [2] becomes Candidate (currentTerm=2); log=[]
23:12:57.681131 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:57.681312 [2] election timer started (183ms), term=2
23:12:57.681379 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:57.681216 [2] sending RequestVote to 3: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:57.681122 [2] sending RequestVote to 4: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:57.683584 [0] RequestVote: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=4, log index/term=(-1, -1)]
23:12:57.683692 [0] ... term out of date in RequestVote
23:12:57.683721 [0] becomes Follower with term=2; log=[]
23:12:57.683730 [3] RequestVote: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=4, log index/term=(-1, -1)]
23:12:57.683820 [3] ... term out of date in RequestVote
23:12:57.683836 [3] becomes Follower with term=2; log=[]
23:12:57.684069 [1] RequestVote: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=4, log index/term=(-1, -1)]
23:12:57.684140 [1] ... term out of date in RequestVote
23:12:57.684103 [0] ... RequestVote reply: Term:2 VoteGranted:true
23:12:57.684158 [1] becomes Follower with term=2; log=[]
23:12:57.684186 [0] election timer started (296ms), term=2
23:12:57.684137 [3] ... RequestVote reply: Term:2 VoteGranted:true
23:12:57.684800 [3] election timer started (168ms), term=2
23:12:57.684856 [1] ... RequestVote reply: Term:2 VoteGranted:true
23:12:57.685032 [1] election timer started (233ms), term=2
23:12:57.686271 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:57 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:57.686359 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:57 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:57.686426 [2] wins election with 3 votes
23:12:57.686496 [2] becomes Leader; term=2, nextIndex=map[0:0 1:0 3:0 4:0], matchIndex=map[0:-1 1:-1 3:-1 4:-1]; log=[]
23:12:57.686661 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:57 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:57.686872 [2] while waiting for reply, state = LEADER
23:12:57.686925 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.686959 [2] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.687009 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.687052 [2] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.687806 [3] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.687817 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.687804 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.688080 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.688095 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.688085 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.690500 [0] in election timer term changed from 1 to 2, bailing out
23:12:57.690503 [3] in election timer term changed from 1 to 2, bailing out
23:12:57.690611 [1] in election timer term changed from 1 to 2, bailing out
23:12:57.690663 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.690866 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.690979 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.691529 [2] in election timer state=LEADER, bailing out
23:12:57.707223 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.707229 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.707253 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.707291 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.736893 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.736923 [2] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.736892 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.736947 [2] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.737563 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.737566 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.737609 [3] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.737801 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.737803 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.737832 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.739249 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.739341 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.739413 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.757543 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.757543 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.757600 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.757564 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787016 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787034 [2] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787021 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787016 [2] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787730 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787732 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787730 [3] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.787993 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.788008 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.788026 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.790628 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.790717 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.790779 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.807919 [4] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.807887 [4] sending AppendEntries to 3: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.807957 [4] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.807887 [4] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:4 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.829148 [TEST] Reconnect 4
23:12:57.837299 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.837305 [2] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.837317 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.837299 [2] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.838076 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.838076 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.838294 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.838342 [3] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.838424 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.838540 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.838536 [4] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.838717 [4] ... term out of date in AppendEntries
23:12:57.838742 [4] becomes Follower with term=2; log=[]
23:12:57.838926 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.839757 [4] election timer started (205ms), term=2
23:12:57.841386 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.841470 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.841559 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.841902 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.887593 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.887629 [2] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.887593 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.887666 [2] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.888443 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.888435 [3] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.888464 [4] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.888661 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.888662 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.888665 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.888436 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.888891 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.889685 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.890197 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.890303 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.890399 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.937929 [2] sending AppendEntries to 3: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.937943 [2] sending AppendEntries to 4: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.937930 [2] sending AppendEntries to 0: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.937933 [2] sending AppendEntries to 1: ni=0, args=Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.938812 [4] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.938815 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.938891 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.939067 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.939067 [4] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.939135 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.938814 [3] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:57.939855 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:12:57.941042 [2] AppendEntries reply from 3 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.941388 [2] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.942189 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.942527 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 3:0 4:0], matchIndex := map[0:-1 1:-1 3:-1 4:-1]; commitIndex := -1
23:12:57.981393 [0] CM.Stop called
23:12:57.981440 [0] becomes Dead
23:12:57.981472 [0] commitChanSender done
23:12:57.981508 Received quit signal. Shutting down...
23:12:57.981633 Listener close error: close tcp [::]:54281: use of closed network connection
23:12:57.981685 [0] CraftServer terminated!
23:12:57.981720 [1] CM.Stop called
23:12:57.981738 [1] becomes Dead
23:12:57.981776 [1] commitChanSender done
23:12:57.981816 Received quit signal. Shutting down...
23:12:57.981893 Listener close error: close tcp [::]:54282: use of closed network connection
23:12:57.981931 [1] CraftServer terminated!
23:12:57.981963 [2] CM.Stop called
23:12:57.981989 [2] becomes Dead
23:12:57.982014 [2] commitChanSender done
23:12:57.982061 Received quit signal. Shutting down...
23:12:57.982128 Listener close error: close tcp [::]:54283: use of closed network connection
23:12:57.982178 [2] CraftServer terminated!
23:12:57.982212 [3] CM.Stop called
23:12:57.982237 [3] becomes Dead
23:12:57.982270 [3] commitChanSender done
23:12:57.982313 Received quit signal. Shutting down...
23:12:57.982396 Listener close error: close tcp [::]:54284: use of closed network connection
23:12:57.982437 [3] CraftServer terminated!
23:12:57.982469 [4] CM.Stop called
23:12:57.982488 [4] becomes Dead
23:12:57.982521 [4] commitChanSender done
23:12:57.982555 Received quit signal. Shutting down...
23:12:57.982645 Listener close error: close tcp [::]:54285: use of closed network connection
23:12:57.982687 [4] CraftServer terminated!
23:12:57.984784 [0] in election timer state=DEAD, bailing out
23:12:57.984849 [3] in election timer state=DEAD, bailing out
23:12:57.985213 [1] in election timer state=DEAD, bailing out
23:12:57.990001 [4] in election timer state=DEAD, bailing out
--- PASS: TestElectionLeaderDisconnectThenReconnect5 (0.81s)
=== RUN   TestElectionFollowerComesBack
23:12:58.037821 [0] listening at [::]:54294
23:12:58.038371 [1] listening at [::]:54295
23:12:58.038766 [2] listening at [::]:54296
23:12:58.039058 [1] election timer started (275ms), term=0
23:12:58.039076 [0] election timer started (200ms), term=0
23:12:58.039057 [2] election timer started (227ms), term=0
23:12:58.240217 [0] becomes Candidate (currentTerm=1); log=[]
23:12:58.240297 [0] election timer started (223ms), term=1
23:12:58.240295 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.240306 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.241356 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:58.241361 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:58.241417 [1] ... term out of date in RequestVote
23:12:58.241461 [1] becomes Follower with term=1; log=[]
23:12:58.241435 [2] ... term out of date in RequestVote
23:12:58.241496 [2] becomes Follower with term=1; log=[]
23:12:58.241602 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:12:58.241627 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:12:58.241667 [1] election timer started (200ms), term=1
23:12:58.241700 [2] election timer started (227ms), term=1
23:12:58.242721 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:58 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:58.242801 [0] wins election with 2 votes
23:12:58.242823 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:12:58.242879 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:58 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:58.242958 [0] while waiting for reply, state = LEADER
23:12:58.242988 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.243000 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.243434 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.243439 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.243584 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.243604 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.244651 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.244699 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.249751 [1] in election timer term changed from 0 to 1, bailing out
23:12:58.249780 [2] in election timer term changed from 0 to 1, bailing out
23:12:58.250474 [0] in election timer state=LEADER, bailing out
23:12:58.292972 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.292983 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.293565 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.293576 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.293768 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.293769 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.295923 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.296076 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.341195 [TEST] Disconnect 1
23:12:58.343276 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.343266 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.344138 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.344364 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.345762 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.393365 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.393385 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.394351 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.394780 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.396367 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.443498 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.443498 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.444570 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.444845 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.447985 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.493745 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.493751 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.495319 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.495794 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.496995 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.502411 [1] becomes Candidate (currentTerm=2); log=[]
23:12:58.502501 [1] election timer started (252ms), term=2
23:12:58.502490 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.502526 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.543873 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.543873 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.545214 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.545529 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.546488 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.594055 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.594055 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.595533 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.596076 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.597324 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.644295 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.644290 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.645371 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.645659 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.646465 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.694520 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.694517 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.696033 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.696511 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.698379 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.744788 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.744814 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.746241 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.746701 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.748792 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.762886 [1] becomes Candidate (currentTerm=3); log=[]
23:12:58.763031 [1] election timer started (178ms), term=3
23:12:58.763021 [1] sending RequestVote to 2: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.763061 [1] sending RequestVote to 0: Term:3 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.795008 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.795033 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.796477 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.796968 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.800407 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.845297 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.845287 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.846650 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.847121 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.848610 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.895571 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.895571 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.896605 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.896925 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.897882 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.943176 [1] becomes Candidate (currentTerm=4); log=[]
23:12:58.943317 [1] sending RequestVote to 2: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.943366 [1] sending RequestVote to 0: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:58.943408 [1] election timer started (266ms), term=4
23:12:58.945935 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.945931 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.947110 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.947465 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.948568 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:58.992484 [TEST] Reconnect 1
23:12:58.996304 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.996291 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.997740 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.998192 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:58.998756 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:58.999236 [1] AppendEntries reply: Term:4 Success:%!d(bool=false)
23:12:58.999958 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:59.001236 [0] term out of date in heartbeat reply
23:12:59.001269 [0] becomes Follower with term=4; log=[]
23:12:59.001326 [0] election timer started (245ms), term=4
23:12:59.213744 [1] becomes Candidate (currentTerm=5); log=[]
23:12:59.213916 [1] election timer started (230ms), term=5
23:12:59.213941 [1] sending RequestVote to 0: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:59.213918 [1] sending RequestVote to 2: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:59.216126 [0] RequestVote: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=4, votedFor=-1, log index/term=(-1, -1)]
23:12:59.216220 [0] ... term out of date in RequestVote
23:12:59.216125 [2] RequestVote: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=1, votedFor=0, log index/term=(-1, -1)]
23:12:59.216243 [0] becomes Follower with term=5; log=[]
23:12:59.216249 [2] ... term out of date in RequestVote
23:12:59.216271 [2] becomes Follower with term=5; log=[]
23:12:59.216460 [2] ... RequestVote reply: Term:5 VoteGranted:true
23:12:59.216460 [0] ... RequestVote reply: Term:5 VoteGranted:true
23:12:59.216571 [2] election timer started (293ms), term=5
23:12:59.216636 [0] election timer started (171ms), term=5
23:12:59.219496 [1] received RequestVoteReply &{Msg:Term:5 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:59 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:59.219633 [1] wins election with 2 votes
23:12:59.219752 [1] becomes Leader; term=5, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:12:59.219867 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.220235 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.220708 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.220865 [1] received RequestVoteReply &{Msg:Term:5 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:59 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:59.220933 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:12:59.220960 [1] while waiting for reply, state = LEADER
23:12:59.221348 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.221612 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:12:59.221690 [0] in election timer term changed from 4 to 5, bailing out
23:12:59.221815 [2] in election timer term changed from 1 to 5, bailing out
23:12:59.222337 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:59.223260 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:59.224130 [1] in election timer state=LEADER, bailing out
23:12:59.270377 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.270366 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.271385 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.271371 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.271675 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:12:59.271676 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:12:59.275062 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:59.275157 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:12:59.294358 [0] CM.Stop called
23:12:59.294402 [0] becomes Dead
23:12:59.294433 [0] commitChanSender done
23:12:59.294496 Received quit signal. Shutting down...
23:12:59.294583 Listener close error: close tcp [::]:54294: use of closed network connection
23:12:59.294632 [0] CraftServer terminated!
23:12:59.294660 [1] CM.Stop called
23:12:59.294677 [1] becomes Dead
23:12:59.294704 [1] commitChanSender done
23:12:59.294739 Received quit signal. Shutting down...
23:12:59.294807 Listener close error: close tcp [::]:54295: use of closed network connection
23:12:59.294850 [1] CraftServer terminated!
23:12:59.294886 [2] CM.Stop called
23:12:59.294913 [2] becomes Dead
23:12:59.294943 [2] commitChanSender done
23:12:59.294992 Received quit signal. Shutting down...
23:12:59.295047 Listener close error: close tcp [::]:54296: use of closed network connection
23:12:59.295083 [2] CraftServer terminated!
23:12:59.297026 [0] in election timer state=DEAD, bailing out
23:12:59.297047 [2] in election timer state=DEAD, bailing out
--- PASS: TestElectionFollowerComesBack (1.31s)
=== RUN   TestElectionDisconnectLoop
23:12:59.350483 [0] listening at [::]:54303
23:12:59.350988 [1] listening at [::]:54304
23:12:59.351449 [2] listening at [::]:54305
23:12:59.351732 [2] election timer started (283ms), term=0
23:12:59.351734 [1] election timer started (263ms), term=0
23:12:59.351769 [0] election timer started (184ms), term=0
23:12:59.542894 [0] becomes Candidate (currentTerm=1); log=[]
23:12:59.543115 [0] election timer started (246ms), term=1
23:12:59.543086 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:59.543071 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:12:59.545497 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:59.545501 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:12:59.545652 [1] ... term out of date in RequestVote
23:12:59.545700 [2] ... term out of date in RequestVote
23:12:59.545730 [1] becomes Follower with term=1; log=[]
23:12:59.545739 [2] becomes Follower with term=1; log=[]
23:12:59.546107 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:12:59.546095 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:12:59.546264 [1] election timer started (254ms), term=1
23:12:59.546339 [2] election timer started (267ms), term=1
23:12:59.548643 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:59 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:59.548751 [0] wins election with 2 votes
23:12:59.548776 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:12:59.548841 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:42:59 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:12:59.548928 [0] while waiting for reply, state = LEADER
23:12:59.549001 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.549007 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.549560 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.549560 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.549749 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:59.550017 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:59.551833 [2] in election timer term changed from 0 to 1, bailing out
23:12:59.551889 [1] in election timer term changed from 0 to 1, bailing out
23:12:59.552046 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:59.553064 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:59.553283 [0] in election timer state=LEADER, bailing out
23:12:59.599387 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.599405 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.600198 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.600456 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:59.600438 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.600692 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:59.601936 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:59.602222 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:59.649699 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.649708 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.650585 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.650586 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.650884 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:59.650884 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:12:59.652944 [TEST] Disconnect 0
23:12:59.653551 [TEST] Disconnect 1
23:12:59.654230 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:59.654296 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:12:59.700114 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.700123 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.750556 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.750567 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.800563 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.800570 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.851019 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.851020 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.901667 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.901774 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.907337 [1] becomes Candidate (currentTerm=2); log=[]
23:12:59.907501 [1] election timer started (221ms), term=2
23:12:59.907490 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:59.907512 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:12:59.927526 [2] becomes Candidate (currentTerm=2); log=[]
23:12:59.927675 [2] election timer started (153ms), term=2
23:12:59.927645 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:59.927653 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:12:59.952051 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.952051 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:12:59.964367 [TEST] Reconnect 1
23:12:59.964789 [TEST] Reconnect 0
23:13:00.002580 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.003095 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.005455 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.005502 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.005681 [1] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:13:00.005682 [2] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:13:00.006524 [0] term out of date in heartbeat reply
23:13:00.006555 [0] becomes Follower with term=2; log=[]
23:13:00.006607 [0] election timer started (208ms), term=2
23:13:00.087826 [2] becomes Candidate (currentTerm=3); log=[]
23:13:00.088023 [2] election timer started (288ms), term=3
23:13:00.088014 [2] sending RequestVote to 0: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:00.088028 [2] sending RequestVote to 1: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:00.090246 [1] RequestVote: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=1, log index/term=(-1, -1)]
23:13:00.090334 [1] ... term out of date in RequestVote
23:13:00.090247 [0] RequestVote: Term:3 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=2, votedFor=-1, log index/term=(-1, -1)]
23:13:00.090354 [1] becomes Follower with term=3; log=[]
23:13:00.090382 [0] ... term out of date in RequestVote
23:13:00.090404 [0] becomes Follower with term=3; log=[]
23:13:00.090634 [1] ... RequestVote reply: Term:3 VoteGranted:true
23:13:00.090910 [1] election timer started (168ms), term=3
23:13:00.090633 [0] ... RequestVote reply: Term:3 VoteGranted:true
23:13:00.091986 [0] election timer started (258ms), term=3
23:13:00.094435 [2] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:00 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:00.094564 [2] wins election with 2 votes
23:13:00.094591 [2] becomes Leader; term=3, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:00.094669 [2] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:00 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:00.094786 [2] while waiting for reply, state = LEADER
23:13:00.094828 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.094851 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.095501 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.095525 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.095723 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:00.095727 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:00.096888 [0] in election timer term changed from 2 to 3, bailing out
23:13:00.097244 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:00.097392 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:00.097676 [1] in election timer term changed from 2 to 3, bailing out
23:13:00.098224 [2] in election timer state=LEADER, bailing out
23:13:00.115317 [TEST] Disconnect 2
23:13:00.115685 [TEST] Disconnect 0
23:13:00.145075 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.145105 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.195501 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.195487 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.245932 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.245946 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.271745 [1] becomes Candidate (currentTerm=4); log=[]
23:13:00.271976 [1] election timer started (174ms), term=4
23:13:00.271908 [1] sending RequestVote to 0: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:00.272069 [1] sending RequestVote to 2: Term:4 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:00.296323 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.296314 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.346761 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.346763 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.363232 [0] becomes Candidate (currentTerm=4); log=[]
23:13:00.363375 [0] election timer started (191ms), term=4
23:13:00.363407 [0] sending RequestVote to 1: Term:4 LastLogIndex:-1 LastLogTerm:-1
23:13:00.363368 [0] sending RequestVote to 2: Term:4 LastLogIndex:-1 LastLogTerm:-1
23:13:00.397228 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.397242 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.426178 [TEST] Reconnect 0
23:13:00.426380 [TEST] Reconnect 2
23:13:00.447739 [2] sending AppendEntries to 1: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.447739 [2] sending AppendEntries to 0: ni=0, args=Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.449726 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.449729 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.450594 [1] AppendEntries reply: Term:4 Success:%!d(bool=false)
23:13:00.450616 [0] AppendEntries reply: Term:4 Success:%!d(bool=false)
23:13:00.452236 [2] term out of date in heartbeat reply
23:13:00.452265 [2] becomes Follower with term=4; log=[]
23:13:00.452439 [1] becomes Candidate (currentTerm=5); log=[]
23:13:00.452304 [2] election timer started (266ms), term=4
23:13:00.452594 [1] election timer started (284ms), term=5
23:13:00.452487 [1] sending RequestVote to 2: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:00.452520 [1] sending RequestVote to 0: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:00.454666 [0] RequestVote: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=4, votedFor=0, log index/term=(-1, -1)]
23:13:00.454750 [0] ... term out of date in RequestVote
23:13:00.454773 [0] becomes Follower with term=5; log=[]
23:13:00.454666 [2] RequestVote: Term:5 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=4, votedFor=-1, log index/term=(-1, -1)]
23:13:00.454842 [2] ... term out of date in RequestVote
23:13:00.454890 [2] becomes Follower with term=5; log=[]
23:13:00.454934 [0] ... RequestVote reply: Term:5 VoteGranted:true
23:13:00.455044 [0] election timer started (179ms), term=5
23:13:00.455122 [2] ... RequestVote reply: Term:5 VoteGranted:true
23:13:00.455207 [2] election timer started (151ms), term=5
23:13:00.456707 [1] received RequestVoteReply &{Msg:Term:5 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:00 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:00.456847 [1] wins election with 2 votes
23:13:00.456871 [1] becomes Leader; term=5, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:13:00.456977 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.456992 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.458177 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.458271 [1] received RequestVoteReply &{Msg:Term:5 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:00 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:00.458365 [1] while waiting for reply, state = LEADER
23:13:00.458376 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:13:00.458676 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.458861 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:13:00.459894 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:00.460984 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:00.462915 [1] in election timer state=LEADER, bailing out
23:13:00.462941 [2] in election timer term changed from 4 to 5, bailing out
23:13:00.463528 [0] in election timer term changed from 4 to 5, bailing out
23:13:00.507213 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.507197 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.508057 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.508061 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.508285 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:13:00.508283 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:13:00.510034 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:00.510113 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:00.557379 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.557382 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.558322 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.558322 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.558595 [0] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:13:00.558600 [2] AppendEntries reply: Term:5 Success:%!d(bool=true)
23:13:00.561270 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:00.561727 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:00.576545 [TEST] Disconnect 1
23:13:00.576960 [TEST] Disconnect 2
23:13:00.607616 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.607615 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.657838 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.657939 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.708079 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.708079 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.715683 [2] becomes Candidate (currentTerm=6); log=[]
23:13:00.715788 [2] sending RequestVote to 1: Term:6 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:00.715763 [2] sending RequestVote to 0: Term:6 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:00.715844 [2] election timer started (216ms), term=6
23:13:00.746180 [0] becomes Candidate (currentTerm=6); log=[]
23:13:00.746250 [0] election timer started (234ms), term=6
23:13:00.746250 [0] sending RequestVote to 1: Term:6 LastLogIndex:-1 LastLogTerm:-1
23:13:00.746335 [0] sending RequestVote to 2: Term:6 LastLogIndex:-1 LastLogTerm:-1
23:13:00.758325 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.758331 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.808563 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.808563 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.858826 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.858818 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.887129 [TEST] Reconnect 2
23:13:00.887313 [TEST] Reconnect 1
23:13:00.909056 [1] sending AppendEntries to 0: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.909065 [1] sending AppendEntries to 2: ni=0, args=Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.910465 [0] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.910467 [2] AppendEntries: Term:5 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.910698 [2] AppendEntries reply: Term:6 Success:%!d(bool=false)
23:13:00.910707 [0] AppendEntries reply: Term:6 Success:%!d(bool=false)
23:13:00.911585 [1] term out of date in heartbeat reply
23:13:00.911609 [1] becomes Follower with term=6; log=[]
23:13:00.911653 [1] election timer started (198ms), term=6
23:13:00.936231 [2] becomes Candidate (currentTerm=7); log=[]
23:13:00.936298 [2] election timer started (183ms), term=7
23:13:00.936306 [2] sending RequestVote to 0: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:00.936337 [2] sending RequestVote to 1: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:00.937622 [0] RequestVote: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=6, votedFor=0, log index/term=(-1, -1)]
23:13:00.937862 [0] ... term out of date in RequestVote
23:13:00.937889 [0] becomes Follower with term=7; log=[]
23:13:00.937708 [1] RequestVote: Term:7 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=6, votedFor=-1, log index/term=(-1, -1)]
23:13:00.938035 [1] ... term out of date in RequestVote
23:13:00.938087 [0] ... RequestVote reply: Term:7 VoteGranted:true
23:13:00.938190 [1] becomes Follower with term=7; log=[]
23:13:00.938220 [0] election timer started (152ms), term=7
23:13:00.938355 [1] ... RequestVote reply: Term:7 VoteGranted:true
23:13:00.938475 [1] election timer started (295ms), term=7
23:13:00.939536 [2] received RequestVoteReply &{Msg:Term:7 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:00 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:00.939625 [2] wins election with 2 votes
23:13:00.939645 [2] becomes Leader; term=7, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:00.939695 [2] received RequestVoteReply &{Msg:Term:7 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:00 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:00.939767 [2] while waiting for reply, state = LEADER
23:13:00.939817 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.939819 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.940265 [0] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.940268 [1] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.940432 [0] AppendEntries reply: Term:7 Success:%!d(bool=true)
23:13:00.940436 [1] AppendEntries reply: Term:7 Success:%!d(bool=true)
23:13:00.941991 [1] in election timer term changed from 6 to 7, bailing out
23:13:00.942220 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:00.942567 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:00.946873 [0] in election timer term changed from 6 to 7, bailing out
23:13:00.946891 [2] in election timer state=LEADER, bailing out
23:13:00.989928 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.989931 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.990617 [1] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.990766 [0] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:00.990804 [1] AppendEntries reply: Term:7 Success:%!d(bool=true)
23:13:00.990926 [0] AppendEntries reply: Term:7 Success:%!d(bool=true)
23:13:00.991987 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:00.992047 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:01.038458 [TEST] Disconnect 2
23:13:01.038726 [TEST] Disconnect 0
23:13:01.040145 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.040138 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.090390 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.090388 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.140528 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.140521 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.149369 [0] becomes Candidate (currentTerm=8); log=[]
23:13:01.149501 [0] election timer started (265ms), term=8
23:13:01.149494 [0] sending RequestVote to 1: Term:8 LastLogIndex:-1 LastLogTerm:-1
23:13:01.149486 [0] sending RequestVote to 2: Term:8 LastLogIndex:-1 LastLogTerm:-1
23:13:01.190621 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.190622 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.240813 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.240800 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.289682 [1] becomes Candidate (currentTerm=8); log=[]
23:13:01.289833 [1] election timer started (244ms), term=8
23:13:01.289828 [1] sending RequestVote to 0: Term:8 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:01.289869 [1] sending RequestVote to 2: Term:8 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:01.291015 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.291045 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.341044 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.341047 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.349885 [TEST] Reconnect 0
23:13:01.350064 [TEST] Reconnect 2
23:13:01.391231 [2] sending AppendEntries to 1: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.391682 [2] sending AppendEntries to 0: ni=0, args=Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.392766 [1] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.392810 [0] AppendEntries: Term:7 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.392946 [0] AppendEntries reply: Term:8 Success:%!d(bool=false)
23:13:01.392947 [1] AppendEntries reply: Term:8 Success:%!d(bool=false)
23:13:01.393607 [2] term out of date in heartbeat reply
23:13:01.393628 [2] becomes Follower with term=8; log=[]
23:13:01.393679 [2] election timer started (161ms), term=8
23:13:01.420305 [0] becomes Candidate (currentTerm=9); log=[]
23:13:01.420431 [0] election timer started (184ms), term=9
23:13:01.420446 [0] sending RequestVote to 2: Term:9 LastLogIndex:-1 LastLogTerm:-1
23:13:01.420430 [0] sending RequestVote to 1: Term:9 LastLogIndex:-1 LastLogTerm:-1
23:13:01.421631 [1] RequestVote: Term:9 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=8, votedFor=1, log index/term=(-1, -1)]
23:13:01.421655 [2] RequestVote: Term:9 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=8, votedFor=-1, log index/term=(-1, -1)]
23:13:01.421696 [1] ... term out of date in RequestVote
23:13:01.421717 [2] ... term out of date in RequestVote
23:13:01.421728 [1] becomes Follower with term=9; log=[]
23:13:01.421733 [2] becomes Follower with term=9; log=[]
23:13:01.421879 [1] ... RequestVote reply: Term:9 VoteGranted:true
23:13:01.421907 [2] ... RequestVote reply: Term:9 VoteGranted:true
23:13:01.422034 [1] election timer started (288ms), term=9
23:13:01.422734 [2] election timer started (265ms), term=9
23:13:01.423802 [2] in election timer term changed from 8 to 9, bailing out
23:13:01.424011 [0] received RequestVoteReply &{Msg:Term:9 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:01 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:01.424098 [0] wins election with 2 votes
23:13:01.424120 [0] becomes Leader; term=9, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:13:01.424170 [0] received RequestVoteReply &{Msg:Term:9 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:01 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:01.424236 [0] while waiting for reply, state = LEADER
23:13:01.424278 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.424291 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.424724 [1] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.424724 [2] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.424878 [1] AppendEntries reply: Term:9 Success:%!d(bool=true)
23:13:01.424900 [2] AppendEntries reply: Term:9 Success:%!d(bool=true)
23:13:01.426060 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:01.426139 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:01.430528 [1] in election timer term changed from 8 to 9, bailing out
23:13:01.430573 [0] in election timer state=LEADER, bailing out
23:13:01.474395 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.474374 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.475148 [2] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.475152 [1] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.475376 [1] AppendEntries reply: Term:9 Success:%!d(bool=true)
23:13:01.475376 [2] AppendEntries reply: Term:9 Success:%!d(bool=true)
23:13:01.476165 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:01.476563 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:01.501059 [TEST] Disconnect 0
23:13:01.501473 [TEST] Disconnect 1
23:13:01.524571 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.524602 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.574778 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.574778 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.625085 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.625096 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.675224 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.675212 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.725464 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.725463 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.743476 [2] becomes Candidate (currentTerm=10); log=[]
23:13:01.743564 [2] election timer started (180ms), term=10
23:13:01.743542 [2] sending RequestVote to 0: Term:10 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:01.743534 [2] sending RequestVote to 1: Term:10 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:01.763477 [1] becomes Candidate (currentTerm=10); log=[]
23:13:01.763559 [1] election timer started (158ms), term=10
23:13:01.763541 [1] sending RequestVote to 0: Term:10 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:01.763534 [1] sending RequestVote to 2: Term:10 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:01.775729 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.775747 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.811692 [TEST] Reconnect 1
23:13:01.811948 [TEST] Reconnect 0
23:13:01.825957 [0] sending AppendEntries to 2: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.825959 [0] sending AppendEntries to 1: ni=0, args=Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.827683 [2] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.827683 [1] AppendEntries: Term:9 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.827909 [1] AppendEntries reply: Term:10 Success:%!d(bool=false)
23:13:01.827909 [2] AppendEntries reply: Term:10 Success:%!d(bool=false)
23:13:01.830085 [0] term out of date in heartbeat reply
23:13:01.830117 [0] becomes Follower with term=10; log=[]
23:13:01.830169 [0] election timer started (218ms), term=10
23:13:01.924005 [2] becomes Candidate (currentTerm=11); log=[]
23:13:01.924023 [1] becomes Candidate (currentTerm=11); log=[]
23:13:01.924144 [1] election timer started (289ms), term=11
23:13:01.924119 [2] sending RequestVote to 0: Term:11 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:01.924100 [2] sending RequestVote to 1: Term:11 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:01.924235 [2] election timer started (200ms), term=11
23:13:01.924236 [1] sending RequestVote to 2: Term:11 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:01.924209 [1] sending RequestVote to 0: Term:11 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:01.925541 [0] RequestVote: Term:11 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=10, votedFor=-1, log index/term=(-1, -1)]
23:13:01.925623 [0] ... term out of date in RequestVote
23:13:01.925643 [0] becomes Follower with term=11; log=[]
23:13:01.925646 [2] RequestVote: Term:11 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=11, votedFor=2, log index/term=(-1, -1)]
23:13:01.925718 [1] RequestVote: Term:11 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=11, votedFor=1, log index/term=(-1, -1)]
23:13:01.925812 [0] ... RequestVote reply: Term:11 VoteGranted:true
23:13:01.925867 [2] ... RequestVote reply: Term:11
23:13:01.925926 [1] ... RequestVote reply: Term:11
23:13:01.925905 [0] RequestVote: Term:11 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=11, votedFor=2, log index/term=(-1, -1)]
23:13:01.926229 [0] ... RequestVote reply: Term:11
23:13:01.926355 [0] election timer started (247ms), term=11
23:13:01.928680 [2] received RequestVoteReply &{Msg:Term:11 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:01 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:01.928792 [2] wins election with 2 votes
23:13:01.928816 [2] becomes Leader; term=11, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:01.928839 [1] received RequestVoteReply &{Msg:Term:11 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:01 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:01.928905 [2] sending AppendEntries to 0: ni=0, args=Term:11 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.928941 [1] received RequestVoteReply &{Msg:Term:11 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:01 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:01.928916 [2] received RequestVoteReply &{Msg:Term:11 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:01 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:01.929033 [2] while waiting for reply, state = LEADER
23:13:01.929074 [2] sending AppendEntries to 1: ni=0, args=Term:11 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.929612 [0] AppendEntries: Term:11 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.929778 [0] AppendEntries reply: Term:11 Success:%!d(bool=true)
23:13:01.929802 [1] AppendEntries: Term:11 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:01.929864 [1] becomes Follower with term=11; log=[]
23:13:01.930007 [1] AppendEntries reply: Term:11 Success:%!d(bool=true)
23:13:01.930052 [1] election timer started (194ms), term=11
23:13:01.930344 [0] in election timer term changed from 10 to 11, bailing out
23:13:01.930894 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:01.931185 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:01.934649 [2] in election timer state=LEADER, bailing out
23:13:01.962513 [0] CM.Stop called
23:13:01.962540 [0] becomes Dead
23:13:01.962564 [0] commitChanSender done
23:13:01.962597 Received quit signal. Shutting down...
23:13:01.962672 Listener close error: close tcp [::]:54303: use of closed network connection
23:13:01.962707 [0] CraftServer terminated!
23:13:01.962732 [1] CM.Stop called
23:13:01.962749 [1] becomes Dead
23:13:01.962768 [1] commitChanSender done
23:13:01.962798 Received quit signal. Shutting down...
23:13:01.962849 Listener close error: close tcp [::]:54304: use of closed network connection
23:13:01.962876 [1] CraftServer terminated!
23:13:01.962898 [2] CM.Stop called
23:13:01.962913 [2] becomes Dead
23:13:01.962931 [2] commitChanSender done
23:13:01.962959 Received quit signal. Shutting down...
23:13:01.963014 Listener close error: close tcp [::]:54305: use of closed network connection
23:13:01.963049 [2] CraftServer terminated!
23:13:01.964272 [1] in election timer state=DEAD, bailing out
23:13:01.966701 [0] in election timer state=DEAD, bailing out
23:13:01.970565 [1] in election timer state=DEAD, bailing out
--- PASS: TestElectionDisconnectLoop (2.67s)
=== RUN   TestCommitOneCommand
23:13:02.016580 [0] listening at [::]:54331
23:13:02.016863 [1] listening at [::]:54332
23:13:02.017103 [2] listening at [::]:54333
23:13:02.017276 [1] election timer started (230ms), term=0
23:13:02.017285 [2] election timer started (213ms), term=0
23:13:02.017287 [0] election timer started (289ms), term=0
23:13:02.238407 [2] becomes Candidate (currentTerm=1); log=[]
23:13:02.238630 [2] election timer started (276ms), term=1
23:13:02.238583 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:02.238599 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:02.241806 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:02.241919 [1] ... term out of date in RequestVote
23:13:02.241945 [1] becomes Follower with term=1; log=[]
23:13:02.242040 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:02.242133 [0] ... term out of date in RequestVote
23:13:02.242154 [0] becomes Follower with term=1; log=[]
23:13:02.242181 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:02.242409 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:02.242718 [0] election timer started (253ms), term=1
23:13:02.242844 [1] election timer started (190ms), term=1
23:13:02.244380 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:02 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:02.244819 [2] wins election with 2 votes
23:13:02.244846 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:02.245114 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:02 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:02.245543 [2] while waiting for reply, state = LEADER
23:13:02.245068 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.245078 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.246199 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.246201 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.246438 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.246438 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.247543 [1] in election timer term changed from 0 to 1, bailing out
23:13:02.247824 [0] in election timer term changed from 0 to 1, bailing out
23:13:02.248654 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:02.248717 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:02.248772 [2] in election timer state=LEADER, bailing out
23:13:02.295370 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.295370 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.296561 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.296563 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.296864 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.296862 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.299783 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:02.300161 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:02.327267 [TEST] submitting 42 to 2
23:13:02.327667 [2] Submit received by LEADER: 42
23:13:02.327885 [2] ... log=[{42 1}]
23:13:02.329238 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:02.334613 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:02.348533 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:02.348645 [1] ... inserting entries [Command:42 Term:1] from index 0
23:13:02.348688 [1] ... log is now: [{42 1}]
23:13:02.348832 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.350979 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:02.351069 [0] ... inserting entries [Command:42 Term:1] from index 0
23:13:02.351104 [0] ... log is now: [{42 1}]
23:13:02.351462 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.354557 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:1], matchIndex := map[0:-1 1:0]; commitIndex := 0
23:13:02.354609 [2] leader sets commitIndex := 0
23:13:02.354685 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.354733 [2] commitChanSender entries=[{42 1}], savedLastApplied=-1
23:13:02.354954 [TEST] collectCommits(2) got {Command:42 Index:0 Term:1}
23:13:02.354726 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1}
23:13:02.359205 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.359290 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.359299 [1] ... setting commitIndex=0
23:13:02.359354 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1}
23:13:02.359457 [0] ... setting commitIndex=0
23:13:02.359428 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.359538 [1] commitChanSender entries=[{42 1}], savedLastApplied=-1
23:13:02.359607 [TEST] collectCommits(1) got {Command:42 Index:0 Term:1}
23:13:02.359666 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.359734 [0] commitChanSender entries=[{42 1}], savedLastApplied=-1
23:13:02.359775 [TEST] collectCommits(0) got {Command:42 Index:0 Term:1}
23:13:02.360035 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.360485 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.404813 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.404816 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.405293 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.405410 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.405392 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.405502 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.405827 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.406246 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.454950 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.454959 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.455503 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.455615 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.455646 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.455742 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.456115 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.456191 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.505155 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.505170 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.505843 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.506048 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.506032 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.506551 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.507333 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.508420 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.555395 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.555418 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.556071 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.556068 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:02.556279 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.556397 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.557923 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.558004 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:02.578799 [0] CM.Stop called
23:13:02.578834 [0] becomes Dead
23:13:02.578862 [0] commitChanSender done
23:13:02.578908 Received quit signal. Shutting down...
23:13:02.579059 Listener close error: close tcp [::]:54331: use of closed network connection
23:13:02.579102 [0] CraftServer terminated!
23:13:02.579133 [1] CM.Stop called
23:13:02.579155 [1] becomes Dead
23:13:02.579177 [1] commitChanSender done
23:13:02.579211 Received quit signal. Shutting down...
23:13:02.579263 Listener close error: close tcp [::]:54332: use of closed network connection
23:13:02.579299 [1] CraftServer terminated!
23:13:02.579326 [2] CM.Stop called
23:13:02.579344 [2] becomes Dead
23:13:02.579367 [2] commitChanSender done
23:13:02.579409 Received quit signal. Shutting down...
23:13:02.579449 Listener close error: close tcp [::]:54333: use of closed network connection
23:13:02.579477 [2] CraftServer terminated!
23:13:02.583309 [1] in election timer state=DEAD, bailing out
23:13:02.583323 [0] in election timer state=DEAD, bailing out
--- PASS: TestCommitOneCommand (0.62s)
=== RUN   TestCommitAfterCallDrops
23:13:02.634127 [0] listening at [::]:54337
23:13:02.634536 [1] listening at [::]:54338
23:13:02.634858 [2] listening at [::]:54339
23:13:02.635081 [1] election timer started (265ms), term=0
23:13:02.635084 [2] election timer started (226ms), term=0
23:13:02.635095 [0] election timer started (216ms), term=0
23:13:02.856285 [0] becomes Candidate (currentTerm=1); log=[]
23:13:02.856463 [0] election timer started (169ms), term=1
23:13:02.856458 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:02.856571 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:02.858806 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:02.858807 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:02.858888 [2] ... term out of date in RequestVote
23:13:02.858908 [1] ... term out of date in RequestVote
23:13:02.858927 [2] becomes Follower with term=1; log=[]
23:13:02.858933 [1] becomes Follower with term=1; log=[]
23:13:02.859182 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:02.859185 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:02.859303 [1] election timer started (213ms), term=1
23:13:02.859347 [2] election timer started (267ms), term=1
23:13:02.862909 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:02 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:02.863040 [0] wins election with 2 votes
23:13:02.863064 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:13:02.863138 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:02 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:02.863221 [0] while waiting for reply, state = LEADER
23:13:02.863293 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.863289 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.863957 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.863963 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.864156 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.864163 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.865356 [2] in election timer term changed from 0 to 1, bailing out
23:13:02.865301 [1] in election timer term changed from 0 to 1, bailing out
23:13:02.866586 [0] in election timer state=LEADER, bailing out
23:13:02.866624 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:02.866780 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:02.913818 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.913805 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.914966 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.914966 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:02.915267 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.915269 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.918500 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:02.918586 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:02.937015 [TEST] peer 0 drop calls after 2
23:13:02.937092 [0] Submit received by LEADER: 99
23:13:02.937351 [0] ... log=[{99 1}]
23:13:02.937445 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:99 Term:1} LeaderCommit:-1
23:13:02.937472 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:99 Term:1} LeaderCommit:-1
23:13:02.938467 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:99 Term:1} LeaderCommit:-1
23:13:02.938466 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:99 Term:1} LeaderCommit:-1
23:13:02.938569 [1] ... inserting entries [Command:99 Term:1] from index 0
23:13:02.938592 [2] ... inserting entries [Command:99 Term:1] from index 0
23:13:02.938612 [1] ... log is now: [{99 1}]
23:13:02.938635 [2] ... log is now: [{99 1}]
23:13:02.938760 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.938777 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.940460 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:1], matchIndex := map[1:-1 2:0]; commitIndex := 0
23:13:02.940541 [0] leader sets commitIndex := 0
23:13:02.940593 [0] AppendEntries reply from 1 success: nextIndex := map[1:1 2:1], matchIndex := map[1:0 2:0]; commitIndex := 0
23:13:02.940687 [0] commitChanSender entries=[{99 1}], savedLastApplied=-1
23:13:02.940669 [0] sending AppendEntries to 2: ni=1, args=Term:1 PrevLogTerm:1
23:13:02.940707 [0] sending AppendEntries to 1: ni=1, args=Term:1 PrevLogTerm:1
23:13:02.940747 [TEST] collectCommits(0) got {Command:99 Index:0 Term:1}
23:13:02.941240 [2] AppendEntries: Term:1 PrevLogTerm:1
23:13:02.941245 [1] AppendEntries: Term:1 PrevLogTerm:1
23:13:02.941566 [2] ... setting commitIndex=0
23:13:02.941814 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.942222 [1] ... setting commitIndex=0
23:13:02.942239 [2] commitChanSender entries=[{99 1}], savedLastApplied=-1
23:13:02.942293 [TEST] collectCommits(2) got {Command:99 Index:0 Term:1}
23:13:02.942394 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.942468 [1] commitChanSender entries=[{99 1}], savedLastApplied=-1
23:13:02.942516 [TEST] collectCommits(1) got {Command:99 Index:0 Term:1}
23:13:02.943740 [0] AppendEntries reply from 2 success: nextIndex := map[1:1 2:1], matchIndex := map[1:0 2:0]; commitIndex := 0
23:13:02.943818 [0] AppendEntries reply from 1 success: nextIndex := map[1:1 2:1], matchIndex := map[1:0 2:0]; commitIndex := 0
23:13:02.967882 [TEST] peer %!d(MISSING) don't drop calls
23:13:02.990826 [0] sending AppendEntries to 1: ni=1, args=Term:1 PrevLogTerm:1
23:13:02.990826 [0] sending AppendEntries to 2: ni=1, args=Term:1 PrevLogTerm:1
23:13:02.991818 [1] AppendEntries: Term:1 PrevLogTerm:1
23:13:02.991819 [2] AppendEntries: Term:1 PrevLogTerm:1
23:13:02.992093 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.992094 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:02.994951 [0] AppendEntries reply from 2 success: nextIndex := map[1:1 2:1], matchIndex := map[1:0 2:0]; commitIndex := 0
23:13:02.995127 [0] AppendEntries reply from 1 success: nextIndex := map[1:1 2:1], matchIndex := map[1:0 2:0]; commitIndex := 0
23:13:03.029559 [0] CM.Stop called
23:13:03.029623 [0] becomes Dead
23:13:03.029668 [0] commitChanSender done
23:13:03.029727 Received quit signal. Shutting down...
23:13:03.029896 Listener close error: close tcp [::]:54337: use of closed network connection
23:13:03.029978 [0] CraftServer terminated!
23:13:03.030030 [1] CM.Stop called
23:13:03.030064 [1] becomes Dead
23:13:03.030097 [1] commitChanSender done
23:13:03.030142 Received quit signal. Shutting down...
23:13:03.030278 Listener close error: close tcp [::]:54338: use of closed network connection
23:13:03.030338 [1] CraftServer terminated!
23:13:03.030382 [2] CM.Stop called
23:13:03.030412 [2] becomes Dead
23:13:03.030462 [2] commitChanSender done
23:13:03.030513 Received quit signal. Shutting down...
23:13:03.030623 Listener close error: close tcp [::]:54339: use of closed network connection
23:13:03.030677 [2] CraftServer terminated!
23:13:03.040443 [2] in election timer state=DEAD, bailing out
23:13:03.040462 [1] in election timer state=DEAD, bailing out
--- PASS: TestCommitAfterCallDrops (0.45s)
=== RUN   TestSubmitNonLeaderFails
23:13:03.084740 [0] listening at [::]:54342
23:13:03.085175 [1] listening at [::]:54343
23:13:03.085509 [2] listening at [::]:54344
23:13:03.085774 [0] election timer started (293ms), term=0
23:13:03.085785 [2] election timer started (173ms), term=0
23:13:03.085767 [1] election timer started (193ms), term=0
23:13:03.266941 [2] becomes Candidate (currentTerm=1); log=[]
23:13:03.267037 [2] election timer started (163ms), term=1
23:13:03.267049 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:03.267035 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:03.268383 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:03.268391 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:03.268459 [1] ... term out of date in RequestVote
23:13:03.268465 [0] ... term out of date in RequestVote
23:13:03.268477 [1] becomes Follower with term=1; log=[]
23:13:03.268486 [0] becomes Follower with term=1; log=[]
23:13:03.268694 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:03.268742 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:03.268780 [0] election timer started (288ms), term=1
23:13:03.268835 [1] election timer started (214ms), term=1
23:13:03.270203 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:03 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:03.270304 [2] wins election with 2 votes
23:13:03.270334 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:03.270410 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:03 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:03.270509 [2] while waiting for reply, state = LEADER
23:13:03.270571 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.270569 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.271129 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.271136 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.271333 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.271347 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.273818 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.273887 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.276130 [0] in election timer term changed from 0 to 1, bailing out
23:13:03.276143 [1] in election timer term changed from 0 to 1, bailing out
23:13:03.277292 [2] in election timer state=LEADER, bailing out
23:13:03.320779 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.320782 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.321671 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.321675 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.321901 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.321899 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.323453 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.323516 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.370919 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.370919 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.371888 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.371884 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.372202 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.372215 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.373103 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.373178 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.387793 [TEST] submitting 42 to 0
23:13:03.387831 [0] Submit received by FOLLOWER: 42
23:13:03.398281 [0] CM.Stop called
23:13:03.398312 [0] becomes Dead
23:13:03.398336 [0] commitChanSender done
23:13:03.398365 Received quit signal. Shutting down...
23:13:03.398454 Listener close error: close tcp [::]:54342: use of closed network connection
23:13:03.398488 [0] CraftServer terminated!
23:13:03.398514 [1] CM.Stop called
23:13:03.398532 [1] becomes Dead
23:13:03.398555 [1] commitChanSender done
23:13:03.398591 Received quit signal. Shutting down...
23:13:03.398633 Listener close error: close tcp [::]:54343: use of closed network connection
23:13:03.398656 [1] CraftServer terminated!
23:13:03.398677 [2] CM.Stop called
23:13:03.398690 [2] becomes Dead
23:13:03.398713 [2] commitChanSender done
23:13:03.398746 Received quit signal. Shutting down...
23:13:03.398779 Listener close error: close tcp [::]:54344: use of closed network connection
23:13:03.398804 [2] CraftServer terminated!
23:13:03.398854 [0] in election timer state=DEAD, bailing out
--- PASS: TestSubmitNonLeaderFails (0.32s)
=== RUN   TestCommitMultipleCommands
23:13:03.398990 [1] in election timer state=DEAD, bailing out
23:13:03.400533 [0] listening at [::]:54347
23:13:03.400853 [1] listening at [::]:54348
23:13:03.401107 [2] listening at [::]:54349
23:13:03.401297 [1] election timer started (250ms), term=0
23:13:03.401311 [0] election timer started (243ms), term=0
23:13:03.401304 [2] election timer started (182ms), term=0
23:13:03.592481 [2] becomes Candidate (currentTerm=1); log=[]
23:13:03.592612 [2] election timer started (208ms), term=1
23:13:03.592631 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:03.592612 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:03.594464 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:03.594502 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:03.594602 [1] ... term out of date in RequestVote
23:13:03.594643 [0] ... term out of date in RequestVote
23:13:03.594692 [1] becomes Follower with term=1; log=[]
23:13:03.594732 [0] becomes Follower with term=1; log=[]
23:13:03.594932 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:03.594964 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:03.595018 [1] election timer started (222ms), term=1
23:13:03.595094 [0] election timer started (285ms), term=1
23:13:03.596284 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:03 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:03.596376 [2] wins election with 2 votes
23:13:03.596400 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:03.596474 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:03 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:03.596554 [2] while waiting for reply, state = LEADER
23:13:03.596597 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.596636 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.597122 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.597157 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.597313 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.597341 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.598515 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.598582 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.601774 [1] in election timer term changed from 0 to 1, bailing out
23:13:03.601797 [0] in election timer term changed from 0 to 1, bailing out
23:13:03.602735 [2] in election timer state=LEADER, bailing out
23:13:03.646616 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.646616 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.647457 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.647473 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.647733 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.647737 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.650661 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.650739 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.696734 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.696739 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.697888 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.697892 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:03.698263 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.698265 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.699433 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.699890 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:03.701844 [TEST] submitting 42 to 2
23:13:03.701874 [2] Submit received by LEADER: 42
23:13:03.702045 [2] ... log=[{42 1}]
23:13:03.702213 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:03.702124 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:03.702842 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:03.702845 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:42 Term:1} LeaderCommit:-1
23:13:03.702944 [0] ... inserting entries [Command:42 Term:1] from index 0
23:13:03.702968 [1] ... inserting entries [Command:42 Term:1] from index 0
23:13:03.702994 [0] ... log is now: [{42 1}]
23:13:03.703018 [1] ... log is now: [{42 1}]
23:13:03.703150 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.703167 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.705248 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:1], matchIndex := map[0:-1 1:0]; commitIndex := 0
23:13:03.705312 [2] leader sets commitIndex := 0
23:13:03.705355 [2] commitChanSender entries=[{42 1}], savedLastApplied=-1
23:13:03.705409 [TEST] collectCommits(2) got {Command:42 Index:0 Term:1}
23:13:03.705448 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:03.705512 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.705586 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.706222 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.706224 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.706284 [1] ... setting commitIndex=0
23:13:03.706293 [0] ... setting commitIndex=0
23:13:03.706565 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.706573 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.706649 [0] commitChanSender entries=[{42 1}], savedLastApplied=-1
23:13:03.706706 [TEST] collectCommits(0) got {Command:42 Index:0 Term:1}
23:13:03.706752 [1] commitChanSender entries=[{42 1}], savedLastApplied=-1
23:13:03.706847 [TEST] collectCommits(1) got {Command:42 Index:0 Term:1}
23:13:03.708042 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:03.708110 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:03.755522 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.755523 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.756385 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.756385 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1
23:13:03.756598 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.756596 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.757844 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:03.757913 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:03.802871 [TEST] submitting 55 to 2
23:13:03.802958 [2] Submit received by LEADER: 55
23:13:03.803336 [2] ... log=[{42 1} {55 1}]
23:13:03.803471 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1 Entries:{Command:55 Term:1}
23:13:03.803452 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1 Entries:{Command:55 Term:1}
23:13:03.804394 [0] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1 Entries:{Command:55 Term:1}
23:13:03.804397 [1] AppendEntries: Term:1 LeaderId:2 PrevLogTerm:1 Entries:{Command:55 Term:1}
23:13:03.804522 [0] ... inserting entries [Command:55 Term:1] from index 1
23:13:03.804560 [1] ... inserting entries [Command:55 Term:1] from index 1
23:13:03.804588 [0] ... log is now: [{42 1} {55 1}]
23:13:03.804650 [1] ... log is now: [{42 1} {55 1}]
23:13:03.804910 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.804936 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.807952 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:2], matchIndex := map[0:0 1:1]; commitIndex := 1
23:13:03.808016 [2] leader sets commitIndex := 1
23:13:03.808064 [2] commitChanSender entries=[{55 1}], savedLastApplied=0
23:13:03.808079 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:03.808106 [TEST] collectCommits(2) got {Command:55 Index:1 Term:1}
23:13:03.808070 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.808145 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.808867 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.808948 [1] ... setting commitIndex=1
23:13:03.808926 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.809010 [0] ... setting commitIndex=1
23:13:03.809111 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.809167 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.809192 [1] commitChanSender entries=[{55 1}], savedLastApplied=0
23:13:03.809236 [TEST] collectCommits(1) got {Command:55 Index:1 Term:1}
23:13:03.809274 [0] commitChanSender entries=[{55 1}], savedLastApplied=0
23:13:03.809310 [TEST] collectCommits(0) got {Command:55 Index:1 Term:1}
23:13:03.809801 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:03.810351 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:03.858216 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.858216 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.859121 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.859121 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:03.859385 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.859384 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.860951 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:03.861029 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:03.904363 [TEST] submitting 81 to 2
23:13:03.904475 [2] Submit received by LEADER: 81
23:13:03.904771 [2] ... log=[{42 1} {55 1} {81 1}]
23:13:03.904900 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
23:13:03.904886 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
23:13:03.905840 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
23:13:03.905839 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:81 Term:1} LeaderCommit:1
23:13:03.905964 [0] ... inserting entries [Command:81 Term:1] from index 2
23:13:03.905981 [1] ... inserting entries [Command:81 Term:1] from index 2
23:13:03.906014 [0] ... log is now: [{42 1} {55 1} {81 1}]
23:13:03.906046 [1] ... log is now: [{42 1} {55 1} {81 1}]
23:13:03.906224 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.906239 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.909130 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:3], matchIndex := map[0:1 1:2]; commitIndex := 2
23:13:03.909198 [2] leader sets commitIndex := 2
23:13:03.909269 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:03.909341 [2] commitChanSender entries=[{81 1}], savedLastApplied=1
23:13:03.909380 [TEST] collectCommits(2) got {Command:81 Index:2 Term:1}
23:13:03.909354 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.909408 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.910035 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.910130 [0] ... setting commitIndex=2
23:13:03.910280 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.910339 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.910350 [1] ... setting commitIndex=2
23:13:03.910481 [0] commitChanSender entries=[{81 1}], savedLastApplied=1
23:13:03.910517 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.910522 [TEST] collectCommits(0) got {Command:81 Index:2 Term:1}
23:13:03.910566 [1] commitChanSender entries=[{81 1}], savedLastApplied=1
23:13:03.910597 [TEST] collectCommits(1) got {Command:81 Index:2 Term:1}
23:13:03.911094 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:03.911902 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:03.959831 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.959831 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.960974 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.960975 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:03.961302 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.961302 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:03.963181 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:03.963279 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.010387 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.010406 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.012115 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.012140 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.012632 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.012782 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.014209 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.014614 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.060975 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.060956 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.062553 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.062553 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.063092 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.063092 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.064612 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.065260 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.111574 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.111574 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.112767 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.112768 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.113070 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.113070 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.115808 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.115884 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.162313 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.162324 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.163498 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.163500 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.163907 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.163905 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.165397 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.165467 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.213143 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.213157 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.214698 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.214696 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:04.215194 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.215197 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.216331 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.216998 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:04.256913 [0] CM.Stop called
23:13:04.257003 [0] becomes Dead
23:13:04.257057 [0] commitChanSender done
23:13:04.257137 Received quit signal. Shutting down...
23:13:04.257334 Listener close error: close tcp [::]:54347: use of closed network connection
23:13:04.257427 [0] CraftServer terminated!
23:13:04.257485 [1] CM.Stop called
23:13:04.257523 [1] becomes Dead
23:13:04.257570 [1] commitChanSender done
23:13:04.257635 Received quit signal. Shutting down...
23:13:04.257777 Listener close error: close tcp [::]:54348: use of closed network connection
23:13:04.257852 [1] CraftServer terminated!
23:13:04.257916 [2] CM.Stop called
23:13:04.257958 [2] becomes Dead
23:13:04.258003 [2] commitChanSender done
23:13:04.258058 Received quit signal. Shutting down...
23:13:04.258137 Listener close error: close tcp [::]:54349: use of closed network connection
23:13:04.258177 [2] CraftServer terminated!
23:13:04.265371 [0] in election timer state=DEAD, bailing out
23:13:04.265381 [1] in election timer state=DEAD, bailing out
--- PASS: TestCommitMultipleCommands (0.91s)
=== RUN   TestCommitWithDisconnectionAndRecover
23:13:04.314326 [0] listening at [::]:54352
23:13:04.314974 [1] listening at [::]:54353
23:13:04.315400 [2] listening at [::]:54354
23:13:04.315764 [2] election timer started (230ms), term=0
23:13:04.315795 [0] election timer started (193ms), term=0
23:13:04.315817 [1] election timer started (251ms), term=0
23:13:04.516173 [0] becomes Candidate (currentTerm=1); log=[]
23:13:04.516310 [0] election timer started (212ms), term=1
23:13:04.516328 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:04.516309 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:04.518128 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:04.518128 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:04.518198 [1] ... term out of date in RequestVote
23:13:04.518213 [2] ... term out of date in RequestVote
23:13:04.518222 [1] becomes Follower with term=1; log=[]
23:13:04.518243 [2] becomes Follower with term=1; log=[]
23:13:04.518399 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:04.518399 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:04.518479 [1] election timer started (188ms), term=1
23:13:04.518537 [2] election timer started (294ms), term=1
23:13:04.519941 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:04 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:04.520447 [0] wins election with 2 votes
23:13:04.520477 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:13:04.520541 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:04 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:04.520642 [0] while waiting for reply, state = LEADER
23:13:04.520899 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.520959 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.521594 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.521623 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.521790 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.521804 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.523214 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:04.523392 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:04.526293 [2] in election timer term changed from 0 to 1, bailing out
23:13:04.526323 [1] in election timer term changed from 0 to 1, bailing out
23:13:04.526434 [0] in election timer state=LEADER, bailing out
23:13:04.570918 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.570905 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.571733 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.571732 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:04.571917 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.572034 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.572835 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:04.573594 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:04.617813 [0] Submit received by LEADER: 5
23:13:04.618044 [0] ... log=[{5 1}]
23:13:04.618082 [0] Submit received by LEADER: 6
23:13:04.618213 [0] ... log=[{5 1} {6 1}]
23:13:04.618325 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.618291 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.618291 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.618312 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.619116 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.619120 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.619225 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:04.619232 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:04.619286 [1] ... log is now: [{5 1} {6 1}]
23:13:04.619294 [2] ... log is now: [{5 1} {6 1}]
23:13:04.619431 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.619446 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.619972 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.620162 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:04.620256 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.620426 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.621843 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:2], matchIndex := map[1:-1 2:1]; commitIndex := 1
23:13:04.621898 [0] leader sets commitIndex := 1
23:13:04.621938 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.622161 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.622210 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:04.622253 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:04.622287 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:04.622314 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.622406 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.622405 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.622460 [2] ... setting commitIndex=1
23:13:04.622627 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.622972 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.623058 [1] ... setting commitIndex=1
23:13:04.623118 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:04.623190 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.623199 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:04.623182 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.623238 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:04.623229 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:04.623559 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:04.623600 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:04.623718 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.625287 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.672343 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.672349 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.673187 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.673190 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.673435 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.673432 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.674721 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.674788 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.722747 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.722747 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.723827 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.723819 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.724181 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.724214 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.727275 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.727357 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.773276 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.773301 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.774812 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.774807 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.775321 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.775323 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.777758 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.777898 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.823760 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.823776 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.824718 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.824717 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.824999 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.824998 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.827965 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.828035 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.868830 [TEST] Disconnect 1
23:13:04.874148 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.874167 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.875260 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.875589 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.877344 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.924808 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.924785 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.926059 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.926471 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.928458 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:04.975514 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.975514 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.977133 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:04.977579 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:04.979465 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:05.019635 [1] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
23:13:05.019848 [1] election timer started (170ms), term=2
23:13:05.019842 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.019865 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.026269 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:05.026247 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:05.027783 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:05.028329 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.029248 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:05.077115 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:05.077116 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:05.078219 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:05.078579 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.079515 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:05.119684 [0] Submit received by LEADER: 7
23:13:05.120049 [0] ... log=[{5 1} {6 1} {7 1}]
23:13:05.120197 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:05.120181 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:05.121285 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:05.121425 [2] ... inserting entries [Command:7 Term:1] from index 2
23:13:05.121479 [2] ... log is now: [{5 1} {6 1} {7 1}]
23:13:05.121695 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.122607 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:3], matchIndex := map[1:1 2:2]; commitIndex := 2
23:13:05.122672 [0] leader sets commitIndex := 2
23:13:05.122716 [0] commitChanSender entries=[{7 1}], savedLastApplied=1
23:13:05.122755 [TEST] collectCommits(0) got {Command:7 Index:2 Term:1}
23:13:05.122751 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.122800 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.123496 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.123589 [2] ... setting commitIndex=2
23:13:05.123811 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.123874 [2] commitChanSender entries=[{7 1}], savedLastApplied=1
23:13:05.123916 [TEST] collectCommits(2) got {Command:7 Index:2 Term:1}
23:13:05.124599 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:3], matchIndex := map[1:1 2:2]; commitIndex := 2
23:13:05.173200 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.173200 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.174703 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.175175 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.178140 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:3], matchIndex := map[1:1 2:2]; commitIndex := 2
23:13:05.190057 [1] becomes Candidate (currentTerm=3); log=[{5 1} {6 1}]
23:13:05.190249 [1] election timer started (273ms), term=3
23:13:05.190200 [1] sending RequestVote to 0: Term:3 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.190192 [1] sending RequestVote to 2: Term:3 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.223572 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.223579 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.224772 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.225040 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.226410 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:3], matchIndex := map[1:1 2:2]; commitIndex := 2
23:13:05.274024 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.274024 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.275609 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.276061 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.277836 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:3], matchIndex := map[1:1 2:2]; commitIndex := 2
23:13:05.324524 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.324532 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.326153 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.326569 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.328412 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:3], matchIndex := map[1:1 2:2]; commitIndex := 2
23:13:05.370297 [TEST] Reconnect 1
23:13:05.375160 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.375122 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.376893 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.377242 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:05.377439 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.377720 [1] AppendEntries reply: Term:3 Success:%!d(bool=false)
23:13:05.378127 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:3], matchIndex := map[1:1 2:2]; commitIndex := 2
23:13:05.378403 [0] term out of date in heartbeat reply
23:13:05.378427 [0] becomes Follower with term=3; log=[{5 1} {6 1} {7 1}]
23:13:05.378499 [0] election timer started (221ms), term=3
23:13:05.470513 [1] becomes Candidate (currentTerm=4); log=[{5 1} {6 1}]
23:13:05.470728 [1] election timer started (211ms), term=4
23:13:05.470744 [1] sending RequestVote to 2: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.470726 [1] sending RequestVote to 0: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.473161 [2] RequestVote: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=0, log index/term=(2, 1)]
23:13:05.473161 [0] RequestVote: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=3, votedFor=-1, log index/term=(2, 1)]
23:13:05.473314 [2] ... term out of date in RequestVote
23:13:05.473349 [0] ... term out of date in RequestVote
23:13:05.473362 [2] becomes Follower with term=4; log=[{5 1} {6 1} {7 1}]
23:13:05.473398 [0] becomes Follower with term=4; log=[{5 1} {6 1} {7 1}]
23:13:05.473776 [0] ... RequestVote reply: Term:4
23:13:05.473771 [2] ... RequestVote reply: Term:4
23:13:05.473881 [0] election timer started (270ms), term=4
23:13:05.473919 [2] election timer started (216ms), term=4
23:13:05.477898 [1] received RequestVoteReply &{Msg:Term:4 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:05 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:05.478022 [1] received RequestVoteReply &{Msg:Term:4 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:05 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:05.478672 [2] in election timer term changed from 1 to 4, bailing out
23:13:05.478691 [0] in election timer term changed from 3 to 4, bailing out
23:13:05.681745 [1] becomes Candidate (currentTerm=5); log=[{5 1} {6 1}]
23:13:05.681962 [1] election timer started (230ms), term=5
23:13:05.681954 [1] sending RequestVote to 0: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.681979 [1] sending RequestVote to 2: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:05.683375 [0] RequestVote: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=4, votedFor=-1, log index/term=(2, 1)]
23:13:05.683376 [2] RequestVote: Term:5 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=4, votedFor=-1, log index/term=(2, 1)]
23:13:05.683515 [0] ... term out of date in RequestVote
23:13:05.683550 [2] ... term out of date in RequestVote
23:13:05.683561 [0] becomes Follower with term=5; log=[{5 1} {6 1} {7 1}]
23:13:05.683591 [2] becomes Follower with term=5; log=[{5 1} {6 1} {7 1}]
23:13:05.683914 [0] ... RequestVote reply: Term:5
23:13:05.683917 [2] ... RequestVote reply: Term:5
23:13:05.683981 [0] in election timer term changed from 4 to 5, bailing out
23:13:05.684015 [2] election timer started (203ms), term=5
23:13:05.684070 [2] in election timer term changed from 4 to 5, bailing out
23:13:05.684092 [0] election timer started (167ms), term=5
23:13:05.685650 [1] received RequestVoteReply &{Msg:Term:5 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:05 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:05.685767 [1] received RequestVoteReply &{Msg:Term:5 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:05 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:05.854288 [0] becomes Candidate (currentTerm=6); log=[{5 1} {6 1} {7 1}]
23:13:05.854538 [0] election timer started (263ms), term=6
23:13:05.854545 [0] sending RequestVote to 2: Term:6 LastLogIndex:2 LastLogTerm:1
23:13:05.854527 [0] sending RequestVote to 1: Term:6 LastLogIndex:2 LastLogTerm:1
23:13:05.855893 [1] RequestVote: Term:6 LastLogIndex:2 LastLogTerm:1 [currentTerm=5, votedFor=1, log index/term=(1, 1)]
23:13:05.855912 [2] RequestVote: Term:6 LastLogIndex:2 LastLogTerm:1 [currentTerm=5, votedFor=-1, log index/term=(2, 1)]
23:13:05.856016 [1] ... term out of date in RequestVote
23:13:05.856047 [2] ... term out of date in RequestVote
23:13:05.856068 [1] becomes Follower with term=6; log=[{5 1} {6 1}]
23:13:05.856092 [2] becomes Follower with term=6; log=[{5 1} {6 1} {7 1}]
23:13:05.856419 [2] ... RequestVote reply: Term:6 VoteGranted:true
23:13:05.856420 [1] ... RequestVote reply: Term:6 VoteGranted:true
23:13:05.856509 [2] election timer started (219ms), term=6
23:13:05.856980 [1] election timer started (178ms), term=6
23:13:05.859442 [0] received RequestVoteReply &{Msg:Term:6 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:05 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:05.859563 [0] wins election with 2 votes
23:13:05.859586 [0] becomes Leader; term=6, nextIndex=map[1:3 2:3], matchIndex=map[1:-1 2:-1]; log=[{5 1} {6 1} {7 1}]
23:13:05.859673 [0] received RequestVoteReply &{Msg:Term:6 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:05 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:05.859753 [0] while waiting for reply, state = LEADER
23:13:05.859865 [0] sending AppendEntries to 2: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.860123 [0] sending AppendEntries to 1: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.860663 [2] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.860905 [2] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:05.860890 [1] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.861096 [1] AppendEntries reply: Term:6 Success:%!d(bool=false)
23:13:05.862349 [1] in election timer term changed from 5 to 6, bailing out
23:13:05.862643 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:-1 2:2]; commitIndex := 2
23:13:05.862709 [0] AppendEntries reply from 1 !success: nextIndex := 2
23:13:05.864317 [2] in election timer term changed from 5 to 6, bailing out
23:13:05.864930 [0] in election timer state=LEADER, bailing out
23:13:05.910268 [0] sending AppendEntries to 2: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.910268 [0] sending AppendEntries to 1: ni=2, args=Term:6 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.911291 [2] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.911291 [1] AppendEntries: Term:6 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:2
23:13:05.911429 [1] ... inserting entries [Command:7 Term:1] from index 2
23:13:05.911481 [1] ... log is now: [{5 1} {6 1} {7 1}]
23:13:05.911523 [1] ... setting commitIndex=2
23:13:05.911610 [2] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:05.911703 [1] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:05.911785 [1] commitChanSender entries=[{7 1}], savedLastApplied=1
23:13:05.911850 [TEST] collectCommits(1) got {Command:7 Index:2 Term:6}
23:13:05.914319 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:05.914451 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:05.960669 [0] sending AppendEntries to 1: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.960659 [0] sending AppendEntries to 2: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.962275 [1] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.962271 [2] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:05.962686 [2] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:05.962685 [1] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:05.963680 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:05.964365 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:06.011098 [0] sending AppendEntries to 2: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.011098 [0] sending AppendEntries to 1: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.012636 [1] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.012641 [2] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.013160 [1] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:06.013156 [2] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:06.015568 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:06.015640 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:06.061604 [0] sending AppendEntries to 1: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.061597 [0] sending AppendEntries to 2: ni=3, args=Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.062763 [2] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.062761 [1] AppendEntries: Term:6 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:06.063156 [1] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:06.063197 [2] AppendEntries reply: Term:6 Success:%!d(bool=true)
23:13:06.064452 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:06.064534 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:06.073545 [0] CM.Stop called
23:13:06.073574 [0] becomes Dead
23:13:06.073603 [0] commitChanSender done
23:13:06.073635 Received quit signal. Shutting down...
23:13:06.073782 Listener close error: close tcp [::]:54352: use of closed network connection
23:13:06.073839 [0] CraftServer terminated!
23:13:06.073884 [1] CM.Stop called
23:13:06.073916 [1] becomes Dead
23:13:06.073948 [1] commitChanSender done
23:13:06.074023 Received quit signal. Shutting down...
23:13:06.074078 Listener close error: close tcp [::]:54353: use of closed network connection
23:13:06.074127 [1] CraftServer terminated!
23:13:06.074163 [2] CM.Stop called
23:13:06.074269 [2] becomes Dead
23:13:06.074301 [2] commitChanSender done
23:13:06.074510 Received quit signal. Shutting down...
23:13:06.074639 Listener close error: close tcp [::]:54354: use of closed network connection
23:13:06.074705 [2] CraftServer terminated!
23:13:06.076584 [2] in election timer state=DEAD, bailing out
23:13:06.077091 [1] in election timer state=DEAD, bailing out
--- PASS: TestCommitWithDisconnectionAndRecover (1.82s)
=== RUN   TestNoCommitWithNoQuorum
23:13:06.130107 [0] listening at [::]:54362
23:13:06.130557 [1] listening at [::]:54363
23:13:06.130981 [2] listening at [::]:54364
23:13:06.131279 [2] election timer started (296ms), term=0
23:13:06.131297 [0] election timer started (151ms), term=0
23:13:06.131276 [1] election timer started (162ms), term=0
23:13:06.282379 [0] becomes Candidate (currentTerm=1); log=[]
23:13:06.282582 [0] election timer started (232ms), term=1
23:13:06.282557 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:06.282562 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:06.284872 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:06.284954 [2] ... term out of date in RequestVote
23:13:06.284872 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:06.284974 [2] becomes Follower with term=1; log=[]
23:13:06.284984 [1] ... term out of date in RequestVote
23:13:06.285022 [1] becomes Follower with term=1; log=[]
23:13:06.285203 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:06.285202 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:06.285282 [1] election timer started (179ms), term=1
23:13:06.285361 [2] election timer started (265ms), term=1
23:13:06.288595 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:06 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:06.288759 [0] wins election with 2 votes
23:13:06.288789 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:13:06.288878 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.288880 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:06 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:06.288977 [0] while waiting for reply, state = LEADER
23:13:06.289025 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.289734 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.289858 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.289949 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.290063 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.292231 [1] in election timer term changed from 0 to 1, bailing out
23:13:06.292164 [2] in election timer term changed from 0 to 1, bailing out
23:13:06.293033 [0] in election timer state=LEADER, bailing out
23:13:06.293639 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:06.293704 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:06.339314 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.339326 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.340397 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.340401 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.340675 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.340672 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.342459 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:06.342538 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:06.389754 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.389749 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.391202 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.391203 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:06.391641 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.391643 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.394548 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:06.394635 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:06.433397 [0] Submit received by LEADER: 5
23:13:06.434130 [0] ... log=[{5 1}]
23:13:06.434219 [0] Submit received by LEADER: 6
23:13:06.434603 [0] ... log=[{5 1} {6 1}]
23:13:06.434765 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.434841 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.434751 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.434743 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.435709 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.435847 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:06.435912 [1] ... log is now: [{5 1} {6 1}]
23:13:06.435708 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.436038 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:06.436092 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.436110 [2] ... log is now: [{5 1} {6 1}]
23:13:06.436277 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.436277 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.436551 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.436452 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:06.436811 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.437234 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:2], matchIndex := map[1:-1 2:1]; commitIndex := 1
23:13:06.437292 [0] leader sets commitIndex := 1
23:13:06.437326 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:06.437495 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:2], matchIndex := map[1:-1 2:1]; commitIndex := 1
23:13:06.437564 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.437634 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.437687 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.437905 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.438063 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:06.438157 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:06.438155 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.438169 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.438220 [2] ... setting commitIndex=1
23:13:06.438229 [1] ... setting commitIndex=1
23:13:06.438381 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.438389 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.438432 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:06.438444 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:06.438490 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:06.438538 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:06.438588 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:06.438638 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:06.439248 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.439498 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.487837 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.487832 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.489361 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.489366 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.489817 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.489819 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.492793 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.492961 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.538017 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.538036 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.539544 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.539546 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.540043 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.540048 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.541148 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.541917 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.588263 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.588287 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.589753 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.589749 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.590213 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.590214 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.592129 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.592206 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.638534 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.638541 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.640023 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.640023 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.640470 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.640468 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:06.641410 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.642218 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:06.685839 [TEST] Disconnect 1
23:13:06.686474 [TEST] Disconnect 2
23:13:06.688850 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.688843 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.739136 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.739135 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.789560 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.789555 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.826464 [1] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
23:13:06.826589 [1] election timer started (212ms), term=2
23:13:06.826572 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:06.826567 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:06.839939 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.839936 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.890334 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.890345 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:06.907560 [2] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
23:13:06.907703 [2] election timer started (188ms), term=2
23:13:06.907669 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:1 LastLogTerm:1
23:13:06.907674 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:1 LastLogTerm:1
23:13:06.937716 [0] Submit received by LEADER: 8
23:13:06.938008 [0] ... log=[{5 1} {6 1} {8 1}]
23:13:06.938108 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:06.938130 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:06.988308 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:06.988276 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.038375 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.038381 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.047701 [1] becomes Candidate (currentTerm=3); log=[{5 1} {6 1}]
23:13:07.047810 [1] election timer started (218ms), term=3
23:13:07.047804 [1] sending RequestVote to 0: Term:3 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:07.047833 [1] sending RequestVote to 2: Term:3 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:07.088941 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.088947 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.098403 [2] becomes Candidate (currentTerm=3); log=[{5 1} {6 1}]
23:13:07.098549 [2] election timer started (187ms), term=3
23:13:07.098568 [2] sending RequestVote to 1: Term:3 CandidateId:2 LastLogIndex:1 LastLogTerm:1
23:13:07.098545 [2] sending RequestVote to 0: Term:3 CandidateId:2 LastLogIndex:1 LastLogTerm:1
23:13:07.139009 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.138994 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.188943 [TEST] Reconnect 1
23:13:07.189017 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.189125 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.189281 [TEST] Reconnect 2
23:13:07.190828 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:1} LeaderCommit:1
23:13:07.191226 [1] AppendEntries reply: Term:3 Success:%!d(bool=false)
23:13:07.193953 [0] term out of date in heartbeat reply
23:13:07.193990 [0] becomes Follower with term=3; log=[{5 1} {6 1} {8 1}]
23:13:07.194071 [0] election timer started (152ms), term=3
23:13:07.268319 [1] becomes Candidate (currentTerm=4); log=[{5 1} {6 1}]
23:13:07.268541 [1] election timer started (207ms), term=4
23:13:07.268560 [1] sending RequestVote to 2: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:07.268543 [1] sending RequestVote to 0: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:07.270966 [2] RequestVote: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=3, votedFor=2, log index/term=(1, 1)]
23:13:07.271053 [2] ... term out of date in RequestVote
23:13:07.270965 [0] RequestVote: Term:4 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=3, votedFor=-1, log index/term=(2, 1)]
23:13:07.271076 [2] becomes Follower with term=4; log=[{5 1} {6 1}]
23:13:07.271101 [0] ... term out of date in RequestVote
23:13:07.271130 [0] becomes Follower with term=4; log=[{5 1} {6 1} {8 1}]
23:13:07.271333 [0] ... RequestVote reply: Term:4
23:13:07.271326 [2] ... RequestVote reply: Term:4 VoteGranted:true
23:13:07.271414 [2] election timer started (154ms), term=4
23:13:07.271399 [0] election timer started (167ms), term=4
23:13:07.273084 [1] received RequestVoteReply &{Msg:Term:4 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:07 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:07.273195 [1] wins election with 2 votes
23:13:07.273222 [1] becomes Leader; term=4, nextIndex=map[0:2 2:2], matchIndex=map[0:-1 2:-1]; log=[{5 1} {6 1}]
23:13:07.273309 [1] received RequestVoteReply &{Msg:Term:4 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:07 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:07.273384 [1] while waiting for reply, state = LEADER
23:13:07.273441 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.273448 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.274298 [0] in election timer term changed from 3 to 4, bailing out
23:13:07.274333 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.274301 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.274575 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.274595 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.275458 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:-1 2:1]; commitIndex := 1
23:13:07.276044 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.278744 [2] in election timer term changed from 3 to 4, bailing out
23:13:07.278780 [1] in election timer state=LEADER, bailing out
23:13:07.323741 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.323720 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.324922 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.324921 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.325282 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.325302 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.326349 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.326448 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.374039 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.374062 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.375571 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.375570 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.376051 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.376064 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.378656 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.379148 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.424292 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.424293 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.425838 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.425839 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.426288 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.426297 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.428140 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.428223 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.474686 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.474673 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.476152 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.476150 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.476631 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.476639 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.479134 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.479205 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.525035 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.525034 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.526527 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.526530 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.526978 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.526979 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.529998 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.530216 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.575146 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.575159 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.576330 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.576333 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.576604 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.576604 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.577433 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.577512 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.625599 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.625604 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.627150 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.627148 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.627648 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.627646 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.628805 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.629511 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.676103 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.676092 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.677569 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.677565 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.678083 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.678081 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.679405 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.679487 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.726604 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.726590 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.728126 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.728126 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.728578 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.728581 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.730319 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.730392 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.776975 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.776997 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.778024 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.778023 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:07.778339 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.778343 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.780120 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.780201 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:07.790454 [1] Submit received by LEADER: 9
23:13:07.790737 [1] ... log=[{5 1} {6 1} {9 4}]
23:13:07.790802 [1] Submit received by LEADER: 10
23:13:07.790975 [1] ... log=[{5 1} {6 1} {9 4} {10 4}]
23:13:07.791027 [1] Submit received by LEADER: 11
23:13:07.791200 [1] ... log=[{5 1} {6 1} {9 4} {10 4} {11 4}]
23:13:07.791320 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.791317 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.791410 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.791552 [1] sending AppendEntries to 2: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.791364 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.792671 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.792831 [2] ... inserting entries [Command:9 Term:4 Command:10 Term:4 Command:11 Term:4] from index 2
23:13:07.792710 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.792934 [2] ... log is now: [{5 1} {6 1} {9 4} {10 4} {11 4}]
23:13:07.792942 [0] ... inserting entries [Command:9 Term:4 Command:10 Term:4 Command:11 Term:4] from index 2
23:13:07.793034 [0] ... log is now: [{5 1} {6 1} {9 4} {10 4} {11 4}]
23:13:07.793142 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.793255 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.791307 [1] sending AppendEntries to 0: ni=2, args=Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.797004 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.797328 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.797326 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.797474 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:5], matchIndex := map[0:1 2:4]; commitIndex := 4
23:13:07.797535 [1] leader sets commitIndex := 4
23:13:07.797572 [1] commitChanSender entries=[{9 4} {10 4} {11 4}], savedLastApplied=1
23:13:07.797621 [TEST] collectCommits(1) got {Command:9 Index:2 Term:4}
23:13:07.797655 [TEST] collectCommits(1) got {Command:10 Index:3 Term:4}
23:13:07.797671 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.797711 [TEST] collectCommits(1) got {Command:11 Index:4 Term:4}
23:13:07.797693 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.797781 [1] sending AppendEntries to 2: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.798109 [1] sending AppendEntries to 0: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.798266 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.798598 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.798705 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.798807 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.798804 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:9 Term:4} Entries:{Command:10 Term:4} Entries:{Command:11 Term:4} LeaderCommit:1
23:13:07.798914 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.798977 [0] ... setting commitIndex=4
23:13:07.799063 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.799131 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.799165 [0] commitChanSender entries=[{9 4} {10 4} {11 4}], savedLastApplied=1
23:13:07.799262 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.799367 [2] ... setting commitIndex=4
23:13:07.799519 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.799772 [TEST] collectCommits(0) got {Command:9 Index:2 Term:4}
23:13:07.799813 [TEST] collectCommits(0) got {Command:10 Index:3 Term:4}
23:13:07.799840 [TEST] collectCommits(0) got {Command:11 Index:4 Term:4}
23:13:07.799898 [2] commitChanSender entries=[{9 4} {10 4} {11 4}], savedLastApplied=1
23:13:07.799947 [TEST] collectCommits(2) got {Command:9 Index:2 Term:4}
23:13:07.799974 [TEST] collectCommits(2) got {Command:10 Index:3 Term:4}
23:13:07.800017 [TEST] collectCommits(2) got {Command:11 Index:4 Term:4}
23:13:07.800040 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.800121 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.800475 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.800636 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.848464 [1] sending AppendEntries to 0: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.848460 [1] sending AppendEntries to 2: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.849715 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.849714 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.850138 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.850136 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.851512 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.853184 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.899376 [1] sending AppendEntries to 0: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.899370 [1] sending AppendEntries to 2: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.900937 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.900950 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.901380 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.901378 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.902376 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.902947 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.950269 [1] sending AppendEntries to 2: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.950289 [1] sending AppendEntries to 0: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.951844 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.951849 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:07.952297 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.952298 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:07.953212 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:07.953295 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:08.001283 [1] sending AppendEntries to 2: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.001307 [1] sending AppendEntries to 0: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.002491 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.002491 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.002908 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:08.002908 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:08.004311 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:08.004715 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:08.052439 [1] sending AppendEntries to 2: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.052454 [1] sending AppendEntries to 0: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.053928 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.053926 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.054446 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:08.054447 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:08.055922 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:08.057053 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:08.102495 [1] sending AppendEntries to 2: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.102529 [1] sending AppendEntries to 0: ni=5, args=Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.103716 [0] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.103720 [2] AppendEntries: Term:4 LeaderId:1 PrevLogIndex:4 PrevLogTerm:4 LeaderCommit:4
23:13:08.104180 [2] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:08.104187 [0] AppendEntries reply: Term:4 Success:%!d(bool=true)
23:13:08.105533 [1] AppendEntries reply from 2 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:08.105608 [1] AppendEntries reply from 0 success: nextIndex := map[0:5 2:5], matchIndex := map[0:4 2:4]; commitIndex := 4
23:13:08.142622 [0] CM.Stop called
23:13:08.142643 [0] becomes Dead
23:13:08.142660 [0] commitChanSender done
23:13:08.142684 Received quit signal. Shutting down...
23:13:08.142733 Listener close error: close tcp [::]:54362: use of closed network connection
23:13:08.142762 [0] CraftServer terminated!
23:13:08.142780 [1] CM.Stop called
23:13:08.142792 [1] becomes Dead
23:13:08.142811 [1] commitChanSender done
23:13:08.142831 Received quit signal. Shutting down...
23:13:08.142871 Listener close error: close tcp [::]:54363: use of closed network connection
23:13:08.142893 [1] CraftServer terminated!
23:13:08.142909 [2] CM.Stop called
23:13:08.142922 [2] becomes Dead
23:13:08.142938 [2] commitChanSender done
23:13:08.142974 Received quit signal. Shutting down...
23:13:08.143023 Listener close error: close tcp [::]:54364: use of closed network connection
23:13:08.143049 [2] CraftServer terminated!
23:13:08.151664 [0] in election timer state=DEAD, bailing out
23:13:08.151671 [2] in election timer state=DEAD, bailing out
--- PASS: TestNoCommitWithNoQuorum (2.07s)
=== RUN   TestDisconnectLeaderBriefly
23:13:08.195686 [0] listening at [::]:54376
23:13:08.195877 [1] listening at [::]:54377
23:13:08.196050 [2] listening at [::]:54378
23:13:08.196188 [0] election timer started (241ms), term=0
23:13:08.196191 [2] election timer started (189ms), term=0
23:13:08.196185 [1] election timer started (223ms), term=0
23:13:08.387302 [2] becomes Candidate (currentTerm=1); log=[]
23:13:08.387486 [2] election timer started (211ms), term=1
23:13:08.387477 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:08.387487 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:08.389966 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:08.389968 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:08.390115 [0] ... term out of date in RequestVote
23:13:08.390127 [1] ... term out of date in RequestVote
23:13:08.390151 [0] becomes Follower with term=1; log=[]
23:13:08.390164 [1] becomes Follower with term=1; log=[]
23:13:08.390525 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:08.390532 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:08.390754 [0] election timer started (258ms), term=1
23:13:08.390820 [1] election timer started (205ms), term=1
23:13:08.392348 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:08 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:08.392500 [2] wins election with 2 votes
23:13:08.392530 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:08.392600 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:08 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:08.392688 [2] while waiting for reply, state = LEADER
23:13:08.392764 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.392758 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.393557 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.393666 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.393798 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.393882 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.396984 [1] in election timer term changed from 0 to 1, bailing out
23:13:08.397100 [0] in election timer term changed from 0 to 1, bailing out
23:13:08.397560 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:08.397878 [2] in election timer state=LEADER, bailing out
23:13:08.397929 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:08.442990 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.442990 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.444455 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.444451 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.444827 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.444822 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.446887 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:08.446977 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:08.493210 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.493222 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.494801 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.494804 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:08.495255 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.495255 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.497599 [2] Submit received by LEADER: 5
23:13:08.497843 [2] ... log=[{5 1}]
23:13:08.497883 [2] Submit received by LEADER: 6
23:13:08.498104 [2] ... log=[{5 1} {6 1}]
23:13:08.498157 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:08.498272 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:08.498257 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.498269 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.498338 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.498365 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.499170 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.498983 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.499296 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:08.499308 [0] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:08.499376 [0] ... log is now: [{5 1} {6 1}]
23:13:08.499365 [1] ... log is now: [{5 1} {6 1}]
23:13:08.499564 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.499568 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.500105 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.500343 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.500346 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:08.500705 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.501073 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:0], matchIndex := map[0:1 1:-1]; commitIndex := 1
23:13:08.501143 [2] leader sets commitIndex := 1
23:13:08.501180 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:08.501258 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:08.501304 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:08.501337 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.501557 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:1
23:13:08.502374 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:0], matchIndex := map[0:1 1:-1]; commitIndex := 1
23:13:08.502736 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.502928 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:1
23:13:08.503134 [1] ... setting commitIndex=1
23:13:08.503230 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.503300 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.503322 [0] ... setting commitIndex=1
23:13:08.503446 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:08.503536 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:08.503588 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:08.504523 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.504606 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.504756 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:08.505576 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:08.505636 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:08.506136 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.506603 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.551392 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.551387 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.552622 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.552622 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.552969 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.552967 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.554764 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.554843 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.601995 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.601995 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.603125 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.603135 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.603548 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.603547 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.604774 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.606075 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.652179 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.652162 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.653786 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.653797 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.654272 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.654275 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.655482 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.655559 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.702250 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.702249 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.703830 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.703834 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.704316 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.704318 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.705507 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.706015 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.749079 [TEST] Disconnect 2
23:13:08.752445 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.752444 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.802573 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.802586 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.840912 [TEST] Reconnect 2
23:13:08.852714 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.852732 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.854861 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.854863 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.855164 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.855180 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.858533 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.858615 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.902937 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.902937 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.904119 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.904125 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.904418 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.904437 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.905313 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.905825 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.953133 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.953150 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.954727 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.954728 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:08.955154 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.955157 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:08.956198 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:08.956888 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:09.003337 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.003337 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.004896 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.004896 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.005389 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.005394 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.006785 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:09.006928 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:09.041907 [2] Submit received by LEADER: 7
23:13:09.042323 [2] ... log=[{5 1} {6 1} {7 1}]
23:13:09.042488 [2] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.042472 [2] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.043860 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.043861 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.044149 [1] ... inserting entries [Command:7 Term:1] from index 2
23:13:09.044058 [0] ... inserting entries [Command:7 Term:1] from index 2
23:13:09.044242 [1] ... log is now: [{5 1} {6 1} {7 1}]
23:13:09.044277 [0] ... log is now: [{5 1} {6 1} {7 1}]
23:13:09.044524 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.044521 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.047558 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:3], matchIndex := map[0:1 1:2]; commitIndex := 2
23:13:09.047691 [2] leader sets commitIndex := 2
23:13:09.047758 [2] commitChanSender entries=[{7 1}], savedLastApplied=1
23:13:09.047805 [TEST] collectCommits(2) got {Command:7 Index:2 Term:1}
23:13:09.047758 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.047853 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.047915 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.048478 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.048478 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.048559 [0] ... setting commitIndex=2
23:13:09.048575 [1] ... setting commitIndex=2
23:13:09.048736 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.048749 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.048827 [0] commitChanSender entries=[{7 1}], savedLastApplied=1
23:13:09.048791 [1] commitChanSender entries=[{7 1}], savedLastApplied=1
23:13:09.048888 [TEST] collectCommits(0) got {Command:7 Index:2 Term:1}
23:13:09.048930 [TEST] collectCommits(1) got {Command:7 Index:2 Term:1}
23:13:09.050297 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.050361 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.098539 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.098543 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.099685 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.099686 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.099982 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.099983 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.101007 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.101787 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.149440 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.149440 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.150701 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.150701 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.151075 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.151074 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.152842 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.154239 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.200257 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.200266 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.201981 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.201981 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.202308 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.202308 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.203336 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.203906 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.251361 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.251361 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.253050 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.253051 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:09.253566 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.253566 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.254654 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.255286 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:09.293482 [0] CM.Stop called
23:13:09.293578 [0] becomes Dead
23:13:09.293634 [0] commitChanSender done
23:13:09.293743 Received quit signal. Shutting down...
23:13:09.293988 Listener close error: close tcp [::]:54376: use of closed network connection
23:13:09.294078 [0] CraftServer terminated!
23:13:09.294133 [1] CM.Stop called
23:13:09.294176 [1] becomes Dead
23:13:09.294281 [1] commitChanSender done
23:13:09.294402 Received quit signal. Shutting down...
23:13:09.294457 Listener close error: close tcp [::]:54377: use of closed network connection
23:13:09.294518 [1] CraftServer terminated!
23:13:09.294669 [2] CM.Stop called
23:13:09.294696 [2] becomes Dead
23:13:09.294721 [2] commitChanSender done
23:13:09.294771 Received quit signal. Shutting down...
23:13:09.294816 Listener close error: close tcp [::]:54378: use of closed network connection
23:13:09.294859 [2] CraftServer terminated!
--- PASS: TestDisconnectLeaderBriefly (1.10s)
=== RUN   TestCommitsWithLeaderDisconnects
23:13:09.297239 [0] listening at [::]:54386
23:13:09.297651 [1] listening at [::]:54387
23:13:09.297988 [2] listening at [::]:54388
23:13:09.298315 [3] listening at [::]:54389
23:13:09.298628 [4] listening at [::]:54390
23:13:09.299299 [1] election timer started (228ms), term=0
23:13:09.299323 [3] election timer started (155ms), term=0
23:13:09.299366 [0] election timer started (230ms), term=0
23:13:09.299416 [4] election timer started (284ms), term=0
23:13:09.299422 [2] election timer started (255ms), term=0
23:13:09.301749 [0] in election timer state=DEAD, bailing out
23:13:09.301785 [1] in election timer state=DEAD, bailing out
23:13:09.460534 [3] becomes Candidate (currentTerm=1); log=[]
23:13:09.460835 [3] election timer started (206ms), term=1
23:13:09.460754 [3] sending RequestVote to 2: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
23:13:09.460747 [3] sending RequestVote to 4: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
23:13:09.461017 [3] sending RequestVote to 0: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
23:13:09.460748 [3] sending RequestVote to 1: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1
23:13:09.463278 [1] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:09.463361 [1] ... term out of date in RequestVote
23:13:09.463278 [2] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:09.463379 [1] becomes Follower with term=1; log=[]
23:13:09.463390 [2] ... term out of date in RequestVote
23:13:09.463414 [2] becomes Follower with term=1; log=[]
23:13:09.463417 [0] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:09.463490 [0] ... term out of date in RequestVote
23:13:09.463511 [0] becomes Follower with term=1; log=[]
23:13:09.463594 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:09.463692 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:09.463749 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:09.463597 [4] RequestVote: Term:1 CandidateId:3 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:09.463807 [4] ... term out of date in RequestVote
23:13:09.463831 [4] becomes Follower with term=1; log=[]
23:13:09.464056 [0] election timer started (263ms), term=1
23:13:09.464047 [1] election timer started (266ms), term=1
23:13:09.464067 [4] ... RequestVote reply: Term:1 VoteGranted:true
23:13:09.464148 [2] election timer started (235ms), term=1
23:13:09.466941 [4] election timer started (222ms), term=1
23:13:09.468009 [3] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:09 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:09.468147 [3] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:09 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:09.468240 [3] wins election with 3 votes
23:13:09.468265 [3] becomes Leader; term=1, nextIndex=map[0:0 1:0 2:0 4:0], matchIndex=map[0:-1 1:-1 2:-1 4:-1]; log=[]
23:13:09.468390 [3] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:09 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:09.468371 [3] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.468479 [3] while waiting for reply, state = LEADER
23:13:09.468636 [3] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.468707 [3] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.468618 [3] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.468814 [3] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:09 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:09.468924 [3] while waiting for reply, state = LEADER
23:13:09.469431 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.469592 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.469652 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.469772 [0] in election timer term changed from 0 to 1, bailing out
23:13:09.469809 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.471149 [3] in election timer state=LEADER, bailing out
23:13:09.471224 [2] in election timer term changed from 0 to 1, bailing out
23:13:09.471512 [1] in election timer term changed from 0 to 1, bailing out
23:13:09.472171 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.472394 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.472854 [4] in election timer term changed from 0 to 1, bailing out
23:13:09.473229 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.473267 [3] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.473345 [3] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.473401 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.474244 [3] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.474743 [3] AppendEntries reply from 2 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.518638 [3] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.518648 [3] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.518651 [3] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.518658 [3] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.519599 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.519653 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.519600 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.519868 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.519874 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.519986 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.519866 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.520090 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.522789 [3] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.523488 [3] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.523564 [3] AppendEntries reply from 2 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.523669 [3] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.568864 [3] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.568881 [3] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.568864 [3] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.568864 [3] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.569955 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.569955 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.569957 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.569957 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:09.570253 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.570262 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.570392 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.570252 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.571318 [3] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.573213 [3] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.573350 [3] AppendEntries reply from 4 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.573460 [3] AppendEntries reply from 2 success: nextIndex := map[0:0 1:0 2:0 4:0], matchIndex := map[0:-1 1:-1 2:-1 4:-1]; commitIndex := -1
23:13:09.600974 [3] Submit received by LEADER: 5
23:13:09.601297 [3] ... log=[{5 1}]
23:13:09.601352 [3] Submit received by LEADER: 6
23:13:09.601515 [3] ... log=[{5 1} {6 1}]
23:13:09.601632 [3] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.601718 [3] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.601929 [3] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.601695 [3] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.602038 [3] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.602481 [3] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.602807 [3] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.603317 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.603500 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:09.603598 [1] ... log is now: [{5 1} {6 1}]
23:13:09.603780 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.604017 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.604092 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.604102 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.604203 [4] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:09.604226 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:09.604274 [4] ... log is now: [{5 1} {6 1}]
23:13:09.604302 [2] ... log is now: [{5 1} {6 1}]
23:13:09.604345 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.604459 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.604540 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.604999 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.605291 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.603374 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.606277 [0] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:09.606374 [0] ... log is now: [{5 1} {6 1}]
23:13:09.606276 [3] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.606560 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.608843 [3] AppendEntries reply from 1 success: nextIndex := map[0:0 1:2 2:0 4:0], matchIndex := map[0:-1 1:1 2:-1 4:-1]; commitIndex := -1
23:13:09.608840 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.609099 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.609030 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:09.609174 [3] AppendEntries reply from 2 success: nextIndex := map[0:0 1:2 2:2 4:0], matchIndex := map[0:-1 1:1 2:1 4:-1]; commitIndex := 1
23:13:09.609240 [3] leader sets commitIndex := 1
23:13:09.609263 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.609290 [3] sending AppendEntries to 4: ni=0, args=Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:1
23:13:09.609567 [3] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:09.609621 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:0], matchIndex := map[0:1 1:1 2:1 4:-1]; commitIndex := 1
23:13:09.609693 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.609858 [TEST] collectCommits(3) got {Command:5 Index:0 Term:1}
23:13:09.609901 [TEST] collectCommits(3) got {Command:6 Index:1 Term:1}
23:13:09.609870 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.610260 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.610348 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.610385 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.610438 [1] ... setting commitIndex=1
23:13:09.610454 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.610505 [0] ... setting commitIndex=1
23:13:09.610568 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.610713 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.610760 [2] ... setting commitIndex=1
23:13:09.610877 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.610864 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.610927 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.611080 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.611910 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.612120 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:09.612227 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:09.612263 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:09.612220 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:09.612308 [3] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.612631 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:1
23:13:09.613450 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:09.613501 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:09.613469 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:09.613556 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:09.613516 [4] ... setting commitIndex=1
23:13:09.613781 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.613648 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:09.613968 [4] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:09.613974 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.614068 [TEST] collectCommits(4) got {Command:5 Index:0 Term:1}
23:13:09.614205 [TEST] collectCommits(4) got {Command:6 Index:1 Term:1}
23:13:09.614433 [3] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.615370 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.615462 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.659738 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.659691 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.659713 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.659697 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.660592 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.660592 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.660600 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.660593 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.660856 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.660854 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.660866 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.661737 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.663774 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.663908 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.664053 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.664151 [3] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.710052 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.710052 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.710052 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.710064 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.710978 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.711046 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.711081 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.710978 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.711246 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.711281 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.711297 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.711402 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.712354 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.712975 [3] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.713047 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.713107 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.760466 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.760463 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.760463 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.760479 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.761465 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.761463 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.761581 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.761747 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.761766 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.761804 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.761764 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.763878 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.764968 [3] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.765351 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.765521 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.766063 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.810925 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.811109 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.810960 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.810908 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.812230 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.812327 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.812578 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.812587 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.812816 [4] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.812892 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.813138 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.812606 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:09.814089 [3] AppendEntries reply from 4 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.814238 [3] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.814852 [3] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.814987 [3] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 4:2], matchIndex := map[0:1 1:1 2:1 4:1]; commitIndex := 1
23:13:09.851796 [TEST] Disconnect 3
23:13:09.861252 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.861247 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.861246 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.861414 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:09.863396 [3] Submit received by LEADER: 7
23:13:09.863752 [3] ... log=[{5 1} {6 1} {7 1}]
23:13:09.863893 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.863902 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.863947 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.863908 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.914986 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.914926 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.914915 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.914969 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.965108 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.965132 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.965112 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:09.965106 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.015317 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.015213 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.015448 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.015645 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.037324 [4] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
23:13:10.037470 [4] election timer started (259ms), term=2
23:13:10.037462 [4] sending RequestVote to 0: Term:2 CandidateId:4 LastLogIndex:1 LastLogTerm:1
23:13:10.037536 [4] sending RequestVote to 1: Term:2 CandidateId:4 LastLogIndex:1 LastLogTerm:1
23:13:10.037560 [4] sending RequestVote to 3: Term:2 CandidateId:4 LastLogIndex:1 LastLogTerm:1
23:13:10.037457 [4] sending RequestVote to 2: Term:2 CandidateId:4 LastLogIndex:1 LastLogTerm:1
23:13:10.038874 [0] RequestVote: Term:2 CandidateId:4 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=3, log index/term=(1, 1)]
23:13:10.038946 [0] ... term out of date in RequestVote
23:13:10.038921 [2] RequestVote: Term:2 CandidateId:4 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=3, log index/term=(1, 1)]
23:13:10.038876 [1] RequestVote: Term:2 CandidateId:4 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=3, log index/term=(1, 1)]
23:13:10.038981 [2] ... term out of date in RequestVote
23:13:10.038973 [0] becomes Follower with term=2; log=[{5 1} {6 1}]
23:13:10.038990 [1] ... term out of date in RequestVote
23:13:10.039004 [2] becomes Follower with term=2; log=[{5 1} {6 1}]
23:13:10.039036 [1] becomes Follower with term=2; log=[{5 1} {6 1}]
23:13:10.039199 [0] ... RequestVote reply: Term:2 VoteGranted:true
23:13:10.039228 [1] ... RequestVote reply: Term:2 VoteGranted:true
23:13:10.039265 [0] election timer started (279ms), term=2
23:13:10.039198 [2] ... RequestVote reply: Term:2 VoteGranted:true
23:13:10.039429 [1] election timer started (290ms), term=2
23:13:10.039437 [2] election timer started (269ms), term=2
23:13:10.040688 [4] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:10 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:10.040779 [4] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:10 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:10.040847 [4] wins election with 3 votes
23:13:10.040867 [4] becomes Leader; term=2, nextIndex=map[0:2 1:2 2:2 3:2], matchIndex=map[0:-1 1:-1 2:-1 3:-1]; log=[{5 1} {6 1}]
23:13:10.041033 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.041032 [4] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.041047 [4] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:10 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:10.041134 [4] while waiting for reply, state = LEADER
23:13:10.041178 [4] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.041284 [4] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.041916 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.041973 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.042345 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.043048 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.043026 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.043241 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.043897 [4] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 3:2], matchIndex := map[0:1 1:-1 2:-1 3:-1]; commitIndex := 1
23:13:10.044026 [4] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 3:2], matchIndex := map[0:1 1:1 2:-1 3:-1]; commitIndex := 1
23:13:10.044121 [0] in election timer term changed from 1 to 2, bailing out
23:13:10.044162 [1] in election timer term changed from 1 to 2, bailing out
23:13:10.044241 [4] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 3:2], matchIndex := map[0:1 1:1 2:1 3:-1]; commitIndex := 1
23:13:10.045393 [2] in election timer term changed from 1 to 2, bailing out
23:13:10.047855 [4] in election timer state=LEADER, bailing out
23:13:10.065899 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.065887 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.065934 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.065965 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.091216 [4] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.091228 [4] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.091205 [4] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.091282 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.092085 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.092087 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.092327 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.092332 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:10.092401 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.092577 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.093952 [4] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:2 3:2], matchIndex := map[0:1 1:1 2:1 3:-1]; commitIndex := 1
23:13:10.094225 [4] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2 2:2 3:2], matchIndex := map[0:1 1:1 2:1 3:-1]; commitIndex := 1
23:13:10.094396 [4] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2 2:2 3:2], matchIndex := map[0:1 1:1 2:1 3:-1]; commitIndex := 1
23:13:10.114368 [4] Submit received by LEADER: 8
23:13:10.114709 [4] ... log=[{5 1} {6 1} {8 2}]
23:13:10.114834 [4] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:10.115099 [4] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:10.114927 [4] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:10.115553 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:10.115953 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.116011 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.116124 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.116183 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.116291 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:10.116407 [2] ... inserting entries [Command:8 Term:2] from index 2
23:13:10.116455 [2] ... log is now: [{5 1} {6 1} {8 2}]
23:13:10.116658 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.116593 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:10.116786 [0] ... inserting entries [Command:8 Term:2] from index 2
23:13:10.116839 [0] ... log is now: [{5 1} {6 1} {8 2}]
23:13:10.117024 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.117480 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:10.117605 [1] ... inserting entries [Command:8 Term:2] from index 2
23:13:10.117655 [1] ... log is now: [{5 1} {6 1} {8 2}]
23:13:10.117836 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.118268 [4] AppendEntries reply from 2 success: nextIndex := map[0:2 1:2 2:3 3:2], matchIndex := map[0:1 1:1 2:2 3:-1]; commitIndex := 1
23:13:10.118369 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:2 2:3 3:2], matchIndex := map[0:2 1:1 2:2 3:-1]; commitIndex := 2
23:13:10.118457 [4] leader sets commitIndex := 2
23:13:10.118515 [4] commitChanSender entries=[{8 2}], savedLastApplied=1
23:13:10.118552 [TEST] collectCommits(4) got {Command:8 Index:2 Term:2}
23:13:10.118530 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.118519 [4] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.118605 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.118751 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.119153 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.119218 [2] ... setting commitIndex=2
23:13:10.119249 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.119434 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.119477 [2] commitChanSender entries=[{8 2}], savedLastApplied=1
23:13:10.119528 [TEST] collectCommits(2) got {Command:8 Index:2 Term:2}
23:13:10.119677 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.119797 [1] ... setting commitIndex=2
23:13:10.120033 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.120138 [1] commitChanSender entries=[{8 2}], savedLastApplied=1
23:13:10.120175 [TEST] collectCommits(1) got {Command:8 Index:2 Term:2}
23:13:10.120560 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.120626 [0] ... setting commitIndex=2
23:13:10.120819 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.120985 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.121078 [0] commitChanSender entries=[{8 2}], savedLastApplied=1
23:13:10.121114 [TEST] collectCommits(0) got {Command:8 Index:2 Term:2}
23:13:10.121427 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.122990 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.166141 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.166131 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.166131 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.166155 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.168913 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.168933 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.168914 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.168963 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.169747 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.169747 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.169751 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.170037 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.170037 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.170038 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.170978 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.171529 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.171609 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.216408 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.216437 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.216392 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.216393 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.219305 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.219333 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.219309 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.219370 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.220083 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.220083 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.220083 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.220370 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.220370 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.220373 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.222085 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.222180 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.222250 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.267319 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.267269 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.267282 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.267388 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.269706 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.269693 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.269736 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.269718 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.271009 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.271009 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.271009 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.271462 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.271502 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.271641 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.274354 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.275336 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.275579 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.317469 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.317469 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.317487 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.317516 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.319736 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.319788 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.319757 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.319818 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.320600 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.320609 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.320617 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.320876 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.320874 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.320878 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.322033 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.322551 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.322773 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.365407 [TEST] Reconnect 3
23:13:10.367775 [3] sending AppendEntries to 2: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.367807 [3] sending AppendEntries to 1: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.367765 [3] sending AppendEntries to 4: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.367796 [3] sending AppendEntries to 0: ni=2, args=Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.369917 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.370127 [1] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.370230 [0] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.370451 [1] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:13:10.370501 [0] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:13:10.370814 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.370969 [2] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.372174 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.372512 [2] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:13:10.372626 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.372961 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.373379 [4] AppendEntries: Term:1 LeaderId:3 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:7 Term:1} LeaderCommit:1
23:13:10.373616 [4] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:13:10.374228 [4] sending AppendEntries to 3: ni=2, args=Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.376614 [3] term out of date in heartbeat reply
23:13:10.376750 [3] becomes Follower with term=2; log=[{5 1} {6 1} {7 1}]
23:13:10.376814 [3] election timer started (229ms), term=2
23:13:10.376907 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.377019 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.377149 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.377212 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.378127 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.378279 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:10.379087 [3] ... inserting entries [Command:8 Term:2] from index 2
23:13:10.379141 [3] ... log is now: [{5 1} {6 1} {8 2}]
23:13:10.379176 [3] ... setting commitIndex=2
23:13:10.379322 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.379489 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.379560 [3] commitChanSender entries=[{8 2}], savedLastApplied=1
23:13:10.379593 [TEST] collectCommits(3) got {Command:8 Index:2 Term:2}
23:13:10.379737 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:2], matchIndex := map[0:2 1:2 2:2 3:-1]; commitIndex := 2
23:13:10.380403 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.420069 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.420040 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.420022 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.420027 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.421073 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.421107 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.421203 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.421388 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.421410 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.421425 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.421070 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.422267 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.423949 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.424195 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.424882 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.424960 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.470107 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.470134 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.470117 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.470120 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.471232 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.471245 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.471232 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.471536 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.471573 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.471533 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.471643 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.471949 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.473549 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.473766 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.473881 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.474663 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.520248 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.520255 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.520247 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.520282 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.521949 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.521952 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.522073 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.522002 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.522354 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.522369 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.522354 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.522354 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.524309 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.524397 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.524478 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.524552 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.570359 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.570372 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.570369 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.570408 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.571967 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.572162 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.572295 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.572330 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.572516 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.572572 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.572762 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.572850 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.577162 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.577256 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.577326 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.577464 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.620455 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.620455 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.620460 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.620455 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.621522 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.621611 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.621843 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.621859 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.622090 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.621843 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.621544 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.622905 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.623917 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.624048 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.624135 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.624382 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.670634 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.670715 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.670634 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.670671 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.672156 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.672250 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.672381 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.672591 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.672606 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.672235 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.672725 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.672835 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.676661 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.676925 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.677144 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.677481 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.720777 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.720777 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.720792 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.720777 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.721907 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.721928 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.722193 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.722238 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.722490 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.722192 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.721904 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.722888 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.724395 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.724555 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.724638 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.724717 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.771055 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.771134 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.771053 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.771213 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.772553 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.772553 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.772788 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.773026 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.773022 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.773078 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.773191 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.773502 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.775684 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.775992 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.776757 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.776997 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.821284 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.821466 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.821332 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.821291 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.822549 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.822559 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.822549 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.822836 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.822904 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.822836 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.823214 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.823613 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.824158 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.824377 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.824601 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.824969 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.871556 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.871562 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.871538 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.871538 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.872536 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.872585 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.872824 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.872778 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.872878 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.872828 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.873019 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.873102 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.874727 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.874807 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.874930 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.875005 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.921822 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.921847 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.921822 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.921823 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.923704 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.923678 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.924072 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.924081 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.924059 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.924077 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:10.924400 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.924442 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.926543 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.926647 [4] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.926894 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.927617 [4] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3 2:3 3:3], matchIndex := map[0:2 1:2 2:2 3:2]; commitIndex := 2
23:13:10.966567 [4] Submit received by LEADER: 9
23:13:10.966844 [4] ... log=[{5 1} {6 1} {8 2} {9 2}]
23:13:10.967025 [4] sending AppendEntries to 3: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.966998 [4] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.967093 [4] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.967005 [4] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.968021 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.968045 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.968077 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.968084 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:10.968153 [0] ... inserting entries [Command:9 Term:2] from index 3
23:13:10.968164 [2] ... inserting entries [Command:9 Term:2] from index 3
23:13:10.968182 [1] ... inserting entries [Command:9 Term:2] from index 3
23:13:10.968189 [3] ... inserting entries [Command:9 Term:2] from index 3
23:13:10.968212 [2] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
23:13:10.968231 [1] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
23:13:10.968209 [0] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
23:13:10.968237 [3] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
23:13:10.968451 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.968458 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.968513 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.968450 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.970259 [4] AppendEntries reply from 3 success: nextIndex := map[0:3 1:3 2:3 3:4], matchIndex := map[0:2 1:2 2:2 3:3]; commitIndex := 2
23:13:10.970351 [4] AppendEntries reply from 2 success: nextIndex := map[0:3 1:3 2:4 3:4], matchIndex := map[0:2 1:2 2:3 3:3]; commitIndex := 3
23:13:10.970419 [4] leader sets commitIndex := 3
23:13:10.970484 [4] AppendEntries reply from 0 success: nextIndex := map[0:4 1:3 2:4 3:4], matchIndex := map[0:3 1:2 2:3 3:3]; commitIndex := 3
23:13:10.970575 [4] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:10.970684 [4] commitChanSender entries=[{9 2}], savedLastApplied=2
23:13:10.970655 [4] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.970714 [4] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.970758 [TEST] collectCommits(4) got {Command:9 Index:3 Term:2}
23:13:10.970901 [4] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.971060 [4] sending AppendEntries to 3: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.971300 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.971373 [2] ... setting commitIndex=3
23:13:10.971564 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.971591 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.971661 [3] ... setting commitIndex=3
23:13:10.971860 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.971874 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.972147 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:10.972224 [1] ... setting commitIndex=3
23:13:10.972442 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.974122 [2] commitChanSender entries=[{9 2}], savedLastApplied=2
23:13:10.974139 [1] commitChanSender entries=[{9 2}], savedLastApplied=2
23:13:10.974170 [TEST] collectCommits(2) got {Command:9 Index:3 Term:2}
23:13:10.974170 [4] AppendEntries reply from 3 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:10.974252 [3] commitChanSender entries=[{9 2}], savedLastApplied=2
23:13:10.974295 [TEST] collectCommits(3) got {Command:9 Index:3 Term:2}
23:13:10.971641 [0] ... setting commitIndex=3
23:13:10.974481 [TEST] collectCommits(1) got {Command:9 Index:3 Term:2}
23:13:10.974662 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:10.974655 [4] AppendEntries reply from 2 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:10.974768 [0] commitChanSender entries=[{9 2}], savedLastApplied=2
23:13:10.975492 [TEST] collectCommits(0) got {Command:9 Index:3 Term:2}
23:13:10.976023 [4] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:10.976554 [4] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.020679 [4] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.020679 [4] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.020689 [4] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.020709 [4] sending AppendEntries to 3: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.021880 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.021933 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.021968 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.022193 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.022197 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.022510 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.022769 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.022195 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.023649 [4] AppendEntries reply from 3 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.024240 [4] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.024755 [4] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.024828 [4] AppendEntries reply from 2 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.070864 [4] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.070865 [4] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.070895 [4] sending AppendEntries to 3: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.070865 [4] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.071886 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.071904 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.072065 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.072188 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.072188 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.072225 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.072291 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.072798 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.075523 [4] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.075614 [4] AppendEntries reply from 3 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.075908 [4] AppendEntries reply from 2 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.076310 [4] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.121096 [4] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.121119 [4] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.121056 [4] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.121077 [4] sending AppendEntries to 3: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.122259 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.122260 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.122581 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.122260 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.122816 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.122816 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.122841 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.122591 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.126024 [4] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.126124 [4] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.126196 [4] AppendEntries reply from 3 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.126421 [4] AppendEntries reply from 2 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.171367 [4] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.171593 [4] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.171398 [4] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.171366 [4] sending AppendEntries to 3: ni=4, args=Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.173062 [0] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.173107 [2] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.173159 [1] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.173409 [3] AppendEntries: Term:2 LeaderId:4 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:11.173558 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.173590 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.173559 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.173828 [3] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:11.174849 [4] AppendEntries reply from 2 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.174947 [4] AppendEntries reply from 3 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.175608 [4] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.175699 [4] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4 2:4 3:4], matchIndex := map[0:3 1:3 2:3 3:3]; commitIndex := 3
23:13:11.219619 [0] CM.Stop called
23:13:11.219690 [0] becomes Dead
23:13:11.219753 [0] commitChanSender done
23:13:11.219856 Received quit signal. Shutting down...
23:13:11.219974 Listener close error: close tcp [::]:54386: use of closed network connection
23:13:11.220036 [0] CraftServer terminated!
23:13:11.220083 [1] CM.Stop called
23:13:11.220104 [1] becomes Dead
23:13:11.220137 [1] commitChanSender done
23:13:11.220187 Received quit signal. Shutting down...
23:13:11.220280 Listener close error: close tcp [::]:54387: use of closed network connection
23:13:11.220316 [1] CraftServer terminated!
23:13:11.220348 [2] CM.Stop called
23:13:11.220373 [2] becomes Dead
23:13:11.220398 [2] commitChanSender done
23:13:11.220445 Received quit signal. Shutting down...
23:13:11.220503 Listener close error: close tcp [::]:54388: use of closed network connection
23:13:11.220547 [2] CraftServer terminated!
23:13:11.220577 [3] CM.Stop called
23:13:11.220596 [3] becomes Dead
23:13:11.220622 [3] commitChanSender done
23:13:11.220668 Received quit signal. Shutting down...
23:13:11.220721 Listener close error: close tcp [::]:54389: use of closed network connection
23:13:11.220760 [3] CraftServer terminated!
23:13:11.220789 [4] CM.Stop called
23:13:11.220816 [4] becomes Dead
23:13:11.220841 [4] commitChanSender done
23:13:11.220877 Received quit signal. Shutting down...
23:13:11.220981 Listener close error: close tcp [::]:54390: use of closed network connection
23:13:11.221054 [4] CraftServer terminated!
23:13:11.227538 [3] in election timer state=DEAD, bailing out
23:13:11.229613 [2] in election timer state=DEAD, bailing out
23:13:11.229635 [0] in election timer state=DEAD, bailing out
23:13:11.229676 [1] in election timer state=DEAD, bailing out
--- PASS: TestCommitsWithLeaderDisconnects (1.98s)
=== RUN   TestCrashFollower
23:13:11.276802 [0] listening at [::]:54409
23:13:11.277236 [1] listening at [::]:54410
23:13:11.277633 [2] listening at [::]:54411
23:13:11.277916 [2] election timer started (254ms), term=0
23:13:11.277926 [1] election timer started (151ms), term=0
23:13:11.277927 [0] election timer started (276ms), term=0
23:13:11.429037 [1] becomes Candidate (currentTerm=1); log=[]
23:13:11.429248 [1] election timer started (266ms), term=1
23:13:11.429222 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:11.429220 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:11.431540 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:11.431540 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:11.431629 [0] ... term out of date in RequestVote
23:13:11.431645 [2] ... term out of date in RequestVote
23:13:11.431649 [0] becomes Follower with term=1; log=[]
23:13:11.431669 [2] becomes Follower with term=1; log=[]
23:13:11.431872 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:11.431870 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:11.431961 [0] election timer started (156ms), term=1
23:13:11.432059 [2] election timer started (184ms), term=1
23:13:11.433680 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:11 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:11.433802 [1] wins election with 2 votes
23:13:11.433831 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:13:11.433909 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:11 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:11.434010 [1] while waiting for reply, state = LEADER
23:13:11.434054 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.434201 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.434933 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.434989 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.435147 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.435209 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.438074 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:11.438155 [2] in election timer term changed from 0 to 1, bailing out
23:13:11.438279 [0] in election timer term changed from 0 to 1, bailing out
23:13:11.438299 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:11.439510 [1] in election timer state=LEADER, bailing out
23:13:11.484193 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.484182 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.485321 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.485321 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.485687 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.485688 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.488245 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:11.488649 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:11.534461 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.534478 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.536051 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.536059 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:11.536432 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.536430 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.537430 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:11.537521 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:11.580158 [1] Submit received by LEADER: 5
23:13:11.580663 [1] ... log=[{5 1}]
23:13:11.580845 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:11.580828 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:11.582321 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:11.582325 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:11.582476 [2] ... inserting entries [Command:5 Term:1] from index 0
23:13:11.582497 [0] ... inserting entries [Command:5 Term:1] from index 0
23:13:11.582533 [2] ... log is now: [{5 1}]
23:13:11.582547 [0] ... log is now: [{5 1}]
23:13:11.582728 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.582729 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.585546 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:0], matchIndex := map[0:0 2:-1]; commitIndex := 0
23:13:11.585621 [1] leader sets commitIndex := 0
23:13:11.585671 [1] commitChanSender entries=[{5 1}], savedLastApplied=-1
23:13:11.585688 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.585738 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:11.585753 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.585794 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.586653 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.586653 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.586758 [2] ... setting commitIndex=0
23:13:11.586729 [0] ... setting commitIndex=0
23:13:11.586934 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.586953 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.587017 [2] commitChanSender entries=[{5 1}], savedLastApplied=-1
23:13:11.587080 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:11.587253 [0] commitChanSender entries=[{5 1}], savedLastApplied=-1
23:13:11.587309 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:11.588605 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.588670 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.636242 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.636229 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.637253 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.637255 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.637567 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.637570 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.640547 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.641024 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.686734 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.686734 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.688265 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.688265 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.688711 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.688711 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.689660 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.689742 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.737204 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.737204 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.738226 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.738226 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.738527 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.738527 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.740277 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.740353 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.787763 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.787764 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.789236 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.789235 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.789733 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.789730 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.792064 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.792145 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.838448 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.838448 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.840062 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.840061 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.840449 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.840453 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.842255 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.842338 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.889146 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.889163 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.890609 [2] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.890613 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.891063 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.891077 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.892550 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.893832 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.931620 [TEST] Crash 2
23:13:11.931681 [TEST] Disconnect 2
23:13:11.932018 [2] CM.Stop called
23:13:11.932050 [2] becomes Dead
23:13:11.932073 [2] commitChanSender done
23:13:11.932139 [2] in election timer state=DEAD, bailing out
23:13:11.932207 Received quit signal. Shutting down...
23:13:11.932305 Listener close error: close tcp [::]:54411: use of closed network connection
23:13:11.932351 [2] CraftServer terminated!
23:13:11.940145 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.940156 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.941239 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.941553 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.943247 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:11.991120 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.991121 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.992753 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:11.993257 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:11.996502 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:12.042184 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.042175 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.043796 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.044268 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.045296 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:12.093250 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.093250 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.094804 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.095251 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.096248 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:12.143261 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.143258 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.144403 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.144706 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.146302 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:12.193365 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.193365 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.195024 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.195452 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.197527 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:12.243468 [1] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.243467 [1] sending AppendEntries to 2: ni=1, args=Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.245068 [0] AppendEntries: Term:1 LeaderId:1 PrevLogTerm:1
23:13:12.245404 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.246382 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := 0
23:13:12.283651 [0] CM.Stop called
23:13:12.283746 [0] becomes Dead
23:13:12.283923 [0] commitChanSender done
23:13:12.284159 Received quit signal. Shutting down...
23:13:12.284371 Listener close error: close tcp [::]:54409: use of closed network connection
23:13:12.284450 [0] CraftServer terminated!
23:13:12.284509 [1] CM.Stop called
23:13:12.284550 [1] becomes Dead
23:13:12.284619 [1] commitChanSender done
23:13:12.284714 Received quit signal. Shutting down...
23:13:12.284804 Listener close error: close tcp [::]:54410: use of closed network connection
23:13:12.284876 [1] CraftServer terminated!
23:13:12.293087 [0] in election timer state=DEAD, bailing out
--- PASS: TestCrashFollower (1.06s)
=== RUN   TestCrashThenRestartFollower
23:13:12.339654 [0] listening at [::]:54414
23:13:12.340102 [1] listening at [::]:54415
23:13:12.340490 [2] listening at [::]:54416
23:13:12.340789 [2] election timer started (245ms), term=0
23:13:12.340784 [0] election timer started (264ms), term=0
23:13:12.340778 [1] election timer started (192ms), term=0
23:13:12.541974 [1] becomes Candidate (currentTerm=1); log=[]
23:13:12.542182 [1] election timer started (181ms), term=1
23:13:12.542154 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:12.542153 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:12.545155 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:12.545176 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:12.545267 [2] ... term out of date in RequestVote
23:13:12.545282 [0] ... term out of date in RequestVote
23:13:12.545289 [2] becomes Follower with term=1; log=[]
23:13:12.545310 [0] becomes Follower with term=1; log=[]
23:13:12.545526 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:12.545526 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:12.545625 [2] election timer started (202ms), term=1
23:13:12.545810 [0] election timer started (281ms), term=1
23:13:12.547280 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:12 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:12.547399 [1] wins election with 2 votes
23:13:12.547425 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:13:12.547603 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:12 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:12.547705 [1] while waiting for reply, state = LEADER
23:13:12.547713 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.547740 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.548573 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.548572 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.548796 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.548828 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.550908 [0] in election timer term changed from 0 to 1, bailing out
23:13:12.550889 [2] in election timer term changed from 0 to 1, bailing out
23:13:12.551564 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:12.551641 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:12.552658 [1] in election timer state=LEADER, bailing out
23:13:12.597929 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.597929 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.599011 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.599013 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:12.599306 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.599305 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.601150 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:12.601229 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:12.642640 [1] Submit received by LEADER: 5
23:13:12.643028 [1] ... log=[{5 1}]
23:13:12.643097 [1] Submit received by LEADER: 6
23:13:12.643366 [1] ... log=[{5 1} {6 1}]
23:13:12.643501 [1] Submit received by LEADER: 7
23:13:12.643796 [1] ... log=[{5 1} {6 1} {7 1}]
23:13:12.643985 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.644033 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.644315 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.643981 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.644384 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.645506 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.645703 [0] ... inserting entries [Command:5 Term:1 Command:6 Term:1 Command:7 Term:1] from index 0
23:13:12.645825 [0] ... log is now: [{5 1} {6 1} {7 1}]
23:13:12.645931 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.646113 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1 Command:7 Term:1] from index 0
23:13:12.646258 [2] ... log is now: [{5 1} {6 1} {7 1}]
23:13:12.646444 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.643963 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.646069 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.646729 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.647860 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.646924 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.649307 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:3], matchIndex := map[0:-1 2:2]; commitIndex := 2
23:13:12.649375 [1] leader sets commitIndex := 2
23:13:12.649374 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.649443 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:2
23:13:12.649767 [1] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:12.649844 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.649783 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.650061 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.650462 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:12.650512 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:12.650564 [TEST] collectCommits(1) got {Command:7 Index:2 Term:1}
23:13:12.650945 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.651022 [2] ... setting commitIndex=2
23:13:12.651179 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.651124 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:2
23:13:12.651273 [0] ... setting commitIndex=2
23:13:12.652219 [2] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:12.652502 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.652494 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.652802 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:12.652630 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.652987 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.652947 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:12.653115 [0] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:12.654490 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.654699 [TEST] collectCommits(2) got {Command:7 Index:2 Term:1}
23:13:12.654740 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:12.654796 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:12.654821 [TEST] collectCommits(0) got {Command:7 Index:2 Term:1}
23:13:12.654701 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:12.655063 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.655985 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.656045 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.656091 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.700021 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.700021 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.701082 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.701079 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.701413 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.701412 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.702431 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.703088 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.750613 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.750584 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.752148 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.752148 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.752670 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.752670 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.755101 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.755173 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.800657 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.800666 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.801674 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.801679 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.802009 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.802010 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.803224 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.804133 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.851289 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.851289 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.853043 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.853044 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.853530 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.853531 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.854928 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.855014 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.901864 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.901991 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.903137 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.903137 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.903546 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.903733 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.904648 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.905204 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.952696 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.952696 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.954201 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.954201 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:12.954708 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.954714 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:12.956855 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.956945 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:12.994991 [TEST] Crash 2
23:13:12.995063 [TEST] Disconnect 2
23:13:12.995431 [2] CM.Stop called
23:13:12.995457 [2] becomes Dead
23:13:12.995487 [2] commitChanSender done
23:13:12.995544 Received quit signal. Shutting down...
23:13:12.995647 Listener close error: close tcp [::]:54416: use of closed network connection
23:13:12.995707 [2] CraftServer terminated!
23:13:12.995725 [2] in election timer state=DEAD, bailing out
23:13:13.003542 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.003562 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.004669 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.005015 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.006014 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.054486 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.054486 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.056125 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.056651 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.057663 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.105467 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.105468 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.106754 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.107102 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.108007 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.156320 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.156321 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.156908 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.157036 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.157909 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.206953 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.206953 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.207406 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.207545 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.207983 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.256959 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.256956 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.257496 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.257664 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.258225 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.307029 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.307028 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.307834 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.308103 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.309680 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.345871 [TEST] Restart 2
23:13:13.347403 [2] listening at [::]:54424
23:13:13.347444 [TEST] Reconnect 2
23:13:13.348076 [2] election timer started (299ms), term=1
23:13:13.357062 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.357071 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.357836 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.358102 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.358193 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.358259 [2] ... setting commitIndex=2
23:13:13.358411 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.358462 [2] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:13.358530 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:13.358562 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:13.358587 [TEST] collectCommits(2) got {Command:7 Index:2 Term:1}
23:13:13.359458 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.359654 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.407183 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.407184 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.408107 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.408106 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.408394 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.408398 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.409383 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.409908 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.457323 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.457323 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.458683 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.458683 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.459088 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.459086 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.460006 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.460082 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.507437 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.507414 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.508802 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.508804 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.509268 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.509295 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.512165 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.512242 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.562058 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.561864 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.571854 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.572225 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.572207 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.573374 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.575976 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.576436 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.608838 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.608841 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.609312 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.609312 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.609425 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.609427 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.610634 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.610741 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.659112 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.659112 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.659621 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.659621 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.659755 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.659757 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.660510 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.660553 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.709235 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.709250 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.709828 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.709994 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.710040 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.710188 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.710668 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.710811 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.759298 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.759298 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.760052 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.760052 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.760305 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.760311 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.762583 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.762660 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.809415 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.809422 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.810610 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.810611 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.810993 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.811013 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.812036 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.812523 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.859403 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.859397 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.860724 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.860725 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.861140 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.861142 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.862852 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.862929 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.909488 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.909478 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.910929 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.910953 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.911430 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.911454 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.912623 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.913256 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.959560 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.959560 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.960953 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.960974 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:13.961356 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.961361 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:13.962261 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:13.963042 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:14.009674 [1] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.009674 [1] sending AppendEntries to 2: ni=3, args=Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.011610 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.011880 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.013015 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.013017 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.014660 [1] AppendEntries reply from 2 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:14.014735 [1] AppendEntries reply from 0 success: nextIndex := map[0:3 2:3], matchIndex := map[0:2 2:2]; commitIndex := 2
23:13:14.018995 [0] CM.Stop called
23:13:14.019024 [0] becomes Dead
23:13:14.019050 [0] commitChanSender done
23:13:14.019090 Received quit signal. Shutting down...
23:13:14.019215 Listener close error: close tcp [::]:54414: use of closed network connection
23:13:14.019271 [0] CraftServer terminated!
23:13:14.019301 [1] CM.Stop called
23:13:14.019323 [1] becomes Dead
23:13:14.019351 [1] commitChanSender done
23:13:14.019383 Received quit signal. Shutting down...
23:13:14.019460 Listener close error: close tcp [::]:54415: use of closed network connection
23:13:14.019496 [1] CraftServer terminated!
23:13:14.019527 [2] CM.Stop called
23:13:14.019553 [2] becomes Dead
23:13:14.019578 [2] commitChanSender done
23:13:14.019612 Received quit signal. Shutting down...
23:13:14.019678 Listener close error: close tcp [::]:54424: use of closed network connection
23:13:14.019725 [2] CraftServer terminated!
23:13:14.026836 [0] in election timer state=DEAD, bailing out
23:13:14.029144 [2] in election timer state=DEAD, bailing out
--- PASS: TestCrashThenRestartFollower (1.73s)
=== RUN   TestCrashThenRestartLeader
23:13:14.073729 [0] listening at [::]:54426
23:13:14.075436 [1] listening at [::]:54427
23:13:14.075829 [2] listening at [::]:54428
23:13:14.076147 [0] election timer started (287ms), term=0
23:13:14.076219 [1] election timer started (267ms), term=0
23:13:14.076167 [2] election timer started (183ms), term=0
23:13:14.267358 [2] becomes Candidate (currentTerm=1); log=[]
23:13:14.267555 [2] election timer started (214ms), term=1
23:13:14.267523 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:14.267535 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:14.269990 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:14.269990 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:14.270157 [0] ... term out of date in RequestVote
23:13:14.270181 [1] ... term out of date in RequestVote
23:13:14.270198 [0] becomes Follower with term=1; log=[]
23:13:14.270217 [1] becomes Follower with term=1; log=[]
23:13:14.270566 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:14.270565 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:14.270724 [1] election timer started (165ms), term=1
23:13:14.270774 [0] election timer started (156ms), term=1
23:13:14.272520 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:14 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:14.272656 [2] wins election with 2 votes
23:13:14.272688 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:14.272766 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:14 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:14.272865 [2] while waiting for reply, state = LEADER
23:13:14.272904 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.272922 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.273792 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.273792 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.274414 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.274712 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.276759 [1] in election timer term changed from 0 to 1, bailing out
23:13:14.276885 [0] in election timer term changed from 0 to 1, bailing out
23:13:14.277068 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:14.277619 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:14.277792 [2] in election timer state=LEADER, bailing out
23:13:14.323019 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.323028 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.324011 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.324027 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.324257 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.324257 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.326563 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:14.326642 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:14.373321 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.373309 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.374724 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.374724 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:14.375158 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.375161 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.376092 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:14.376175 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:14.377315 [2] Submit received by LEADER: 5
23:13:14.377544 [2] ... log=[{5 1}]
23:13:14.377588 [2] Submit received by LEADER: 6
23:13:14.377735 [2] ... log=[{5 1} {6 1}]
23:13:14.377773 [2] Submit received by LEADER: 7
23:13:14.377924 [2] ... log=[{5 1} {6 1} {7 1}]
23:13:14.378006 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.378020 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.378057 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.378023 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.378248 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.378612 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.379859 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.380042 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1 Command:7 Term:1] from index 0
23:13:14.380168 [1] ... log is now: [{5 1} {6 1} {7 1}]
23:13:14.380380 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.380791 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.381098 [0] ... inserting entries [Command:5 Term:1 Command:6 Term:1 Command:7 Term:1] from index 0
23:13:14.381196 [0] ... log is now: [{5 1} {6 1} {7 1}]
23:13:14.381133 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.382200 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.383620 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.383571 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.383944 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.384105 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.384546 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.385908 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:3], matchIndex := map[0:-1 1:2]; commitIndex := 2
23:13:14.385969 [2] leader sets commitIndex := 2
23:13:14.386126 [2] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:14.386023 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:2
23:13:14.386374 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:3], matchIndex := map[0:-1 1:2]; commitIndex := 2
23:13:14.386393 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:14.386448 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:14.386475 [TEST] collectCommits(2) got {Command:7 Index:2 Term:1}
23:13:14.386427 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.386760 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:3], matchIndex := map[0:-1 1:2]; commitIndex := 2
23:13:14.386816 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.386933 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:14.387065 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.387073 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.387124 [1] ... setting commitIndex=2
23:13:14.387159 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.387247 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.387324 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:2
23:13:14.388110 [0] ... setting commitIndex=2
23:13:14.388261 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.388020 [1] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:14.388345 [0] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:14.388406 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:14.388443 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:14.388474 [TEST] collectCommits(0) got {Command:7 Index:2 Term:1}
23:13:14.388496 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:14.388533 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:14.388558 [TEST] collectCommits(1) got {Command:7 Index:2 Term:1}
23:13:14.388595 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.389994 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.390144 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.436748 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.436752 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.437646 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.437637 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.437910 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.437906 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.439480 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.439544 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.487433 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.487423 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.488554 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.488554 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.488919 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.488922 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.491269 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.491344 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.538242 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.538262 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.539732 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.539748 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.540231 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.540236 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.541451 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.542138 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.589076 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.589076 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.590476 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.590489 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.590952 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.590955 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.593378 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.593460 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.640013 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.640010 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.640952 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.640961 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.641281 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.641280 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.644675 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.645117 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.691088 [2] sending AppendEntries to 1: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.691102 [2] sending AppendEntries to 0: ni=3, args=Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.692534 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.692535 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.693016 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.693020 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:14.695319 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.695408 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := 2
23:13:14.728972 [TEST] Crash 2
23:13:14.729058 [TEST] Disconnect 2
23:13:14.729713 [2] CM.Stop called
23:13:14.729763 [2] becomes Dead
23:13:14.729824 [2] commitChanSender done
23:13:14.729903 Received quit signal. Shutting down...
23:13:14.730077 Listener close error: close tcp [::]:54428: use of closed network connection
23:13:14.730172 [2] CraftServer terminated!
23:13:14.852302 [0] becomes Candidate (currentTerm=2); log=[{5 1} {6 1} {7 1}]
23:13:14.852561 [0] sending RequestVote to 1: Term:2 LastLogIndex:2 LastLogTerm:1
23:13:14.852823 [0] election timer started (240ms), term=2
23:13:14.852633 [0] sending RequestVote to 2: Term:2 LastLogIndex:2 LastLogTerm:1
23:13:14.854856 [1] RequestVote: Term:2 LastLogIndex:2 LastLogTerm:1 [currentTerm=1, votedFor=2, log index/term=(2, 1)]
23:13:14.854940 [1] ... term out of date in RequestVote
23:13:14.854961 [1] becomes Follower with term=2; log=[{5 1} {6 1} {7 1}]
23:13:14.855229 [1] ... RequestVote reply: Term:2 VoteGranted:true
23:13:14.855331 [1] election timer started (183ms), term=2
23:13:14.856911 [0] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:14 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:14.857037 [0] wins election with 2 votes
23:13:14.857063 [0] becomes Leader; term=2, nextIndex=map[1:3 2:3], matchIndex=map[1:-1 2:-1]; log=[{5 1} {6 1} {7 1}]
23:13:14.857179 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.857192 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.857833 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.858059 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:14.859688 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:-1]; commitIndex := 2
23:13:14.861038 [1] in election timer term changed from 1 to 2, bailing out
23:13:14.863274 [0] in election timer state=LEADER, bailing out
23:13:14.907405 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.907408 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.908411 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.908800 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:14.909794 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:-1]; commitIndex := 2
23:13:14.957599 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.957599 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.959133 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:14.959637 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:14.962625 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:-1]; commitIndex := 2
23:13:15.007913 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.007913 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.009440 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.009909 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.010804 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:-1]; commitIndex := 2
23:13:15.058124 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.058124 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.059163 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.059497 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.060400 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:-1]; commitIndex := 2
23:13:15.080435 [TEST] Restart 2
23:13:15.081473 [2] listening at [::]:54437
23:13:15.081515 [TEST] Reconnect 2
23:13:15.081703 [2] election timer started (170ms), term=1
23:13:15.108455 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.108456 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.109701 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.110180 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.110377 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.110470 [2] ... term out of date in AppendEntries
23:13:15.110496 [2] becomes Follower with term=2; log=[{5 1} {6 1} {7 1}]
23:13:15.110589 [2] ... setting commitIndex=2
23:13:15.110836 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.111011 [2] election timer started (152ms), term=2
23:13:15.111110 [2] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:15.111210 [TEST] collectCommits(2) got {Command:5 Index:0 Term:2}
23:13:15.111258 [TEST] collectCommits(2) got {Command:6 Index:1 Term:2}
23:13:15.111302 [TEST] collectCommits(2) got {Command:7 Index:2 Term:2}
23:13:15.112018 [2] in election timer term changed from 1 to 2, bailing out
23:13:15.112322 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:-1]; commitIndex := 2
23:13:15.112652 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.158832 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.158826 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.160012 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.160011 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.160399 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.160405 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.162843 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.163464 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.209292 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.209292 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.210822 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.210812 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.211439 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.211450 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.213061 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.213653 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.259746 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.259746 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.261198 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.261278 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.261700 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.261699 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.263622 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.263703 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.310309 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.310303 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.311825 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.311825 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.312288 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.312288 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.313242 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.313326 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.360681 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.360702 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.361764 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.361764 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.362067 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.362066 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.364869 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.364955 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.411454 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.411470 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.413057 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.413057 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.413565 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.413561 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.414660 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.415115 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.461904 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.461904 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.463388 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.463396 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.463915 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.463915 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.464972 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.465515 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.511983 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.511961 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.513444 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.513443 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.514003 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.514001 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.515295 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.515866 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.561981 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.561981 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.563175 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.563175 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.563721 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.563745 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.564613 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.564693 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.612125 [0] sending AppendEntries to 1: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.612125 [0] sending AppendEntries to 2: ni=3, args=Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.613728 [2] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.613730 [1] AppendEntries: Term:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:15.614054 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.614052 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:15.615037 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.615699 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:15.652584 [0] CM.Stop called
23:13:15.652635 [0] becomes Dead
23:13:15.652664 [0] commitChanSender done
23:13:15.652727 Received quit signal. Shutting down...
23:13:15.652845 Listener close error: close tcp [::]:54426: use of closed network connection
23:13:15.652956 [0] CraftServer terminated!
23:13:15.652996 [1] CM.Stop called
23:13:15.653015 [1] becomes Dead
23:13:15.653052 [1] commitChanSender done
23:13:15.653154 Received quit signal. Shutting down...
23:13:15.653192 Listener close error: close tcp [::]:54427: use of closed network connection
23:13:15.653231 [1] CraftServer terminated!
23:13:15.653261 [2] CM.Stop called
23:13:15.653282 [2] becomes Dead
23:13:15.653307 [2] commitChanSender done
23:13:15.653402 Received quit signal. Shutting down...
23:13:15.653495 Listener close error: close tcp [::]:54437: use of closed network connection
23:13:15.653540 [2] CraftServer terminated!
23:13:15.655550 [1] in election timer state=DEAD, bailing out
23:13:15.661849 [2] in election timer state=DEAD, bailing out
--- PASS: TestCrashThenRestartLeader (1.63s)
=== RUN   TestCrashThenRestartAll
23:13:15.708095 [0] listening at [::]:54439
23:13:15.708597 [1] listening at [::]:54440
23:13:15.709018 [2] listening at [::]:54441
23:13:15.709321 [0] election timer started (242ms), term=0
23:13:15.709314 [1] election timer started (259ms), term=0
23:13:15.709342 [2] election timer started (277ms), term=0
23:13:15.960553 [0] becomes Candidate (currentTerm=1); log=[]
23:13:15.960753 [0] election timer started (178ms), term=1
23:13:15.960751 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:15.960744 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:15.963028 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:15.963118 [2] ... term out of date in RequestVote
23:13:15.963027 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:15.963138 [2] becomes Follower with term=1; log=[]
23:13:15.963164 [1] ... term out of date in RequestVote
23:13:15.963185 [1] becomes Follower with term=1; log=[]
23:13:15.963361 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:15.963363 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:15.963440 [2] election timer started (155ms), term=1
23:13:15.963518 [1] election timer started (227ms), term=1
23:13:15.966233 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:15 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:15.966366 [0] wins election with 2 votes
23:13:15.966398 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:13:15.966498 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:15 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:15.966642 [0] while waiting for reply, state = LEADER
23:13:15.966680 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:15.966733 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:15.967548 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:15.967551 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:15.967759 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:15.967759 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:15.970088 [1] in election timer term changed from 0 to 1, bailing out
23:13:15.970173 [2] in election timer term changed from 0 to 1, bailing out
23:13:15.970650 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:15.971442 [0] in election timer state=LEADER, bailing out
23:13:15.971642 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:16.010869 [0] Submit received by LEADER: 5
23:13:16.011183 [0] ... log=[{5 1}]
23:13:16.011235 [0] Submit received by LEADER: 6
23:13:16.011491 [0] ... log=[{5 1} {6 1}]
23:13:16.011541 [0] Submit received by LEADER: 7
23:13:16.011698 [0] ... log=[{5 1} {6 1} {7 1}]
23:13:16.011820 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.011959 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.011911 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.013463 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.013703 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1 Command:7 Term:1] from index 0
23:13:16.013461 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.013860 [1] ... log is now: [{5 1} {6 1} {7 1}]
23:13:16.013895 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1 Command:7 Term:1] from index 0
23:13:16.013972 [2] ... log is now: [{5 1} {6 1} {7 1}]
23:13:16.014047 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.014134 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.014075 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.013922 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.014673 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.014985 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.015423 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.015546 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:0], matchIndex := map[1:2 2:-1]; commitIndex := 2
23:13:16.015603 [0] leader sets commitIndex := 2
23:13:16.015628 [0] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:16.015683 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.015680 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:16.015722 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:16.015749 [TEST] collectCommits(0) got {Command:7 Index:2 Term:1}
23:13:16.011812 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.015756 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.018170 [0] sending AppendEntries to 1: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.018169 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.018375 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.018433 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.018603 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} Entries:{Command:7 Term:1} LeaderCommit:-1
23:13:16.018771 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.018816 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.018833 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.019096 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.019147 [2] ... setting commitIndex=2
23:13:16.019199 [1] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.019246 [1] ... setting commitIndex=2
23:13:16.019261 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.019334 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.019360 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.019476 [2] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:16.019488 [1] commitChanSender entries=[{5 1} {6 1} {7 1}], savedLastApplied=-1
23:13:16.019540 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:16.019629 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:16.019665 [TEST] collectCommits(2) got {Command:7 Index:2 Term:1}
23:13:16.019701 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:16.019809 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:16.019835 [TEST] collectCommits(1) got {Command:7 Index:2 Term:1}
23:13:16.020405 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.020514 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.021438 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.066023 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.066023 [0] sending AppendEntries to 1: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.066913 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.066913 [1] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.067188 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.067194 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.068023 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.068580 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.116269 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.116271 [0] sending AppendEntries to 1: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.117255 [1] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.117256 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.117554 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.117554 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.120170 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.120252 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.166602 [0] sending AppendEntries to 1: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.166586 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.167792 [1] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.167792 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.168180 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.168180 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.170249 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.170332 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.216900 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.216909 [0] sending AppendEntries to 1: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.218348 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.218350 [1] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.218838 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.218835 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.221672 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.221754 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.267266 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.267267 [0] sending AppendEntries to 1: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.268787 [1] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.268788 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.269247 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.269247 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.271003 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.271088 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.317740 [0] sending AppendEntries to 1: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.317728 [0] sending AppendEntries to 2: ni=3, args=Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.318694 [2] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.318700 [1] AppendEntries: Term:1 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:2
23:13:16.318993 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.318996 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:16.321804 [0] AppendEntries reply from 2 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.322222 [0] AppendEntries reply from 1 success: nextIndex := map[1:3 2:3], matchIndex := map[1:2 2:2]; commitIndex := 2
23:13:16.362988 [TEST] Crash 0
23:13:16.363063 [TEST] Disconnect 0
23:13:16.363950 [0] CM.Stop called
23:13:16.363995 [0] becomes Dead
23:13:16.364034 [0] commitChanSender done
23:13:16.364093 Received quit signal. Shutting down...
23:13:16.364209 Listener close error: close tcp [::]:54439: use of closed network connection
23:13:16.364264 [0] CraftServer terminated!
23:13:16.364295 [TEST] Crash 1
23:13:16.364320 [TEST] Disconnect 1
23:13:16.364433 [1] CM.Stop called
23:13:16.364464 [1] becomes Dead
23:13:16.364500 [1] commitChanSender done
23:13:16.364559 Received quit signal. Shutting down...
23:13:16.364641 Listener close error: close tcp [::]:54440: use of closed network connection
23:13:16.364686 [1] CraftServer terminated!
23:13:16.364723 [TEST] Crash 2
23:13:16.364756 [TEST] Disconnect 2
23:13:16.364800 [2] CM.Stop called
23:13:16.364830 [2] becomes Dead
23:13:16.364868 [2] commitChanSender done
23:13:16.364924 Received quit signal. Shutting down...
23:13:16.364972 Listener close error: close tcp [::]:54441: use of closed network connection
23:13:16.365012 [2] CraftServer terminated!
23:13:16.374174 [2] in election timer state=DEAD, bailing out
23:13:16.374193 [1] in election timer state=DEAD, bailing out
23:13:16.716125 [TEST] Restart 0
23:13:16.718075 [0] listening at [::]:54448
23:13:16.718154 [TEST] Reconnect 0
23:13:16.718241 [0] election timer started (292ms), term=1
23:13:16.739279 [TEST] Restart 1
23:13:16.740201 [1] listening at [::]:54449
23:13:16.740235 [TEST] Reconnect 1
23:13:16.740355 [1] election timer started (183ms), term=1
23:13:16.760533 [TEST] Restart 2
23:13:16.761500 [2] listening at [::]:54450
23:13:16.761552 [TEST] Reconnect 2
23:13:16.761722 [2] election timer started (157ms), term=1
23:13:16.921997 [2] becomes Candidate (currentTerm=2); log=[{5 1} {6 1} {7 1}]
23:13:16.922221 [2] election timer started (249ms), term=2
23:13:16.922216 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogIndex:2 LastLogTerm:1
23:13:16.922244 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogIndex:2 LastLogTerm:1
23:13:16.924515 [0] RequestVote: Term:2 CandidateId:2 LastLogIndex:2 LastLogTerm:1 [currentTerm=1, votedFor=0, log index/term=(2, 1)]
23:13:16.924515 [1] RequestVote: Term:2 CandidateId:2 LastLogIndex:2 LastLogTerm:1 [currentTerm=1, votedFor=0, log index/term=(2, 1)]
23:13:16.924615 [0] ... term out of date in RequestVote
23:13:16.924635 [1] ... term out of date in RequestVote
23:13:16.924662 [0] becomes Follower with term=2; log=[{5 1} {6 1} {7 1}]
23:13:16.924685 [1] becomes Follower with term=2; log=[{5 1} {6 1} {7 1}]
23:13:16.924934 [0] ... RequestVote reply: Term:2 VoteGranted:true
23:13:16.924933 [1] ... RequestVote reply: Term:2 VoteGranted:true
23:13:16.925017 [0] election timer started (296ms), term=2
23:13:16.925075 [1] election timer started (299ms), term=2
23:13:16.926756 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:16 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:16.926876 [2] wins election with 2 votes
23:13:16.926904 [2] becomes Leader; term=2, nextIndex=map[0:3 1:3], matchIndex=map[0:-1 1:-1]; log=[{5 1} {6 1} {7 1}]
23:13:16.926996 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:16 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:16.927095 [2] while waiting for reply, state = LEADER
23:13:16.927141 [2] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:-1
23:13:16.927388 [2] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:-1
23:13:16.928093 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:-1
23:13:16.928192 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 LeaderCommit:-1
23:13:16.928355 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.928389 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.928678 [0] in election timer term changed from 1 to 2, bailing out
23:13:16.930042 [2] AppendEntries reply from 1 success: nextIndex := map[0:3 1:3], matchIndex := map[0:-1 1:2]; commitIndex := -1
23:13:16.930120 [2] AppendEntries reply from 0 success: nextIndex := map[0:3 1:3], matchIndex := map[0:2 1:2]; commitIndex := -1
23:13:16.930529 [1] in election timer term changed from 1 to 2, bailing out
23:13:16.932312 [2] Submit received by LEADER: 8
23:13:16.932547 [2] ... log=[{5 1} {6 1} {7 1} {8 2}]
23:13:16.932722 [2] in election timer state=LEADER, bailing out
23:13:16.932761 [2] sending AppendEntries to 0: ni=3, args=Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:-1
23:13:16.932718 [2] sending AppendEntries to 1: ni=3, args=Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:-1
23:13:16.933455 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:-1
23:13:16.933456 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:2 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:-1
23:13:16.933560 [0] ... inserting entries [Command:8 Term:2] from index 3
23:13:16.933567 [1] ... inserting entries [Command:8 Term:2] from index 3
23:13:16.933605 [0] ... log is now: [{5 1} {6 1} {7 1} {8 2}]
23:13:16.933612 [1] ... log is now: [{5 1} {6 1} {7 1} {8 2}]
23:13:16.933791 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.933796 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.936309 [2] AppendEntries reply from 0 success: nextIndex := map[0:4 1:3], matchIndex := map[0:3 1:2]; commitIndex := 3
23:13:16.936383 [2] leader sets commitIndex := 3
23:13:16.936422 [2] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:16.936480 [2] commitChanSender entries=[{5 1} {6 1} {7 1} {8 2}], savedLastApplied=-1
23:13:16.936564 [TEST] collectCommits(2) got {Command:5 Index:0 Term:2}
23:13:16.936527 [2] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.936600 [TEST] collectCommits(2) got {Command:6 Index:1 Term:2}
23:13:16.936538 [2] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.936637 [TEST] collectCommits(2) got {Command:7 Index:2 Term:2}
23:13:16.936712 [TEST] collectCommits(2) got {Command:8 Index:3 Term:2}
23:13:16.937128 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.937215 [1] ... setting commitIndex=3
23:13:16.937147 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.937261 [0] ... setting commitIndex=3
23:13:16.937391 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.937434 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.937449 [1] commitChanSender entries=[{5 1} {6 1} {7 1} {8 2}], savedLastApplied=-1
23:13:16.937496 [0] commitChanSender entries=[{5 1} {6 1} {7 1} {8 2}], savedLastApplied=-1
23:13:16.937535 [TEST] collectCommits(1) got {Command:5 Index:0 Term:2}
23:13:16.937596 [TEST] collectCommits(1) got {Command:6 Index:1 Term:2}
23:13:16.937721 [TEST] collectCommits(1) got {Command:7 Index:2 Term:2}
23:13:16.937804 [TEST] collectCommits(1) got {Command:8 Index:3 Term:2}
23:13:16.937858 [TEST] collectCommits(0) got {Command:5 Index:0 Term:2}
23:13:16.937893 [TEST] collectCommits(0) got {Command:6 Index:1 Term:2}
23:13:16.937948 [TEST] collectCommits(0) got {Command:7 Index:2 Term:2}
23:13:16.937985 [TEST] collectCommits(0) got {Command:8 Index:3 Term:2}
23:13:16.938238 [2] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:16.938841 [2] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:16.986559 [2] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.986552 [2] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.987472 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.987473 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:16.987744 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.987759 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:16.988635 [2] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:16.989208 [2] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:17.036737 [2] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.036737 [2] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.038112 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.038110 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.038642 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.038640 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.039828 [2] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:17.040442 [2] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:17.086804 [2] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.086804 [2] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.087736 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.087735 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.087990 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.087997 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.088873 [2] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:17.089339 [2] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:17.136950 [2] sending AppendEntries to 0: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.136947 [2] sending AppendEntries to 1: ni=4, args=Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.137899 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.137899 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.138203 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.138206 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.141962 [2] AppendEntries reply from 0 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:17.142044 [2] AppendEntries reply from 1 success: nextIndex := map[0:4 1:4], matchIndex := map[0:3 1:3]; commitIndex := 3
23:13:17.184281 [0] CM.Stop called
23:13:17.184337 [0] becomes Dead
23:13:17.184392 [0] commitChanSender done
23:13:17.184457 Received quit signal. Shutting down...
23:13:17.184613 Listener close error: close tcp [::]:54448: use of closed network connection
23:13:17.184681 [0] CraftServer terminated!
23:13:17.184720 [1] CM.Stop called
23:13:17.184753 [1] becomes Dead
23:13:17.184792 [1] commitChanSender done
23:13:17.184849 Received quit signal. Shutting down...
23:13:17.184929 Listener close error: close tcp [::]:54449: use of closed network connection
23:13:17.184978 [1] CraftServer terminated!
23:13:17.185023 [2] CM.Stop called
23:13:17.185053 [2] becomes Dead
23:13:17.185088 [2] commitChanSender done
23:13:17.185114 [0] in election timer state=DEAD, bailing out
23:13:17.185170 [1] in election timer state=DEAD, bailing out
23:13:17.185174 Received quit signal. Shutting down...
23:13:17.185218 Listener close error: close tcp [::]:54450: use of closed network connection
23:13:17.185275 [2] CraftServer terminated!
--- PASS: TestCrashThenRestartAll (1.53s)
=== RUN   TestReplaceMultipleLogEntries
23:13:17.238105 [0] listening at [::]:54454
23:13:17.238738 [1] listening at [::]:54455
23:13:17.239147 [2] listening at [::]:54456
23:13:17.239418 [2] election timer started (174ms), term=0
23:13:17.239433 [1] election timer started (236ms), term=0
23:13:17.239430 [0] election timer started (165ms), term=0
23:13:17.410571 [0] becomes Candidate (currentTerm=1); log=[]
23:13:17.410754 [0] election timer started (243ms), term=1
23:13:17.410762 [0] sending RequestVote to 2: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:17.410742 [0] sending RequestVote to 1: Term:1 LastLogIndex:-1 LastLogTerm:-1
23:13:17.413575 [1] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:17.413746 [1] ... term out of date in RequestVote
23:13:17.413784 [1] becomes Follower with term=1; log=[]
23:13:17.413875 [2] RequestVote: Term:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:17.414885 [2] ... term out of date in RequestVote
23:13:17.414925 [2] becomes Follower with term=1; log=[]
23:13:17.414999 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:17.415102 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:17.415155 [1] election timer started (203ms), term=1
23:13:17.415193 [2] election timer started (275ms), term=1
23:13:17.417644 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:17 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:17.417766 [0] wins election with 2 votes
23:13:17.417791 [0] becomes Leader; term=1, nextIndex=map[1:0 2:0], matchIndex=map[1:-1 2:-1]; log=[]
23:13:17.417877 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.417893 [0] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:17 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:17.417997 [0] while waiting for reply, state = LEADER
23:13:17.417892 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.418437 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.418513 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.418629 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.418706 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.419786 [1] in election timer term changed from 0 to 1, bailing out
23:13:17.419822 [2] in election timer term changed from 0 to 1, bailing out
23:13:17.420720 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:17.421299 [0] in election timer state=LEADER, bailing out
23:13:17.421651 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:17.468190 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.468175 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.468980 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.468981 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.469211 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.469215 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.470068 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:17.470677 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:17.518482 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.518483 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.519604 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.519604 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:17.519947 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.519945 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.522899 [0] AppendEntries reply from 1 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:17.522994 [0] AppendEntries reply from 2 success: nextIndex := map[1:0 2:0], matchIndex := map[1:-1 2:-1]; commitIndex := -1
23:13:17.541218 [0] Submit received by LEADER: 5
23:13:17.541507 [0] ... log=[{5 1}]
23:13:17.541557 [0] Submit received by LEADER: 6
23:13:17.541725 [0] ... log=[{5 1} {6 1}]
23:13:17.541861 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.541824 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.541939 [0] sending AppendEntries to 1: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.542923 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.542962 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.543075 [1] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:17.543103 [2] ... inserting entries [Command:5 Term:1 Command:6 Term:1] from index 0
23:13:17.543146 [1] ... log is now: [{5 1} {6 1}]
23:13:17.543171 [2] ... log is now: [{5 1} {6 1}]
23:13:17.543349 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.543354 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.543629 [1] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.543890 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.541823 [0] sending AppendEntries to 2: ni=0, args=Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.547084 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:0], matchIndex := map[1:1 2:-1]; commitIndex := 1
23:13:17.547156 [0] leader sets commitIndex := 1
23:13:17.547189 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.547245 [0] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:17.547307 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.547315 [TEST] collectCommits(0) got {Command:5 Index:0 Term:1}
23:13:17.547373 [TEST] collectCommits(0) got {Command:6 Index:1 Term:1}
23:13:17.547343 [2] AppendEntries: Term:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} Entries:{Command:6 Term:1} LeaderCommit:-1
23:13:17.547409 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.547387 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.547623 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.548019 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.548020 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.548081 [1] ... setting commitIndex=1
23:13:17.548089 [2] ... setting commitIndex=1
23:13:17.548236 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.548256 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.548245 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.548299 [2] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:17.548302 [1] commitChanSender entries=[{5 1} {6 1}], savedLastApplied=-1
23:13:17.548347 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:17.548384 [TEST] collectCommits(2) got {Command:6 Index:1 Term:1}
23:13:17.548409 [TEST] collectCommits(1) got {Command:5 Index:0 Term:1}
23:13:17.548446 [TEST] collectCommits(1) got {Command:6 Index:1 Term:1}
23:13:17.548840 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.549420 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.597363 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.597371 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.598317 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.598317 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.598601 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.598596 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.599534 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.600375 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.647572 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.647583 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.648700 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.648712 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.649165 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.649163 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.650796 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.652206 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.697762 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.697775 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.698634 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.698637 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.698921 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.698920 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.700439 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.700510 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.748127 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.748105 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.750089 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.750100 [2] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.750269 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.750266 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:17.750832 [0] AppendEntries reply from 1 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.751611 [0] AppendEntries reply from 2 success: nextIndex := map[1:2 2:2], matchIndex := map[1:1 2:1]; commitIndex := 1
23:13:17.792641 [TEST] Disconnect 0
23:13:17.798536 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.798515 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.803874 [0] Submit received by LEADER: 21
23:13:17.804787 [0] ... log=[{5 1} {6 1} {21 1}]
23:13:17.804993 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} LeaderCommit:1
23:13:17.804990 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} LeaderCommit:1
23:13:17.810319 [0] Submit received by LEADER: 22
23:13:17.810820 [0] ... log=[{5 1} {6 1} {21 1} {22 1}]
23:13:17.810965 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} LeaderCommit:1
23:13:17.811009 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} LeaderCommit:1
23:13:17.815954 [0] Submit received by LEADER: 23
23:13:17.816187 [0] ... log=[{5 1} {6 1} {21 1} {22 1} {23 1}]
23:13:17.816297 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} LeaderCommit:1
23:13:17.816281 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} LeaderCommit:1
23:13:17.821922 [0] Submit received by LEADER: 24
23:13:17.822226 [0] ... log=[{5 1} {6 1} {21 1} {22 1} {23 1} {24 1}]
23:13:17.822320 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.822374 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.873267 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.873284 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.923826 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.923819 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.956354 [1] becomes Candidate (currentTerm=2); log=[{5 1} {6 1}]
23:13:17.956553 [1] election timer started (157ms), term=2
23:13:17.956550 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:17.956541 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1
23:13:17.958156 [2] RequestVote: Term:2 CandidateId:1 LastLogIndex:1 LastLogTerm:1 [currentTerm=1, votedFor=0, log index/term=(1, 1)]
23:13:17.958251 [2] ... term out of date in RequestVote
23:13:17.958274 [2] becomes Follower with term=2; log=[{5 1} {6 1}]
23:13:17.958509 [2] ... RequestVote reply: Term:2 VoteGranted:true
23:13:17.958608 [2] election timer started (230ms), term=2
23:13:17.960151 [1] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:17 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:17.960268 [1] wins election with 2 votes
23:13:17.960299 [1] becomes Leader; term=2, nextIndex=map[0:2 2:2], matchIndex=map[0:-1 2:-1]; log=[{5 1} {6 1}]
23:13:17.960400 [1] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.960406 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.961037 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 LeaderCommit:1
23:13:17.961299 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.964412 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:-1 2:1]; commitIndex := 1
23:13:17.965496 [2] in election timer term changed from 1 to 2, bailing out
23:13:17.966828 [1] in election timer state=LEADER, bailing out
23:13:17.974521 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.974471 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:17.978085 [1] Submit received by LEADER: 8
23:13:17.978345 [1] ... log=[{5 1} {6 1} {8 2}]
23:13:17.978445 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:17.978436 [1] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:17.979447 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:1
23:13:17.979554 [2] ... inserting entries [Command:8 Term:2] from index 2
23:13:17.979603 [2] ... log is now: [{5 1} {6 1} {8 2}]
23:13:17.979768 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.980843 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:3], matchIndex := map[0:-1 2:2]; commitIndex := 2
23:13:17.980933 [1] leader sets commitIndex := 2
23:13:17.980994 [1] commitChanSender entries=[{8 2}], savedLastApplied=1
23:13:17.981051 [TEST] collectCommits(1) got {Command:8 Index:2 Term:2}
23:13:17.981025 [1] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:1 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:17.980995 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} LeaderCommit:2
23:13:17.981662 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:2 PrevLogTerm:2 LeaderCommit:2
23:13:17.981732 [2] ... setting commitIndex=2
23:13:17.981921 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.981982 [2] commitChanSender entries=[{8 2}], savedLastApplied=1
23:13:17.982025 [TEST] collectCommits(2) got {Command:8 Index:2 Term:2}
23:13:17.982651 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:3], matchIndex := map[0:-1 2:2]; commitIndex := 2
23:13:17.983571 [1] Submit received by LEADER: 9
23:13:17.983741 [1] ... log=[{5 1} {6 1} {8 2} {9 2}]
23:13:17.983814 [1] sending AppendEntries to 2: ni=3, args=Term:2 LeaderId:1 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:17.983840 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} LeaderCommit:2
23:13:17.984450 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:2 PrevLogTerm:2 Entries:{Command:9 Term:2} LeaderCommit:2
23:13:17.984547 [2] ... inserting entries [Command:9 Term:2] from index 3
23:13:17.984594 [2] ... log is now: [{5 1} {6 1} {8 2} {9 2}]
23:13:17.984785 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.986061 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:4], matchIndex := map[0:-1 2:3]; commitIndex := 3
23:13:17.986125 [1] leader sets commitIndex := 3
23:13:17.986195 [1] commitChanSender entries=[{9 2}], savedLastApplied=2
23:13:17.986178 [1] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:1 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.986239 [TEST] collectCommits(1) got {Command:9 Index:3 Term:2}
23:13:17.986173 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} LeaderCommit:3
23:13:17.986740 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:3 PrevLogTerm:2 LeaderCommit:3
23:13:17.986829 [2] ... setting commitIndex=3
23:13:17.987001 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.987053 [2] commitChanSender entries=[{9 2}], savedLastApplied=2
23:13:17.987091 [TEST] collectCommits(2) got {Command:9 Index:3 Term:2}
23:13:17.988311 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:4], matchIndex := map[0:-1 2:3]; commitIndex := 3
23:13:17.988848 [1] Submit received by LEADER: 10
23:13:17.989012 [1] ... log=[{5 1} {6 1} {8 2} {9 2} {10 2}]
23:13:17.989087 [1] sending AppendEntries to 2: ni=4, args=Term:2 LeaderId:1 PrevLogIndex:3 PrevLogTerm:2 Entries:{Command:10 Term:2} LeaderCommit:3
23:13:17.989103 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:3
23:13:17.989678 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:3 PrevLogTerm:2 Entries:{Command:10 Term:2} LeaderCommit:3
23:13:17.989778 [2] ... inserting entries [Command:10 Term:2] from index 4
23:13:17.989831 [2] ... log is now: [{5 1} {6 1} {8 2} {9 2} {10 2}]
23:13:17.990012 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.990748 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:5], matchIndex := map[0:-1 2:4]; commitIndex := 4
23:13:17.990804 [1] leader sets commitIndex := 4
23:13:17.990833 [1] commitChanSender entries=[{10 2}], savedLastApplied=3
23:13:17.990864 [TEST] collectCommits(1) got {Command:10 Index:4 Term:2}
23:13:17.990916 [1] sending AppendEntries to 2: ni=5, args=Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:17.990863 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:4
23:13:17.991417 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:17.991491 [2] ... setting commitIndex=4
23:13:17.991645 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:17.991736 [2] commitChanSender entries=[{10 2}], savedLastApplied=3
23:13:17.991775 [TEST] collectCommits(2) got {Command:10 Index:4 Term:2}
23:13:17.992757 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:5], matchIndex := map[0:-1 2:4]; commitIndex := 4
23:13:18.025049 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.025062 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.041095 [1] sending AppendEntries to 2: ni=5, args=Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.041077 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:4
23:13:18.041733 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.041948 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:18.044657 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:5], matchIndex := map[0:-1 2:4]; commitIndex := 4
23:13:18.075517 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.075506 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.091476 [1] sending AppendEntries to 2: ni=5, args=Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.091499 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:4
23:13:18.092432 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.092714 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:18.093520 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:5], matchIndex := map[0:-1 2:4]; commitIndex := 4
23:13:18.126269 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.126265 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.141782 [1] sending AppendEntries to 2: ni=5, args=Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.141780 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:4
23:13:18.142304 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.142438 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:18.142901 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:5], matchIndex := map[0:-1 2:4]; commitIndex := 4
23:13:18.177153 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.177156 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.192064 [1] sending AppendEntries to 2: ni=5, args=Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.192048 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:4
23:13:18.192459 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.192581 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:18.193057 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:5], matchIndex := map[0:-1 2:4]; commitIndex := 4
23:13:18.228117 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.228127 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.239769 [TEST] Crash 1
23:13:18.239790 [TEST] Disconnect 1
23:13:18.239933 [1] CM.Stop called
23:13:18.239951 [1] becomes Dead
23:13:18.239970 [1] commitChanSender done
23:13:18.239995 Received quit signal. Shutting down...
23:13:18.240083 Listener close error: close tcp [::]:54455: use of closed network connection
23:13:18.240114 [1] CraftServer terminated!
23:13:18.279180 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.279202 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.300242 [TEST] Restart 1
23:13:18.301261 [1] listening at [::]:54463
23:13:18.301298 [TEST] Reconnect 1
23:13:18.301486 [1] election timer started (278ms), term=2
23:13:18.329641 [0] sending AppendEntries to 2: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.329639 [0] sending AppendEntries to 1: ni=2, args=Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.331337 [1] AppendEntries: Term:1 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:21 Term:1} Entries:{Command:22 Term:1} Entries:{Command:23 Term:1} Entries:{Command:24 Term:1} LeaderCommit:1
23:13:18.331671 [1] AppendEntries reply: Term:2 Success:%!d(bool=false)
23:13:18.333388 [0] term out of date in heartbeat reply
23:13:18.333412 [0] becomes Follower with term=2; log=[{5 1} {6 1} {21 1} {22 1} {23 1} {24 1}]
23:13:18.333486 [0] election timer started (218ms), term=2
23:13:18.429338 [2] becomes Candidate (currentTerm=3); log=[{5 1} {6 1} {8 2} {9 2} {10 2}]
23:13:18.429570 [2] election timer started (289ms), term=3
23:13:18.429563 [2] sending RequestVote to 1: Term:3 CandidateId:2 LastLogIndex:4 LastLogTerm:2
23:13:18.429587 [2] sending RequestVote to 0: Term:3 CandidateId:2 LastLogIndex:4 LastLogTerm:2
23:13:18.431690 [1] RequestVote: Term:3 CandidateId:2 LastLogIndex:4 LastLogTerm:2 [currentTerm=2, votedFor=1, log index/term=(4, 2)]
23:13:18.431766 [1] ... term out of date in RequestVote
23:13:18.431786 [1] becomes Follower with term=3; log=[{5 1} {6 1} {8 2} {9 2} {10 2}]
23:13:18.432063 [1] ... RequestVote reply: Term:3 VoteGranted:true
23:13:18.432149 [1] election timer started (292ms), term=3
23:13:18.433839 [2] received RequestVoteReply &{Msg:Term:3 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:18 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:18.433960 [2] wins election with 2 votes
23:13:18.433985 [2] becomes Leader; term=3, nextIndex=map[0:5 1:5], matchIndex=map[0:-1 1:-1]; log=[{5 1} {6 1} {8 2} {9 2} {10 2}]
23:13:18.434099 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.434099 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.434724 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.434798 [1] ... setting commitIndex=4
23:13:18.434994 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.435077 [1] commitChanSender entries=[{5 1} {6 1} {8 2} {9 2} {10 2}], savedLastApplied=-1
23:13:18.435271 [TEST] collectCommits(1) got {Command:5 Index:0 Term:3}
23:13:18.435821 [TEST] collectCommits(1) got {Command:6 Index:1 Term:3}
23:13:18.435901 [TEST] collectCommits(1) got {Command:8 Index:2 Term:3}
23:13:18.435932 [TEST] collectCommits(1) got {Command:9 Index:3 Term:3}
23:13:18.436024 [TEST] collectCommits(1) got {Command:10 Index:4 Term:3}
23:13:18.437965 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:-1 1:4]; commitIndex := 4
23:13:18.439984 [2] in election timer state=LEADER, bailing out
23:13:18.441722 [1] in election timer term changed from 2 to 3, bailing out
23:13:18.484263 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.484245 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.485175 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.485471 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.487352 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:-1 1:4]; commitIndex := 4
23:13:18.534427 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.534419 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.535960 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.536408 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.538198 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:-1 1:4]; commitIndex := 4
23:13:18.553737 [0] becomes Candidate (currentTerm=3); log=[{5 1} {6 1} {21 1} {22 1} {23 1} {24 1}]
23:13:18.553903 [0] election timer started (166ms), term=3
23:13:18.553917 [0] sending RequestVote to 2: Term:3 LastLogIndex:5 LastLogTerm:1
23:13:18.553898 [0] sending RequestVote to 1: Term:3 LastLogIndex:5 LastLogTerm:1
23:13:18.554883 [1] RequestVote: Term:3 LastLogIndex:5 LastLogTerm:1 [currentTerm=3, votedFor=2, log index/term=(4, 2)]
23:13:18.555195 [1] ... RequestVote reply: Term:3
23:13:18.557007 [0] received RequestVoteReply &{Msg:Term:3 header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:18 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:18.572965 [TEST] Reconnect 0
23:13:18.584484 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.584479 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.585320 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.585600 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.585759 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.585847 [0] becomes Follower with term=3; log=[{5 1} {6 1} {21 1} {22 1} {23 1} {24 1}]
23:13:18.586075 [0] AppendEntries reply: Term:3 Success:%!d(bool=false)
23:13:18.586140 [0] election timer started (237ms), term=3
23:13:18.586416 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:-1 1:4]; commitIndex := 4
23:13:18.588974 [2] AppendEntries reply from 0 !success: nextIndex := 4
23:13:18.634598 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.634612 [2] sending AppendEntries to 0: ni=2, args=Term:3 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:4
23:13:18.636083 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.636079 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:1 PrevLogTerm:1 Entries:{Command:8 Term:2} Entries:{Command:9 Term:2} Entries:{Command:10 Term:2} LeaderCommit:4
23:13:18.636334 [0] ... inserting entries [Command:8 Term:2 Command:9 Term:2 Command:10 Term:2] from index 2
23:13:18.636428 [0] ... log is now: [{5 1} {6 1} {8 2} {9 2} {10 2}]
23:13:18.636470 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.636488 [0] ... setting commitIndex=4
23:13:18.636683 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.636774 [0] commitChanSender entries=[{8 2} {9 2} {10 2}], savedLastApplied=1
23:13:18.636841 [TEST] collectCommits(0) got {Command:8 Index:2 Term:3}
23:13:18.636884 [TEST] collectCommits(0) got {Command:9 Index:3 Term:3}
23:13:18.636927 [TEST] collectCommits(0) got {Command:10 Index:4 Term:3}
23:13:18.637468 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:5], matchIndex := map[0:-1 1:4]; commitIndex := 4
23:13:18.637551 [2] AppendEntries reply from 0 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.684689 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.684693 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.686075 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.686083 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.686556 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.686592 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.688566 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.688643 [2] AppendEntries reply from 0 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.734828 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.734828 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.736232 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.736231 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.736744 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.736751 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.740817 [2] AppendEntries reply from 0 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.740895 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.784924 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.784919 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.785838 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.785837 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.786159 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.786160 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.787960 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.788049 [2] AppendEntries reply from 0 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.835121 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.835128 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.836550 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.836551 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.837006 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.837007 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.839868 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.839962 [2] AppendEntries reply from 0 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.885293 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.885285 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.886755 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.886760 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.887228 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.887232 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.888241 [2] AppendEntries reply from 0 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.888853 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.935429 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.935429 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.936365 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.936364 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 LeaderCommit:4
23:13:18.936655 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.936656 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.937542 [2] AppendEntries reply from 1 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.938338 [2] AppendEntries reply from 0 success: nextIndex := map[0:5 1:5], matchIndex := map[0:4 1:4]; commitIndex := 4
23:13:18.973262 [2] Submit received by LEADER: 11
23:13:18.973687 [2] ... log=[{5 1} {6 1} {8 2} {9 2} {10 2} {11 3}]
23:13:18.973829 [2] sending AppendEntries to 0: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 Entries:{Command:11 Term:3} LeaderCommit:4
23:13:18.973867 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 Entries:{Command:11 Term:3} LeaderCommit:4
23:13:18.974967 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 Entries:{Command:11 Term:3} LeaderCommit:4
23:13:18.975219 [0] ... inserting entries [Command:11 Term:3] from index 5
23:13:18.975273 [0] ... log is now: [{5 1} {6 1} {8 2} {9 2} {10 2} {11 3}]
23:13:18.975274 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 Entries:{Command:11 Term:3} LeaderCommit:4
23:13:18.975398 [1] ... inserting entries [Command:11 Term:3] from index 5
23:13:18.975446 [1] ... log is now: [{5 1} {6 1} {8 2} {9 2} {10 2} {11 3}]
23:13:18.975501 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.975653 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.977718 [2] AppendEntries reply from 0 success: nextIndex := map[0:6 1:5], matchIndex := map[0:5 1:4]; commitIndex := 5
23:13:18.977798 [2] leader sets commitIndex := 5
23:13:18.977876 [2] commitChanSender entries=[{11 3}], savedLastApplied=4
23:13:18.977923 [TEST] collectCommits(2) got {Command:11 Index:5 Term:3}
23:13:18.977881 [2] sending AppendEntries to 1: ni=5, args=Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 Entries:{Command:11 Term:3} LeaderCommit:5
23:13:18.977973 [2] sending AppendEntries to 0: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:18.978574 [2] AppendEntries reply from 1 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:18.978560 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:18.978655 [0] ... setting commitIndex=5
23:13:18.978840 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.978775 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:4 PrevLogTerm:2 Entries:{Command:11 Term:3} LeaderCommit:5
23:13:18.978902 [1] ... setting commitIndex=5
23:13:18.978922 [0] commitChanSender entries=[{11 3}], savedLastApplied=4
23:13:18.978964 [TEST] collectCommits(0) got {Command:11 Index:5 Term:3}
23:13:18.979363 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:18.979432 [1] commitChanSender entries=[{11 3}], savedLastApplied=4
23:13:18.979484 [TEST] collectCommits(1) got {Command:11 Index:5 Term:3}
23:13:18.979885 [2] AppendEntries reply from 0 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:18.980884 [2] AppendEntries reply from 1 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.028150 [2] sending AppendEntries to 1: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.028159 [2] sending AppendEntries to 0: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.029335 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.029352 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.029704 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.029703 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.031861 [2] AppendEntries reply from 1 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.031945 [2] AppendEntries reply from 0 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.078320 [2] sending AppendEntries to 1: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.078320 [2] sending AppendEntries to 0: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.079005 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.079005 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.079200 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.079201 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.081736 [2] AppendEntries reply from 0 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.081955 [2] AppendEntries reply from 1 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.128635 [2] sending AppendEntries to 1: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.128652 [2] sending AppendEntries to 0: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.129330 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.129331 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.129516 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.129526 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.130097 [2] AppendEntries reply from 0 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.130217 [2] AppendEntries reply from 1 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.178970 [2] sending AppendEntries to 0: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.179010 [2] sending AppendEntries to 1: ni=6, args=Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.180119 [0] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.180144 [1] AppendEntries: Term:3 LeaderId:2 PrevLogIndex:5 PrevLogTerm:3 LeaderCommit:5
23:13:19.180637 [1] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.180667 [0] AppendEntries reply: Term:3 Success:%!d(bool=true)
23:13:19.181988 [2] AppendEntries reply from 1 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.182862 [2] AppendEntries reply from 0 success: nextIndex := map[0:6 1:6], matchIndex := map[0:5 1:5]; commitIndex := 5
23:13:19.224602 [0] CM.Stop called
23:13:19.224660 [0] becomes Dead
23:13:19.224705 [0] commitChanSender done
23:13:19.224767 Received quit signal. Shutting down...
23:13:19.224892 Listener close error: close tcp [::]:54454: use of closed network connection
23:13:19.224962 [0] CraftServer terminated!
23:13:19.225010 [1] CM.Stop called
23:13:19.225057 [1] becomes Dead
23:13:19.225106 [1] commitChanSender done
23:13:19.225183 Received quit signal. Shutting down...
23:13:19.225248 Listener close error: close tcp [::]:54463: use of closed network connection
23:13:19.225304 [1] CraftServer terminated!
23:13:19.225360 [2] CM.Stop called
23:13:19.225393 [2] becomes Dead
23:13:19.225433 [2] commitChanSender done
23:13:19.225497 Received quit signal. Shutting down...
23:13:19.225579 Listener close error: close tcp [::]:54456: use of closed network connection
23:13:19.225645 [2] CraftServer terminated!
--- PASS: TestReplaceMultipleLogEntries (1.99s)
=== RUN   TestCrashAfterSubmit
23:13:19.226442 [0] in election timer state=DEAD, bailing out
23:13:19.226672 [0] listening at [::]:54468
23:13:19.227280 [1] listening at [::]:54469
23:13:19.227631 [2] listening at [::]:54470
23:13:19.227853 [1] election timer started (159ms), term=0
23:13:19.227865 [0] election timer started (255ms), term=0
23:13:19.227866 [2] election timer started (177ms), term=0
23:13:19.232626 [1] in election timer state=DEAD, bailing out
23:13:19.234386 [0] in election timer state=DEAD, bailing out
23:13:19.389057 [1] becomes Candidate (currentTerm=1); log=[]
23:13:19.389269 [1] election timer started (297ms), term=1
23:13:19.389275 [1] sending RequestVote to 2: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:19.389256 [1] sending RequestVote to 0: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1
23:13:19.391585 [0] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:19.391593 [2] RequestVote: Term:1 CandidateId:1 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:19.391678 [0] ... term out of date in RequestVote
23:13:19.391699 [2] ... term out of date in RequestVote
23:13:19.391712 [0] becomes Follower with term=1; log=[]
23:13:19.391727 [2] becomes Follower with term=1; log=[]
23:13:19.391956 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:19.391960 [2] ... RequestVote reply: Term:1 VoteGranted:true
23:13:19.392057 [0] election timer started (296ms), term=1
23:13:19.392081 [2] election timer started (256ms), term=1
23:13:19.393748 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:19 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:19.393865 [1] wins election with 2 votes
23:13:19.393890 [1] becomes Leader; term=1, nextIndex=map[0:0 2:0], matchIndex=map[0:-1 2:-1]; log=[]
23:13:19.393957 [1] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:19 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:19.394041 [1] while waiting for reply, state = LEADER
23:13:19.394097 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.394100 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.394934 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.394962 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.395166 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.395165 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.398026 [2] in election timer term changed from 0 to 1, bailing out
23:13:19.398163 [0] in election timer term changed from 0 to 1, bailing out
23:13:19.398930 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:19.398995 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:19.399520 [1] in election timer state=LEADER, bailing out
23:13:19.444314 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.444321 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.445260 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.445263 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.445506 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.445507 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.447204 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:19.447277 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:19.494520 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.494520 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.495576 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.495576 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:19.495860 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.495865 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.497701 [1] AppendEntries reply from 0 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:19.497776 [1] AppendEntries reply from 2 success: nextIndex := map[0:0 2:0], matchIndex := map[0:-1 2:-1]; commitIndex := -1
23:13:19.529792 [1] Submit received by LEADER: 5
23:13:19.530169 [1] ... log=[{5 1}]
23:13:19.530311 [1] sending AppendEntries to 2: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:19.530295 [1] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:19.531288 [TEST] Crash 1
23:13:19.531316 [TEST] Disconnect 1
23:13:19.531468 [1] CM.Stop called
23:13:19.531491 [1] becomes Dead
23:13:19.531382 [0] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:19.531516 [1] commitChanSender done
23:13:19.531402 [2] AppendEntries: Term:1 LeaderId:1 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:19.531562 [2] ... inserting entries [Command:5 Term:1] from index 0
23:13:19.531581 [0] ... inserting entries [Command:5 Term:1] from index 0
23:13:19.531619 [2] ... log is now: [{5 1}]
23:13:19.531637 [0] ... log is now: [{5 1}]
23:13:19.531733 Listener close error: close tcp [::]:54469: use of closed network connection
23:13:19.531758 Received quit signal. Shutting down...
23:13:19.531820 [1] CraftServer terminated!
23:13:19.531819 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.531819 [2] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:19.793217 [2] becomes Candidate (currentTerm=2); log=[{5 1}]
23:13:19.793352 [2] election timer started (212ms), term=2
23:13:19.793358 [2] sending RequestVote to 0: Term:2 CandidateId:2 LastLogTerm:1
23:13:19.793373 [2] sending RequestVote to 1: Term:2 CandidateId:2 LastLogTerm:1
23:13:19.794601 [0] RequestVote: Term:2 CandidateId:2 LastLogTerm:1 [currentTerm=1, votedFor=1, log index/term=(0, 1)]
23:13:19.794672 [0] ... term out of date in RequestVote
23:13:19.794691 [0] becomes Follower with term=2; log=[{5 1}]
23:13:19.794875 [0] ... RequestVote reply: Term:2 VoteGranted:true
23:13:19.794959 [0] election timer started (294ms), term=2
23:13:19.796178 [2] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:19 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:19.796287 [2] wins election with 2 votes
23:13:19.796313 [2] becomes Leader; term=2, nextIndex=map[0:1 1:1], matchIndex=map[0:-1 1:-1]; log=[{5 1}]
23:13:19.796405 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.796411 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.796950 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.797143 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:19.798371 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:19.802644 [0] in election timer term changed from 1 to 2, bailing out
23:13:19.803559 [2] in election timer state=LEADER, bailing out
23:13:19.846725 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.846726 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.847508 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.847751 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:19.849141 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:19.896834 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.896834 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.897857 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.898155 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:19.899058 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:19.947025 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.947033 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.948490 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.948812 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:19.950714 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:19.997177 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.997177 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.998156 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:19.998429 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:19.999992 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:20.047358 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.047358 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.048447 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.048758 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.051698 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:20.097662 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.097663 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.098834 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.099160 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.100152 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:20.145194 [TEST] Restart 1
23:13:20.146601 [1] listening at [::]:54474
23:13:20.146667 [TEST] Reconnect 1
23:13:20.146946 [1] election timer started (249ms), term=1
23:13:20.147965 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.147958 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.148977 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.149293 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.149409 [1] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.149481 [1] ... term out of date in AppendEntries
23:13:20.149501 [1] becomes Follower with term=2; log=[{5 1}]
23:13:20.149686 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.150198 [1] election timer started (169ms), term=2
23:13:20.150718 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:-1]; commitIndex := -1
23:13:20.152047 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := -1
23:13:20.157222 [1] in election timer term changed from 1 to 2, bailing out
23:13:20.198336 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.198336 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.199517 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.199517 [1] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.199903 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.199902 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.201795 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := -1
23:13:20.201873 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := -1
23:13:20.248726 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.248718 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.249903 [1] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.249931 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.250286 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.250287 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.251281 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := -1
23:13:20.251375 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := -1
23:13:20.299181 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.299176 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.300649 [1] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.300649 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 LeaderCommit:-1
23:13:20.301170 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.301181 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.302209 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := -1
23:13:20.302925 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := -1
23:13:20.317460 [2] Submit received by LEADER: 6
23:13:20.317755 [2] ... log=[{5 1} {6 2}]
23:13:20.317875 [2] sending AppendEntries to 1: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:20.317886 [2] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:2 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:20.318849 [1] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:20.318970 [1] ... inserting entries [Command:6 Term:2] from index 1
23:13:20.318883 [0] AppendEntries: Term:2 LeaderId:2 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:20.319019 [1] ... log is now: [{5 1} {6 2}]
23:13:20.319061 [0] ... inserting entries [Command:6 Term:2] from index 1
23:13:20.319115 [0] ... log is now: [{5 1} {6 2}]
23:13:20.319226 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.319302 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.320118 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:1], matchIndex := map[0:1 1:0]; commitIndex := 1
23:13:20.320191 [2] leader sets commitIndex := 1
23:13:20.320225 [2] commitChanSender entries=[{5 1} {6 2}], savedLastApplied=-1
23:13:20.320236 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:20.320292 [TEST] collectCommits(2) got {Command:5 Index:0 Term:2}
23:13:20.320343 [TEST] collectCommits(2) got {Command:6 Index:1 Term:2}
23:13:20.320313 [2] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.320341 [2] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.320884 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.320886 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.320956 [0] ... setting commitIndex=1
23:13:20.320961 [1] ... setting commitIndex=1
23:13:20.321132 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.321155 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.321291 [0] commitChanSender entries=[{5 1} {6 2}], savedLastApplied=-1
23:13:20.321822 [TEST] collectCommits(0) got {Command:5 Index:0 Term:2}
23:13:20.321894 [TEST] collectCommits(0) got {Command:6 Index:1 Term:2}
23:13:20.322280 [1] commitChanSender entries=[{5 1} {6 2}], savedLastApplied=-1
23:13:20.322377 [TEST] collectCommits(1) got {Command:5 Index:0 Term:2}
23:13:20.322427 [TEST] collectCommits(1) got {Command:6 Index:1 Term:2}
23:13:20.324639 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:20.324777 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:20.370680 [2] sending AppendEntries to 1: ni=2, args=Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.370684 [2] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.371766 [1] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.371794 [0] AppendEntries: Term:2 LeaderId:2 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:20.372128 [1] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.372131 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.373162 [2] AppendEntries reply from 1 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:20.373656 [2] AppendEntries reply from 0 success: nextIndex := map[0:2 1:2], matchIndex := map[0:1 1:1]; commitIndex := 1
23:13:20.418897 [0] CM.Stop called
23:13:20.418976 [0] becomes Dead
23:13:20.419038 [0] commitChanSender done
23:13:20.419104 Received quit signal. Shutting down...
23:13:20.419297 Listener close error: close tcp [::]:54468: use of closed network connection
23:13:20.419385 [0] CraftServer terminated!
23:13:20.419461 [1] CM.Stop called
23:13:20.419506 [1] becomes Dead
23:13:20.419550 [1] commitChanSender done
23:13:20.419637 Received quit signal. Shutting down...
23:13:20.419755 Listener close error: close tcp [::]:54474: use of closed network connection
23:13:20.419825 [1] CraftServer terminated!
23:13:20.419885 [2] CM.Stop called
23:13:20.419928 [2] becomes Dead
23:13:20.419971 [2] commitChanSender done
23:13:20.420083 Received quit signal. Shutting down...
23:13:20.420186 Listener close error: close tcp [::]:54470: use of closed network connection
23:13:20.420254 [2] CraftServer terminated!
23:13:20.420377 [1] in election timer state=DEAD, bailing out
--- PASS: TestCrashAfterSubmit (1.19s)
=== RUN   TestDisconnectAfterSubmit
23:13:20.421618 [0] listening at [::]:54476
23:13:20.422232 [1] listening at [::]:54477
23:13:20.422615 [2] listening at [::]:54478
23:13:20.422886 [2] election timer started (163ms), term=0
23:13:20.422909 [1] election timer started (183ms), term=0
23:13:20.422896 [0] election timer started (215ms), term=0
23:13:20.425586 [0] in election timer state=DEAD, bailing out
23:13:20.594034 [2] becomes Candidate (currentTerm=1); log=[]
23:13:20.594235 [2] election timer started (167ms), term=1
23:13:20.594209 [2] sending RequestVote to 1: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:20.594218 [2] sending RequestVote to 0: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1
23:13:20.596509 [1] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:20.596509 [0] RequestVote: Term:1 CandidateId:2 LastLogIndex:-1 LastLogTerm:-1 [currentTerm=0, votedFor=-1, log index/term=(-1, -1)]
23:13:20.596684 [1] ... term out of date in RequestVote
23:13:20.596718 [0] ... term out of date in RequestVote
23:13:20.596772 [0] becomes Follower with term=1; log=[]
23:13:20.596720 [1] becomes Follower with term=1; log=[]
23:13:20.597214 [1] ... RequestVote reply: Term:1 VoteGranted:true
23:13:20.597191 [0] ... RequestVote reply: Term:1 VoteGranted:true
23:13:20.597325 [1] election timer started (167ms), term=1
23:13:20.597441 [0] election timer started (191ms), term=1
23:13:20.599266 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:20 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:20.599378 [2] wins election with 2 votes
23:13:20.599402 [2] becomes Leader; term=1, nextIndex=map[0:0 1:0], matchIndex=map[0:-1 1:-1]; log=[]
23:13:20.599485 [2] received RequestVoteReply &{Msg:Term:1 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:20 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:20.599634 [2] while waiting for reply, state = LEADER
23:13:20.599670 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.599803 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.600377 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.600377 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.600609 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.600623 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.603205 [1] in election timer term changed from 0 to 1, bailing out
23:13:20.603248 [0] in election timer term changed from 0 to 1, bailing out
23:13:20.602598 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:20.603339 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:20.604493 [2] in election timer state=LEADER, bailing out
23:13:20.649747 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.649747 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.650913 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.650914 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.651281 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.651282 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.653227 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:20.653307 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:20.699981 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.699970 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.701548 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.701554 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 LeaderCommit:-1
23:13:20.702051 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.702048 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.703322 [2] AppendEntries reply from 0 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:20.703970 [2] AppendEntries reply from 1 success: nextIndex := map[0:0 1:0], matchIndex := map[0:-1 1:-1]; commitIndex := -1
23:13:20.724806 [2] Submit received by LEADER: 5
23:13:20.725137 [2] ... log=[{5 1}]
23:13:20.725365 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:20.725351 [2] sending AppendEntries to 0: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:20.726206 [1] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:20.726311 [TEST] Disconnect 2
23:13:20.726205 [0] AppendEntries: Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1} LeaderCommit:-1
23:13:20.726317 [1] ... inserting entries [Command:5 Term:1] from index 0
23:13:20.726370 [1] ... log is now: [{5 1}]
23:13:20.726350 [0] ... inserting entries [Command:5 Term:1] from index 0
23:13:20.726429 [0] ... log is now: [{5 1}]
23:13:20.726548 [1] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.726599 [0] AppendEntries reply: Term:1 Success:%!d(bool=true)
23:13:20.728155 [2] AppendEntries reply from 0 success: nextIndex := map[0:1 1:0], matchIndex := map[0:0 1:-1]; commitIndex := 0
23:13:20.728217 [2] leader sets commitIndex := 0
23:13:20.728276 [2] AppendEntries reply from 1 success: nextIndex := map[0:1 1:1], matchIndex := map[0:0 1:0]; commitIndex := 0
23:13:20.728342 [2] commitChanSender entries=[{5 1}], savedLastApplied=-1
23:13:20.728269 [2] sending AppendEntries to 1: ni=0, args=Term:1 LeaderId:2 PrevLogIndex:-1 PrevLogTerm:-1 Entries:{Command:5 Term:1}
23:13:20.728404 [TEST] collectCommits(2) got {Command:5 Index:0 Term:1}
23:13:20.728378 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.778499 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.778499 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.828603 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.828603 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.878616 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.878616 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.898484 [1] becomes Candidate (currentTerm=2); log=[{5 1}]
23:13:20.898616 [1] election timer started (160ms), term=2
23:13:20.898612 [1] sending RequestVote to 0: Term:2 CandidateId:1 LastLogTerm:1
23:13:20.898625 [1] sending RequestVote to 2: Term:2 CandidateId:1 LastLogTerm:1
23:13:20.900115 [0] RequestVote: Term:2 CandidateId:1 LastLogTerm:1 [currentTerm=1, votedFor=2, log index/term=(0, 1)]
23:13:20.900193 [0] ... term out of date in RequestVote
23:13:20.900211 [0] becomes Follower with term=2; log=[{5 1}]
23:13:20.900461 [0] ... RequestVote reply: Term:2 VoteGranted:true
23:13:20.900573 [0] election timer started (206ms), term=2
23:13:20.903340 [1] received RequestVoteReply &{Msg:Term:2 VoteGranted:true header:map[Content-Type:[application/grpc] Date:[Wed, 12 Mar 2025 17:43:20 GMT] Grpc-Accept-Encoding:[gzip] Grpc-Encoding:[gzip]] trailer:map[Grpc-Status:[0]]}
23:13:20.903447 [1] wins election with 2 votes
23:13:20.903474 [1] becomes Leader; term=2, nextIndex=map[0:1 2:1], matchIndex=map[0:-1 2:-1]; log=[{5 1}]
23:13:20.903559 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:20.903627 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:20.904609 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:20.904831 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.906108 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:20.907792 [0] in election timer term changed from 1 to 2, bailing out
23:13:20.908820 [1] in election timer state=LEADER, bailing out
23:13:20.929552 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.929557 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.953928 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:20.953920 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:20.955129 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:20.955442 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:20.956482 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:20.980625 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:20.980620 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.004239 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.004255 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.005324 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.005587 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.007020 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.031740 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.031767 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.054590 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.054565 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.056274 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.056780 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.058587 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.081773 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.081767 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.104740 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.104740 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.105629 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.105883 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.107524 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.131856 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.131871 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.155191 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.155175 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.156228 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.156537 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.158058 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.181952 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.181956 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.205697 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.205696 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.206488 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.206744 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.207614 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.232056 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.232060 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.256266 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.256266 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.257233 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.257532 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.259526 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.282148 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.282149 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.307079 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.307079 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.308189 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.308511 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.309417 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.332253 [2] sending AppendEntries to 1: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.332287 [2] sending AppendEntries to 0: ni=1, args=Term:1 LeaderId:2 PrevLogTerm:1
23:13:21.339539 [TEST] Reconnect 2
23:13:21.357763 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.357777 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.358615 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.358908 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.359031 [2] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.359094 [2] ... term out of date in AppendEntries
23:13:21.359115 [2] becomes Follower with term=2; log=[{5 1}]
23:13:21.359305 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.359385 [2] election timer started (181ms), term=2
23:13:21.359732 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:-1]; commitIndex := -1
23:13:21.361028 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := -1
23:13:21.408774 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.408774 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.410147 [2] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.410152 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.410635 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.410635 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.413487 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := -1
23:13:21.413567 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := -1
23:13:21.459910 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.459882 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.461413 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.461415 [2] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 LeaderCommit:-1
23:13:21.461816 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.461814 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.462752 [1] AppendEntries reply from 0 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := -1
23:13:21.462833 [1] AppendEntries reply from 2 success: nextIndex := map[0:1 2:1], matchIndex := map[0:0 2:0]; commitIndex := -1
23:13:21.490616 [1] Submit received by LEADER: 6
23:13:21.491117 [1] ... log=[{5 1} {6 2}]
23:13:21.491305 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:21.491349 [1] sending AppendEntries to 0: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:21.492760 [2] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:21.492757 [0] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:-1
23:13:21.492906 [2] ... inserting entries [Command:6 Term:2] from index 1
23:13:21.492935 [0] ... inserting entries [Command:6 Term:2] from index 1
23:13:21.492979 [2] ... log is now: [{5 1} {6 2}]
23:13:21.492990 [0] ... log is now: [{5 1} {6 2}]
23:13:21.493198 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.493200 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.494228 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:1], matchIndex := map[0:1 2:0]; commitIndex := 1
23:13:21.494306 [1] leader sets commitIndex := 1
23:13:21.494351 [1] commitChanSender entries=[{5 1} {6 2}], savedLastApplied=-1
23:13:21.494435 [TEST] collectCommits(1) got {Command:5 Index:0 Term:2}
23:13:21.494495 [TEST] collectCommits(1) got {Command:6 Index:1 Term:2}
23:13:21.494421 [1] sending AppendEntries to 2: ni=1, args=Term:2 LeaderId:1 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:1
23:13:21.494553 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:21.494843 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:21.495094 [2] AppendEntries: Term:2 LeaderId:1 PrevLogTerm:1 Entries:{Command:6 Term:2} LeaderCommit:1
23:13:21.495139 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:21.495189 [2] ... setting commitIndex=1
23:13:21.495209 [0] ... setting commitIndex=1
23:13:21.495343 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.495368 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.495419 [2] commitChanSender entries=[{6 2}], savedLastApplied=0
23:13:21.495440 [0] commitChanSender entries=[{5 1} {6 2}], savedLastApplied=-1
23:13:21.495460 [TEST] collectCommits(2) got {Command:6 Index:1 Term:2}
23:13:21.495506 [TEST] collectCommits(0) got {Command:5 Index:0 Term:2}
23:13:21.495556 [TEST] collectCommits(0) got {Command:6 Index:1 Term:2}
23:13:21.496117 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:21.496314 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:21.544561 [1] sending AppendEntries to 0: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:21.544561 [1] sending AppendEntries to 2: ni=2, args=Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:21.545627 [2] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:21.545627 [0] AppendEntries: Term:2 LeaderId:1 PrevLogIndex:1 PrevLogTerm:2 LeaderCommit:1
23:13:21.546037 [2] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.546038 [0] AppendEntries reply: Term:2 Success:%!d(bool=true)
23:13:21.547039 [1] AppendEntries reply from 2 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:21.547878 [1] AppendEntries reply from 0 success: nextIndex := map[0:2 2:2], matchIndex := map[0:1 2:1]; commitIndex := 1
23:13:21.592244 [0] CM.Stop called
23:13:21.592322 [0] becomes Dead
23:13:21.592379 [0] commitChanSender done
23:13:21.592440 Received quit signal. Shutting down...
23:13:21.592615 Listener close error: close tcp [::]:54476: use of closed network connection
23:13:21.592699 [0] CraftServer terminated!
23:13:21.592752 [1] CM.Stop called
23:13:21.592788 [1] becomes Dead
23:13:21.592833 [1] commitChanSender done
23:13:21.592902 Received quit signal. Shutting down...
23:13:21.592993 Listener close error: close tcp [::]:54477: use of closed network connection
23:13:21.593055 [1] CraftServer terminated!
23:13:21.593105 [2] CM.Stop called
23:13:21.593139 [2] becomes Dead
23:13:21.593188 [2] commitChanSender done
23:13:21.593250 Received quit signal. Shutting down...
23:13:21.593332 Listener close error: close tcp [::]:54478: use of closed network connection
23:13:21.593387 [2] CraftServer terminated!
--- PASS: TestDisconnectAfterSubmit (1.17s)
PASS
23:13:21.600059 [2] in election timer state=DEAD, bailing out
23:13:21.600742 [0] in election timer state=DEAD, bailing out
ok  	github.com/codeharik/craft	29.230s
